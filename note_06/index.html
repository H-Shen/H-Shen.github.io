<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Haohu Shen's ePortfolio</title><meta name="author" content="Haohu Shen"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Haohu Shen's ePortfolio" type="application/atom+xml">
</head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">Haohu Shen's ePortfolio</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/about"> About</a></li><li class="menus_item"><a class="site-page" href="/blogs"> Blogs</a></li><li class="menus_item"><a class="site-page" href="/projects"> Projects</a></li><li class="menus_item"><a class="site-page" href="/notes"> Notes</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/profile.png'" alt="avatar"></div><div class="author-discrip"><h3>Haohu Shen</h3><p class="author-bio">Premature optimization is the root of all evil.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="https://github.com/H-Shen" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://stackoverflow.com/users/6844098/haohu-shen" target="_blank"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://www.linkedin.com/notifications/?filter=all" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="mailto:haohu3991@gmail.com" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i></a></li></ul></div></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title"></h2><article><h3 id="Coding-Template"><a href="#Coding-Template" class="headerlink" title="Coding Template"></a>Coding Template</h3><p>This is the full version of my personal coding template for competitive coding in C++, suppose we are using GCC with standard C++17.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br><span class="line">3518</span><br><span class="line">3519</span><br><span class="line">3520</span><br><span class="line">3521</span><br><span class="line">3522</span><br><span class="line">3523</span><br><span class="line">3524</span><br><span class="line">3525</span><br><span class="line">3526</span><br><span class="line">3527</span><br><span class="line">3528</span><br><span class="line">3529</span><br><span class="line">3530</span><br><span class="line">3531</span><br><span class="line">3532</span><br><span class="line">3533</span><br><span class="line">3534</span><br><span class="line">3535</span><br><span class="line">3536</span><br><span class="line">3537</span><br><span class="line">3538</span><br><span class="line">3539</span><br><span class="line">3540</span><br><span class="line">3541</span><br><span class="line">3542</span><br><span class="line">3543</span><br><span class="line">3544</span><br><span class="line">3545</span><br><span class="line">3546</span><br><span class="line">3547</span><br><span class="line">3548</span><br><span class="line">3549</span><br><span class="line">3550</span><br><span class="line">3551</span><br><span class="line">3552</span><br><span class="line">3553</span><br><span class="line">3554</span><br><span class="line">3555</span><br><span class="line">3556</span><br><span class="line">3557</span><br><span class="line">3558</span><br><span class="line">3559</span><br><span class="line">3560</span><br><span class="line">3561</span><br><span class="line">3562</span><br><span class="line">3563</span><br><span class="line">3564</span><br><span class="line">3565</span><br><span class="line">3566</span><br><span class="line">3567</span><br><span class="line">3568</span><br><span class="line">3569</span><br><span class="line">3570</span><br><span class="line">3571</span><br><span class="line">3572</span><br><span class="line">3573</span><br><span class="line">3574</span><br><span class="line">3575</span><br><span class="line">3576</span><br><span class="line">3577</span><br><span class="line">3578</span><br><span class="line">3579</span><br><span class="line">3580</span><br><span class="line">3581</span><br><span class="line">3582</span><br><span class="line">3583</span><br><span class="line">3584</span><br><span class="line">3585</span><br><span class="line">3586</span><br><span class="line">3587</span><br><span class="line">3588</span><br><span class="line">3589</span><br><span class="line">3590</span><br><span class="line">3591</span><br><span class="line">3592</span><br><span class="line">3593</span><br><span class="line">3594</span><br><span class="line">3595</span><br><span class="line">3596</span><br><span class="line">3597</span><br><span class="line">3598</span><br><span class="line">3599</span><br><span class="line">3600</span><br><span class="line">3601</span><br><span class="line">3602</span><br><span class="line">3603</span><br><span class="line">3604</span><br><span class="line">3605</span><br><span class="line">3606</span><br><span class="line">3607</span><br><span class="line">3608</span><br><span class="line">3609</span><br><span class="line">3610</span><br><span class="line">3611</span><br><span class="line">3612</span><br><span class="line">3613</span><br><span class="line">3614</span><br><span class="line">3615</span><br><span class="line">3616</span><br><span class="line">3617</span><br><span class="line">3618</span><br><span class="line">3619</span><br><span class="line">3620</span><br><span class="line">3621</span><br><span class="line">3622</span><br><span class="line">3623</span><br><span class="line">3624</span><br><span class="line">3625</span><br><span class="line">3626</span><br><span class="line">3627</span><br><span class="line">3628</span><br><span class="line">3629</span><br><span class="line">3630</span><br><span class="line">3631</span><br><span class="line">3632</span><br><span class="line">3633</span><br><span class="line">3634</span><br><span class="line">3635</span><br><span class="line">3636</span><br><span class="line">3637</span><br><span class="line">3638</span><br><span class="line">3639</span><br><span class="line">3640</span><br><span class="line">3641</span><br><span class="line">3642</span><br><span class="line">3643</span><br><span class="line">3644</span><br><span class="line">3645</span><br><span class="line">3646</span><br><span class="line">3647</span><br><span class="line">3648</span><br><span class="line">3649</span><br><span class="line">3650</span><br><span class="line">3651</span><br><span class="line">3652</span><br><span class="line">3653</span><br><span class="line">3654</span><br><span class="line">3655</span><br><span class="line">3656</span><br><span class="line">3657</span><br><span class="line">3658</span><br><span class="line">3659</span><br><span class="line">3660</span><br><span class="line">3661</span><br><span class="line">3662</span><br><span class="line">3663</span><br><span class="line">3664</span><br><span class="line">3665</span><br><span class="line">3666</span><br><span class="line">3667</span><br><span class="line">3668</span><br><span class="line">3669</span><br><span class="line">3670</span><br><span class="line">3671</span><br><span class="line">3672</span><br><span class="line">3673</span><br><span class="line">3674</span><br><span class="line">3675</span><br><span class="line">3676</span><br><span class="line">3677</span><br><span class="line">3678</span><br><span class="line">3679</span><br><span class="line">3680</span><br><span class="line">3681</span><br><span class="line">3682</span><br><span class="line">3683</span><br><span class="line">3684</span><br><span class="line">3685</span><br><span class="line">3686</span><br><span class="line">3687</span><br><span class="line">3688</span><br><span class="line">3689</span><br><span class="line">3690</span><br><span class="line">3691</span><br><span class="line">3692</span><br><span class="line">3693</span><br><span class="line">3694</span><br><span class="line">3695</span><br><span class="line">3696</span><br><span class="line">3697</span><br><span class="line">3698</span><br><span class="line">3699</span><br><span class="line">3700</span><br><span class="line">3701</span><br><span class="line">3702</span><br><span class="line">3703</span><br><span class="line">3704</span><br><span class="line">3705</span><br><span class="line">3706</span><br><span class="line">3707</span><br><span class="line">3708</span><br><span class="line">3709</span><br><span class="line">3710</span><br><span class="line">3711</span><br><span class="line">3712</span><br><span class="line">3713</span><br><span class="line">3714</span><br><span class="line">3715</span><br><span class="line">3716</span><br><span class="line">3717</span><br><span class="line">3718</span><br><span class="line">3719</span><br><span class="line">3720</span><br><span class="line">3721</span><br><span class="line">3722</span><br><span class="line">3723</span><br><span class="line">3724</span><br><span class="line">3725</span><br><span class="line">3726</span><br><span class="line">3727</span><br><span class="line">3728</span><br><span class="line">3729</span><br><span class="line">3730</span><br><span class="line">3731</span><br><span class="line">3732</span><br><span class="line">3733</span><br><span class="line">3734</span><br><span class="line">3735</span><br><span class="line">3736</span><br><span class="line">3737</span><br><span class="line">3738</span><br><span class="line">3739</span><br><span class="line">3740</span><br><span class="line">3741</span><br><span class="line">3742</span><br><span class="line">3743</span><br><span class="line">3744</span><br><span class="line">3745</span><br><span class="line">3746</span><br><span class="line">3747</span><br><span class="line">3748</span><br><span class="line">3749</span><br><span class="line">3750</span><br><span class="line">3751</span><br><span class="line">3752</span><br><span class="line">3753</span><br><span class="line">3754</span><br><span class="line">3755</span><br><span class="line">3756</span><br><span class="line">3757</span><br><span class="line">3758</span><br><span class="line">3759</span><br><span class="line">3760</span><br><span class="line">3761</span><br><span class="line">3762</span><br><span class="line">3763</span><br><span class="line">3764</span><br><span class="line">3765</span><br><span class="line">3766</span><br><span class="line">3767</span><br><span class="line">3768</span><br><span class="line">3769</span><br><span class="line">3770</span><br><span class="line">3771</span><br><span class="line">3772</span><br><span class="line">3773</span><br><span class="line">3774</span><br><span class="line">3775</span><br><span class="line">3776</span><br><span class="line">3777</span><br><span class="line">3778</span><br><span class="line">3779</span><br><span class="line">3780</span><br><span class="line">3781</span><br><span class="line">3782</span><br><span class="line">3783</span><br><span class="line">3784</span><br><span class="line">3785</span><br><span class="line">3786</span><br><span class="line">3787</span><br><span class="line">3788</span><br><span class="line">3789</span><br><span class="line">3790</span><br><span class="line">3791</span><br><span class="line">3792</span><br><span class="line">3793</span><br><span class="line">3794</span><br><span class="line">3795</span><br><span class="line">3796</span><br><span class="line">3797</span><br><span class="line">3798</span><br><span class="line">3799</span><br><span class="line">3800</span><br><span class="line">3801</span><br><span class="line">3802</span><br><span class="line">3803</span><br><span class="line">3804</span><br><span class="line">3805</span><br><span class="line">3806</span><br><span class="line">3807</span><br><span class="line">3808</span><br><span class="line">3809</span><br><span class="line">3810</span><br><span class="line">3811</span><br><span class="line">3812</span><br><span class="line">3813</span><br><span class="line">3814</span><br><span class="line">3815</span><br><span class="line">3816</span><br><span class="line">3817</span><br><span class="line">3818</span><br><span class="line">3819</span><br><span class="line">3820</span><br><span class="line">3821</span><br><span class="line">3822</span><br><span class="line">3823</span><br><span class="line">3824</span><br><span class="line">3825</span><br><span class="line">3826</span><br><span class="line">3827</span><br><span class="line">3828</span><br><span class="line">3829</span><br><span class="line">3830</span><br><span class="line">3831</span><br><span class="line">3832</span><br><span class="line">3833</span><br><span class="line">3834</span><br><span class="line">3835</span><br><span class="line">3836</span><br><span class="line">3837</span><br><span class="line">3838</span><br><span class="line">3839</span><br><span class="line">3840</span><br><span class="line">3841</span><br><span class="line">3842</span><br><span class="line">3843</span><br><span class="line">3844</span><br><span class="line">3845</span><br><span class="line">3846</span><br><span class="line">3847</span><br><span class="line">3848</span><br><span class="line">3849</span><br><span class="line">3850</span><br><span class="line">3851</span><br><span class="line">3852</span><br><span class="line">3853</span><br><span class="line">3854</span><br><span class="line">3855</span><br><span class="line">3856</span><br><span class="line">3857</span><br><span class="line">3858</span><br><span class="line">3859</span><br><span class="line">3860</span><br><span class="line">3861</span><br><span class="line">3862</span><br><span class="line">3863</span><br><span class="line">3864</span><br><span class="line">3865</span><br><span class="line">3866</span><br><span class="line">3867</span><br><span class="line">3868</span><br><span class="line">3869</span><br><span class="line">3870</span><br><span class="line">3871</span><br><span class="line">3872</span><br><span class="line">3873</span><br><span class="line">3874</span><br><span class="line">3875</span><br><span class="line">3876</span><br><span class="line">3877</span><br><span class="line">3878</span><br><span class="line">3879</span><br><span class="line">3880</span><br><span class="line">3881</span><br><span class="line">3882</span><br><span class="line">3883</span><br><span class="line">3884</span><br><span class="line">3885</span><br><span class="line">3886</span><br><span class="line">3887</span><br><span class="line">3888</span><br><span class="line">3889</span><br><span class="line">3890</span><br><span class="line">3891</span><br><span class="line">3892</span><br><span class="line">3893</span><br><span class="line">3894</span><br><span class="line">3895</span><br><span class="line">3896</span><br><span class="line">3897</span><br><span class="line">3898</span><br><span class="line">3899</span><br><span class="line">3900</span><br><span class="line">3901</span><br><span class="line">3902</span><br><span class="line">3903</span><br><span class="line">3904</span><br><span class="line">3905</span><br><span class="line">3906</span><br><span class="line">3907</span><br><span class="line">3908</span><br><span class="line">3909</span><br><span class="line">3910</span><br><span class="line">3911</span><br><span class="line">3912</span><br><span class="line">3913</span><br><span class="line">3914</span><br><span class="line">3915</span><br><span class="line">3916</span><br><span class="line">3917</span><br><span class="line">3918</span><br><span class="line">3919</span><br><span class="line">3920</span><br><span class="line">3921</span><br><span class="line">3922</span><br><span class="line">3923</span><br><span class="line">3924</span><br><span class="line">3925</span><br><span class="line">3926</span><br><span class="line">3927</span><br><span class="line">3928</span><br><span class="line">3929</span><br><span class="line">3930</span><br><span class="line">3931</span><br><span class="line">3932</span><br><span class="line">3933</span><br><span class="line">3934</span><br><span class="line">3935</span><br><span class="line">3936</span><br><span class="line">3937</span><br><span class="line">3938</span><br><span class="line">3939</span><br><span class="line">3940</span><br><span class="line">3941</span><br><span class="line">3942</span><br><span class="line">3943</span><br><span class="line">3944</span><br><span class="line">3945</span><br><span class="line">3946</span><br><span class="line">3947</span><br><span class="line">3948</span><br><span class="line">3949</span><br><span class="line">3950</span><br><span class="line">3951</span><br><span class="line">3952</span><br><span class="line">3953</span><br><span class="line">3954</span><br><span class="line">3955</span><br><span class="line">3956</span><br><span class="line">3957</span><br><span class="line">3958</span><br><span class="line">3959</span><br><span class="line">3960</span><br><span class="line">3961</span><br><span class="line">3962</span><br><span class="line">3963</span><br><span class="line">3964</span><br><span class="line">3965</span><br><span class="line">3966</span><br><span class="line">3967</span><br><span class="line">3968</span><br><span class="line">3969</span><br><span class="line">3970</span><br><span class="line">3971</span><br><span class="line">3972</span><br><span class="line">3973</span><br><span class="line">3974</span><br><span class="line">3975</span><br><span class="line">3976</span><br><span class="line">3977</span><br><span class="line">3978</span><br><span class="line">3979</span><br><span class="line">3980</span><br><span class="line">3981</span><br><span class="line">3982</span><br><span class="line">3983</span><br><span class="line">3984</span><br><span class="line">3985</span><br><span class="line">3986</span><br><span class="line">3987</span><br><span class="line">3988</span><br><span class="line">3989</span><br><span class="line">3990</span><br><span class="line">3991</span><br><span class="line">3992</span><br><span class="line">3993</span><br><span class="line">3994</span><br><span class="line">3995</span><br><span class="line">3996</span><br><span class="line">3997</span><br><span class="line">3998</span><br><span class="line">3999</span><br><span class="line">4000</span><br><span class="line">4001</span><br><span class="line">4002</span><br><span class="line">4003</span><br><span class="line">4004</span><br><span class="line">4005</span><br><span class="line">4006</span><br><span class="line">4007</span><br><span class="line">4008</span><br><span class="line">4009</span><br><span class="line">4010</span><br><span class="line">4011</span><br><span class="line">4012</span><br><span class="line">4013</span><br><span class="line">4014</span><br><span class="line">4015</span><br><span class="line">4016</span><br><span class="line">4017</span><br><span class="line">4018</span><br><span class="line">4019</span><br><span class="line">4020</span><br><span class="line">4021</span><br><span class="line">4022</span><br><span class="line">4023</span><br><span class="line">4024</span><br><span class="line">4025</span><br><span class="line">4026</span><br><span class="line">4027</span><br><span class="line">4028</span><br><span class="line">4029</span><br><span class="line">4030</span><br><span class="line">4031</span><br><span class="line">4032</span><br><span class="line">4033</span><br><span class="line">4034</span><br><span class="line">4035</span><br><span class="line">4036</span><br><span class="line">4037</span><br><span class="line">4038</span><br><span class="line">4039</span><br><span class="line">4040</span><br><span class="line">4041</span><br><span class="line">4042</span><br><span class="line">4043</span><br><span class="line">4044</span><br><span class="line">4045</span><br><span class="line">4046</span><br><span class="line">4047</span><br><span class="line">4048</span><br><span class="line">4049</span><br><span class="line">4050</span><br><span class="line">4051</span><br><span class="line">4052</span><br><span class="line">4053</span><br><span class="line">4054</span><br><span class="line">4055</span><br><span class="line">4056</span><br><span class="line">4057</span><br><span class="line">4058</span><br><span class="line">4059</span><br><span class="line">4060</span><br><span class="line">4061</span><br><span class="line">4062</span><br><span class="line">4063</span><br><span class="line">4064</span><br><span class="line">4065</span><br><span class="line">4066</span><br><span class="line">4067</span><br><span class="line">4068</span><br><span class="line">4069</span><br><span class="line">4070</span><br><span class="line">4071</span><br><span class="line">4072</span><br><span class="line">4073</span><br><span class="line">4074</span><br><span class="line">4075</span><br><span class="line">4076</span><br><span class="line">4077</span><br><span class="line">4078</span><br><span class="line">4079</span><br><span class="line">4080</span><br><span class="line">4081</span><br><span class="line">4082</span><br><span class="line">4083</span><br><span class="line">4084</span><br><span class="line">4085</span><br><span class="line">4086</span><br><span class="line">4087</span><br><span class="line">4088</span><br><span class="line">4089</span><br><span class="line">4090</span><br><span class="line">4091</span><br><span class="line">4092</span><br><span class="line">4093</span><br><span class="line">4094</span><br><span class="line">4095</span><br><span class="line">4096</span><br><span class="line">4097</span><br><span class="line">4098</span><br><span class="line">4099</span><br><span class="line">4100</span><br><span class="line">4101</span><br><span class="line">4102</span><br><span class="line">4103</span><br><span class="line">4104</span><br><span class="line">4105</span><br><span class="line">4106</span><br><span class="line">4107</span><br><span class="line">4108</span><br><span class="line">4109</span><br><span class="line">4110</span><br><span class="line">4111</span><br><span class="line">4112</span><br><span class="line">4113</span><br><span class="line">4114</span><br><span class="line">4115</span><br><span class="line">4116</span><br><span class="line">4117</span><br><span class="line">4118</span><br><span class="line">4119</span><br><span class="line">4120</span><br><span class="line">4121</span><br><span class="line">4122</span><br><span class="line">4123</span><br><span class="line">4124</span><br><span class="line">4125</span><br><span class="line">4126</span><br><span class="line">4127</span><br><span class="line">4128</span><br><span class="line">4129</span><br><span class="line">4130</span><br><span class="line">4131</span><br><span class="line">4132</span><br><span class="line">4133</span><br><span class="line">4134</span><br><span class="line">4135</span><br><span class="line">4136</span><br><span class="line">4137</span><br><span class="line">4138</span><br><span class="line">4139</span><br><span class="line">4140</span><br><span class="line">4141</span><br><span class="line">4142</span><br><span class="line">4143</span><br><span class="line">4144</span><br><span class="line">4145</span><br><span class="line">4146</span><br><span class="line">4147</span><br><span class="line">4148</span><br><span class="line">4149</span><br><span class="line">4150</span><br><span class="line">4151</span><br><span class="line">4152</span><br><span class="line">4153</span><br><span class="line">4154</span><br><span class="line">4155</span><br><span class="line">4156</span><br><span class="line">4157</span><br><span class="line">4158</span><br><span class="line">4159</span><br><span class="line">4160</span><br><span class="line">4161</span><br><span class="line">4162</span><br><span class="line">4163</span><br><span class="line">4164</span><br><span class="line">4165</span><br><span class="line">4166</span><br><span class="line">4167</span><br><span class="line">4168</span><br><span class="line">4169</span><br><span class="line">4170</span><br><span class="line">4171</span><br><span class="line">4172</span><br><span class="line">4173</span><br><span class="line">4174</span><br><span class="line">4175</span><br><span class="line">4176</span><br><span class="line">4177</span><br><span class="line">4178</span><br><span class="line">4179</span><br><span class="line">4180</span><br><span class="line">4181</span><br><span class="line">4182</span><br><span class="line">4183</span><br><span class="line">4184</span><br><span class="line">4185</span><br><span class="line">4186</span><br><span class="line">4187</span><br><span class="line">4188</span><br><span class="line">4189</span><br><span class="line">4190</span><br><span class="line">4191</span><br><span class="line">4192</span><br><span class="line">4193</span><br><span class="line">4194</span><br><span class="line">4195</span><br><span class="line">4196</span><br><span class="line">4197</span><br><span class="line">4198</span><br><span class="line">4199</span><br><span class="line">4200</span><br><span class="line">4201</span><br><span class="line">4202</span><br><span class="line">4203</span><br><span class="line">4204</span><br><span class="line">4205</span><br><span class="line">4206</span><br><span class="line">4207</span><br><span class="line">4208</span><br><span class="line">4209</span><br><span class="line">4210</span><br><span class="line">4211</span><br><span class="line">4212</span><br><span class="line">4213</span><br><span class="line">4214</span><br><span class="line">4215</span><br><span class="line">4216</span><br><span class="line">4217</span><br><span class="line">4218</span><br><span class="line">4219</span><br><span class="line">4220</span><br><span class="line">4221</span><br><span class="line">4222</span><br><span class="line">4223</span><br><span class="line">4224</span><br><span class="line">4225</span><br><span class="line">4226</span><br><span class="line">4227</span><br><span class="line">4228</span><br><span class="line">4229</span><br><span class="line">4230</span><br><span class="line">4231</span><br><span class="line">4232</span><br><span class="line">4233</span><br><span class="line">4234</span><br><span class="line">4235</span><br><span class="line">4236</span><br><span class="line">4237</span><br><span class="line">4238</span><br><span class="line">4239</span><br><span class="line">4240</span><br><span class="line">4241</span><br><span class="line">4242</span><br><span class="line">4243</span><br><span class="line">4244</span><br><span class="line">4245</span><br><span class="line">4246</span><br><span class="line">4247</span><br><span class="line">4248</span><br><span class="line">4249</span><br><span class="line">4250</span><br><span class="line">4251</span><br><span class="line">4252</span><br><span class="line">4253</span><br><span class="line">4254</span><br><span class="line">4255</span><br><span class="line">4256</span><br><span class="line">4257</span><br><span class="line">4258</span><br><span class="line">4259</span><br><span class="line">4260</span><br><span class="line">4261</span><br><span class="line">4262</span><br><span class="line">4263</span><br><span class="line">4264</span><br><span class="line">4265</span><br><span class="line">4266</span><br><span class="line">4267</span><br><span class="line">4268</span><br><span class="line">4269</span><br><span class="line">4270</span><br><span class="line">4271</span><br><span class="line">4272</span><br><span class="line">4273</span><br><span class="line">4274</span><br><span class="line">4275</span><br><span class="line">4276</span><br><span class="line">4277</span><br><span class="line">4278</span><br><span class="line">4279</span><br><span class="line">4280</span><br><span class="line">4281</span><br><span class="line">4282</span><br><span class="line">4283</span><br><span class="line">4284</span><br><span class="line">4285</span><br><span class="line">4286</span><br><span class="line">4287</span><br><span class="line">4288</span><br><span class="line">4289</span><br><span class="line">4290</span><br><span class="line">4291</span><br><span class="line">4292</span><br><span class="line">4293</span><br><span class="line">4294</span><br><span class="line">4295</span><br><span class="line">4296</span><br><span class="line">4297</span><br><span class="line">4298</span><br><span class="line">4299</span><br><span class="line">4300</span><br><span class="line">4301</span><br><span class="line">4302</span><br><span class="line">4303</span><br><span class="line">4304</span><br><span class="line">4305</span><br><span class="line">4306</span><br><span class="line">4307</span><br><span class="line">4308</span><br><span class="line">4309</span><br><span class="line">4310</span><br><span class="line">4311</span><br><span class="line">4312</span><br><span class="line">4313</span><br><span class="line">4314</span><br><span class="line">4315</span><br><span class="line">4316</span><br><span class="line">4317</span><br><span class="line">4318</span><br><span class="line">4319</span><br><span class="line">4320</span><br><span class="line">4321</span><br><span class="line">4322</span><br><span class="line">4323</span><br><span class="line">4324</span><br><span class="line">4325</span><br><span class="line">4326</span><br><span class="line">4327</span><br><span class="line">4328</span><br><span class="line">4329</span><br><span class="line">4330</span><br><span class="line">4331</span><br><span class="line">4332</span><br><span class="line">4333</span><br><span class="line">4334</span><br><span class="line">4335</span><br><span class="line">4336</span><br><span class="line">4337</span><br><span class="line">4338</span><br><span class="line">4339</span><br><span class="line">4340</span><br><span class="line">4341</span><br><span class="line">4342</span><br><span class="line">4343</span><br><span class="line">4344</span><br><span class="line">4345</span><br><span class="line">4346</span><br><span class="line">4347</span><br><span class="line">4348</span><br><span class="line">4349</span><br><span class="line">4350</span><br><span class="line">4351</span><br><span class="line">4352</span><br><span class="line">4353</span><br><span class="line">4354</span><br><span class="line">4355</span><br><span class="line">4356</span><br><span class="line">4357</span><br><span class="line">4358</span><br><span class="line">4359</span><br><span class="line">4360</span><br><span class="line">4361</span><br><span class="line">4362</span><br><span class="line">4363</span><br><span class="line">4364</span><br><span class="line">4365</span><br><span class="line">4366</span><br><span class="line">4367</span><br><span class="line">4368</span><br><span class="line">4369</span><br><span class="line">4370</span><br><span class="line">4371</span><br><span class="line">4372</span><br><span class="line">4373</span><br><span class="line">4374</span><br><span class="line">4375</span><br><span class="line">4376</span><br><span class="line">4377</span><br><span class="line">4378</span><br><span class="line">4379</span><br><span class="line">4380</span><br><span class="line">4381</span><br><span class="line">4382</span><br><span class="line">4383</span><br><span class="line">4384</span><br><span class="line">4385</span><br><span class="line">4386</span><br><span class="line">4387</span><br><span class="line">4388</span><br><span class="line">4389</span><br><span class="line">4390</span><br><span class="line">4391</span><br><span class="line">4392</span><br><span class="line">4393</span><br><span class="line">4394</span><br><span class="line">4395</span><br><span class="line">4396</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize (<span class="string">&quot;Ofast&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize (<span class="string">&quot;unroll-loops&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target (<span class="string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/extc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> ld = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line"><span class="keyword">using</span> ull = <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> ii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> vii = vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __SIZEOF_INT128__</span></span><br><span class="line"><span class="keyword">using</span> int128 = <span class="type">__int128_t</span>;</span><br><span class="line"><span class="keyword">using</span> uint128 = <span class="type">__uint128_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">print_int128</span><span class="params">(int128 a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!a) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="keyword">while</span> (a) &#123;</span><br><span class="line">        s = <span class="built_in">char</span>(<span class="built_in">llabs</span>((<span class="type">long</span> <span class="type">long</span>)(a % <span class="number">10</span>)) + <span class="string">&#x27;0&#x27;</span>) + s;</span><br><span class="line">        <span class="keyword">if</span> (a &lt; <span class="number">0</span> &amp;&amp; a &gt; <span class="number">-10</span>) &#123;</span><br><span class="line">            s = <span class="string">&#x27;-&#x27;</span> + s;</span><br><span class="line">        &#125;</span><br><span class="line">        a /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">int128 <span class="title">stoint128</span><span class="params">(<span class="type">const</span> string &amp;s)</span> </span>&#123;</span><br><span class="line">    int128 a = <span class="number">0</span>, sgn = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="type">char</span> &amp;ch : s) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>) sgn *= <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span> a = a * <span class="number">10</span> + sgn * (ch - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(__SIZEOF_FLOAT128__) &amp;&amp; defined(__linux__)</span></span><br><span class="line"><span class="keyword">using</span> float128 = __float128;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// #include &lt;ext/pb_ds/tree_policy.hpp&gt;</span></span><br><span class="line"><span class="comment">// #include &lt;ext/pb_ds/assoc_container.hpp&gt;</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> RBTree = tree&lt;T, null_type, less&lt;&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Trie = trie&lt;string, null_type, trie_string_access_traits&lt;&gt;, pat_trie_tag, trie_prefix_search_node_update&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fast_io = []() &#123;</span><br><span class="line">    ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin.<span class="built_in">exceptions</span>(cin.failbit);    <span class="comment">// throw an exception if cin fails</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO &#123;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">bool</span> <span class="title">can_read</span><span class="params">(T &amp;t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> ch = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ch == EOF) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            n |= ch == <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">            ch = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) &#123;</span><br><span class="line">            t = t * <span class="number">10</span> + ch - <span class="number">48</span>;</span><br><span class="line">            ch = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n) t = -t;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function">    <span class="type">bool</span> <span class="title">can_read</span><span class="params">(T &amp;t, Args &amp;... args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">can_read</span>(t) &amp;&amp; <span class="built_in">can_read</span>(args...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> c = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) n |= c == <span class="string">&#x27;-&#x27;</span>, c = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) t = t * <span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">getchar_unlocked</span>();</span><br><span class="line">        <span class="keyword">if</span> (n) t = -t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;t, Args &amp;... args)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">read</span>(t);</span><br><span class="line">        <span class="built_in">read</span>(args...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) x = -x, <span class="built_in">putchar_unlocked</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        <span class="built_in">putchar_unlocked</span>(x % <span class="number">10</span> + <span class="number">48</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">writeln</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">write</span>(x);</span><br><span class="line">        <span class="built_in">putchar_unlocked</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DSU: Union_Find_Set</span></span><br><span class="line"><span class="comment">// Complexity: O (a(n)) per operation. Note: O (log n) if one of</span></span><br><span class="line"><span class="comment">// union-by-size or path compression is omitted</span></span><br><span class="line"><span class="comment">// a(n) is the inverse Ackermann function</span></span><br><span class="line"><span class="keyword">namespace</span> DSU &#123;</span><br><span class="line">    <span class="comment">// father[x]: the father of x</span></span><br><span class="line">    <span class="comment">// Size[x]:  the size of tree/disjoint set whose ancestor is &#x27;x&#x27;</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; father, Size;</span><br><span class="line">    <span class="type">int</span> cc;      <span class="comment">// the number of disjoint sets</span></span><br><span class="line">    <span class="comment">// iniitalization</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// reset</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(father);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(Size);</span><br><span class="line">        <span class="comment">// initialize: 5 is an offset just in case</span></span><br><span class="line">        father.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        <span class="built_in">iota</span>(father.<span class="built_in">begin</span>(), father.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">        Size.<span class="built_in">resize</span>(n + <span class="number">5</span>, <span class="number">1</span>);</span><br><span class="line">        cc = n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// find the ancestor of i with path compression</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x != father[x]) father[x] = <span class="built_in">find</span>(father[x]);</span><br><span class="line">        <span class="keyword">return</span> father[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// merge x and y</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x = <span class="built_in">find</span>(x); y = <span class="built_in">find</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// Make sure the tree with less nodes combines to the tree with more nodes</span></span><br><span class="line">        <span class="keyword">if</span> (Size[x] &gt; Size[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        --cc;</span><br><span class="line">        father[x] = y;</span><br><span class="line">        Size[y] += Size[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// check if x and y are in the same set</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">is_same_group</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">find</span>(i) == <span class="built_in">find</span>(j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// check the size of set where &#x27;x&#x27; is</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">check_set_size</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Size[<span class="built_in">find</span>(x)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// check the number of disjoint sets</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">number_of_disjoint_sets</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Modified DSU, supports move p from its set to the set contains q</span></span><br><span class="line"><span class="comment">// Reference: UVA11987</span></span><br><span class="line"><span class="keyword">namespace</span> DSU_Modified &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; father;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; Size;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(father);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(Size);</span><br><span class="line">        father.<span class="built_in">resize</span>(<span class="number">2</span> * n + <span class="number">5</span>);</span><br><span class="line">        Size.<span class="built_in">resize</span>(<span class="number">2</span> * n + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            father.<span class="built_in">at</span>(i) = i + n;</span><br><span class="line">            father.<span class="built_in">at</span>(i + n) = father.<span class="built_in">at</span>(i);</span><br><span class="line">            Size.<span class="built_in">at</span>(i + n) = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x != father[x]) &#123;</span><br><span class="line">            father[x] = <span class="built_in">find</span>(father[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> father[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x = <span class="built_in">find</span>(x);</span><br><span class="line">        y = <span class="built_in">find</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Size[x] &gt; Size[y]) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">        father[x] = y;</span><br><span class="line">        Size[y] += Size[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// move x_ from its set to the set contains y_</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">move_to</span><span class="params">(<span class="type">int</span> x_, <span class="type">int</span> y_)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="built_in">find</span>(x_);</span><br><span class="line">        <span class="type">int</span> y = <span class="built_in">find</span>(y_);</span><br><span class="line">        <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        --Size[x];</span><br><span class="line">        ++Size[y];</span><br><span class="line">        father[x_] = y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">is_same_group</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Catalan[0] = 1, Catalan[1] = 1</span></span><br><span class="line"><span class="comment">Catalan[n] = (4n-2)/(n+1) * Catalan[n-1]</span></span><br><span class="line"><span class="comment">Catalan[n] % p</span></span><br><span class="line"><span class="comment">= ( (4n-2)/(n+1) * Catalan[n-1] ) % p</span></span><br><span class="line"><span class="comment">= ( (4n-2) * Catalan[n-1] ) % p * inv[n+1] % p</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> Catalan &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> ll MOD = <span class="number">1000000007</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> ll MAXN = <span class="number">1005</span>;</span><br><span class="line">    ll inv[MAXN + <span class="number">5</span>];</span><br><span class="line">    ll catalan[MAXN + <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Obtain inverse of MOD from 1 to MAXN</span></span><br><span class="line">        inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= MAXN; ++i) &#123;</span><br><span class="line">            inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Obtain Catalan[n] % MOD</span></span><br><span class="line">        catalan[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        catalan[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= MAXN; ++i) &#123;</span><br><span class="line">            catalan[i] =</span><br><span class="line">                    ((<span class="number">4</span> * i - <span class="number">2</span>) * catalan[i - <span class="number">1</span>] % MOD * inv[i + <span class="number">1</span>] % MOD) %</span><br><span class="line">                    MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> catalan[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pre-condition: DSU</span></span><br><span class="line"><span class="keyword">namespace</span> MST_Kruskal &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="type">int</span> w;</span><br><span class="line">        <span class="function"><span class="keyword">explicit</span> <span class="title">Edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> : u(u), v(v), w(w) &#123;</span>&#125;</span><br><span class="line">        <span class="built_in">Edge</span>() = <span class="keyword">default</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">vector&lt;Edge&gt; <span class="title">kruskal</span><span class="params">(vector&lt;Edge&gt; E, <span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// initialize a DSU</span></span><br><span class="line">        DSU::<span class="built_in">init</span>(number_of_nodes);</span><br><span class="line">        <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// sort by the edge&#x27;s weight in increasing order</span></span><br><span class="line">        <span class="built_in">sort</span>(E.<span class="built_in">begin</span>(), E.<span class="built_in">end</span>(),</span><br><span class="line">             [](<span class="type">const</span> Edge &amp;lhs, <span class="type">const</span> Edge &amp;rhs) &#123;</span><br><span class="line">                 <span class="built_in">return</span> (lhs.w &lt; rhs.w);</span><br><span class="line">             &#125;);</span><br><span class="line">        vector&lt;Edge&gt; minimum_spanning_tree;</span><br><span class="line">        <span class="comment">// int cost = 0;    // to calculate the total weight of the MST</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[u, v, w] : E) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!DSU::<span class="built_in">is_same_group</span>(u, v)) &#123;</span><br><span class="line">                DSU::<span class="built_in">merge</span>(u, v);</span><br><span class="line">                minimum_spanning_tree.<span class="built_in">emplace_back</span>(<span class="built_in">Edge</span>(u, v, w));</span><br><span class="line">                <span class="comment">// cost += w;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minimum_spanning_tree;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// The collection of methods and data structures are used to obtain an MST of a</span></span><br><span class="line"><span class="comment">// undirected-graph using Prim&#x27;s algorithm with a priority queue optimized</span></span><br><span class="line"><span class="comment">// O(mlogn)</span></span><br><span class="line"><span class="keyword">namespace</span> MST_Prim &#123;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, ll&gt; &gt; &gt; AL;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; taken;</span><br><span class="line">    priority_queue&lt;pair&lt;ll, <span class="type">int</span>&gt; &gt; pq;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        taken[u] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[v, w] : AL[u])</span><br><span class="line">            <span class="keyword">if</span> (!taken[v])</span><br><span class="line">                pq.<span class="built_in">push</span>(&#123;-w, -v&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll mst_cost = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> num_taken = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mst_cost = <span class="number">0</span>;</span><br><span class="line">        num_taken = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">decltype</span>(pq)().<span class="built_in">swap</span>(pq);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;().<span class="built_in">swap</span>(taken);</span><br><span class="line">        <span class="keyword">decltype</span>(AL)().<span class="built_in">swap</span>(AL);</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">prim</span><span class="params">(<span class="type">int</span> source)</span> </span>&#123;</span><br><span class="line">        taken.<span class="built_in">resize</span>(n, <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">process</span>(source);</span><br><span class="line">        <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">auto</span>[w, u] = pq.<span class="built_in">top</span>();</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            w = -w;</span><br><span class="line">            u = -u;</span><br><span class="line">            <span class="keyword">if</span> (taken[u]) <span class="keyword">continue</span>;</span><br><span class="line">            mst_cost += w;</span><br><span class="line">            <span class="built_in">process</span>(u);</span><br><span class="line">            ++num_taken;</span><br><span class="line">            <span class="keyword">if</span> (num_taken == n - <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// the Prim&#x27;s algorithm with adjacency matrix</span></span><br><span class="line"><span class="keyword">namespace</span> MST_Prim_ &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> w = INF;</span><br><span class="line">        <span class="type">int</span> to = <span class="number">-1</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj; <span class="comment">// adjacency matrix</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">prim</span><span class="params">(<span class="type">int</span> &amp;total_weight)</span> </span>&#123;</span><br><span class="line">        total_weight = <span class="number">0</span>;</span><br><span class="line">        bitset&lt;MAXN&gt; vis;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)adj.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;Edge&gt; <span class="title">minE</span><span class="params">(n)</span></span>;</span><br><span class="line">        minE.<span class="built_in">at</span>(<span class="number">0</span>).w = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> v = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!vis[j] &amp;&amp; (v == <span class="number">-1</span> || minE.<span class="built_in">at</span>(j).w &lt; minE.<span class="built_in">at</span>(v).w)) &#123;</span><br><span class="line">                    v = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (minE.<span class="built_in">at</span>(v).w == INF) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">// No MST exists</span></span><br><span class="line">            &#125;</span><br><span class="line">            vis[v] = <span class="literal">true</span>;</span><br><span class="line">            total_weight += minE.<span class="built_in">at</span>(v).w;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> to = <span class="number">0</span>; to &lt; n; ++to) &#123;</span><br><span class="line">                <span class="keyword">if</span> (adj.<span class="built_in">at</span>(v).<span class="built_in">at</span>(to) &lt; minE.<span class="built_in">at</span>(to).w) &#123;</span><br><span class="line">                    minE.<span class="built_in">at</span>(to) = &#123;adj.<span class="built_in">at</span>(v).<span class="built_in">at</span>(to), v&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Negative all weights + Kruskal for Minimum Spanning Tree</span></span><br><span class="line"><span class="keyword">namespace</span> MaximumSpanningTree &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w, neg_w;</span><br><span class="line">        <span class="function"><span class="keyword">explicit</span> <span class="title">Edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> : u(u), v(v), w(w), neg_w(-w) &#123;</span>&#125;</span><br><span class="line">        <span class="built_in">Edge</span>() = <span class="keyword">default</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">vector&lt;Edge&gt; <span class="title">kruskal</span><span class="params">(vector&lt;Edge&gt; &amp;E)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(E.<span class="built_in">begin</span>(), E.<span class="built_in">end</span>(), [](<span class="type">const</span> Edge &amp;l, <span class="type">const</span> Edge &amp;r) &#123;</span><br><span class="line">            <span class="built_in">return</span> (l.neg_w &lt; r.neg_w);</span><br><span class="line">        &#125;);</span><br><span class="line">        vector&lt;Edge&gt; result;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;e : E) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!DSU::<span class="built_in">is_same_group</span>(e.u, e.v)) &#123;</span><br><span class="line">                DSU::<span class="built_in">merge</span>(e.u, e.v);</span><br><span class="line">                result.<span class="built_in">emplace_back</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Obtain Directed Minimum Spanning Tree using Edmond&#x27;s algorithm, takes O(mn)</span></span><br><span class="line"><span class="keyword">namespace</span> DMST &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> ll INF = <span class="number">0x3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="function"><span class="keyword">explicit</span> <span class="title">Edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll w)</span> : u(u), v(v), w(w) &#123;</span>&#125;</span><br><span class="line">        <span class="built_in">Edge</span>() = <span class="keyword">default</span>;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        ll w;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; pre;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; id;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; visit;</span><br><span class="line">    vector&lt;ll&gt; in;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Edge&gt;().<span class="built_in">swap</span>(edges);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(pre);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(id);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(visit);</span><br><span class="line">        <span class="built_in">vector</span>&lt;ll&gt;().<span class="built_in">swap</span>(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return the sum of MDST, or -INF if there is no MDST</span></span><br><span class="line">    <span class="function">ll <span class="title">Edmonds</span><span class="params">(<span class="type">int</span> root, <span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// init</span></span><br><span class="line">        <span class="type">int</span> number_of_edges = (<span class="type">int</span>)edges.<span class="built_in">size</span>();</span><br><span class="line">        pre.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        id.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        visit.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        in.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        ll result = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> u, v, tn;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_nodes; ++i) &#123;</span><br><span class="line">                in.<span class="built_in">at</span>(i) = INF;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_edges; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (edges.<span class="built_in">at</span>(i).u != edges.<span class="built_in">at</span>(i).v &amp;&amp;</span><br><span class="line">                    edges.<span class="built_in">at</span>(i).w &lt; in.<span class="built_in">at</span>(edges.<span class="built_in">at</span>(i).v)) &#123;</span><br><span class="line">                    pre.<span class="built_in">at</span>(edges.<span class="built_in">at</span>(i).v) = edges.<span class="built_in">at</span>(i).u;</span><br><span class="line">                    in.<span class="built_in">at</span>(edges.<span class="built_in">at</span>(i).v) = edges.<span class="built_in">at</span>(i).w;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_nodes; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i != root &amp;&amp; in.<span class="built_in">at</span>(i) == INF) &#123;</span><br><span class="line">                    <span class="keyword">return</span> -INF;    <span class="comment">// No MDST exists</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tn = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">fill</span>(id.<span class="built_in">begin</span>(), id.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">fill</span>(visit.<span class="built_in">begin</span>(), visit.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">            in.<span class="built_in">at</span>(root) = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_nodes; ++i) &#123;</span><br><span class="line">                result += in.<span class="built_in">at</span>(i);</span><br><span class="line">                v = i;</span><br><span class="line">                <span class="keyword">while</span> (visit.<span class="built_in">at</span>(v) != i &amp;&amp; id.<span class="built_in">at</span>(v) == <span class="number">-1</span> &amp;&amp; v != root) &#123;</span><br><span class="line">                    visit.<span class="built_in">at</span>(v) = i;</span><br><span class="line">                    v = pre.<span class="built_in">at</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (v != root &amp;&amp; id.<span class="built_in">at</span>(v) == <span class="number">-1</span>) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (u = pre.<span class="built_in">at</span>(v); u != v; u = pre.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                        id.<span class="built_in">at</span>(u) = tn;</span><br><span class="line">                    &#125;</span><br><span class="line">                    id.<span class="built_in">at</span>(v) = tn;</span><br><span class="line">                    ++tn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tn == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;  <span class="comment">// No cycles found</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_nodes; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (id.<span class="built_in">at</span>(i) == <span class="number">-1</span>) &#123;</span><br><span class="line">                    id.<span class="built_in">at</span>(i) = tn;</span><br><span class="line">                    ++tn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_edges; ) &#123;</span><br><span class="line">                v = edges.<span class="built_in">at</span>(i).v;</span><br><span class="line">                edges.<span class="built_in">at</span>(i).u = id.<span class="built_in">at</span>(edges.<span class="built_in">at</span>(i).u);</span><br><span class="line">                edges.<span class="built_in">at</span>(i).v = id.<span class="built_in">at</span>(edges.<span class="built_in">at</span>(i).v);</span><br><span class="line">                <span class="keyword">if</span> (edges.<span class="built_in">at</span>(i).u != edges.<span class="built_in">at</span>(i).v) &#123;</span><br><span class="line">                    edges.<span class="built_in">at</span>(i).w -= in.<span class="built_in">at</span>(v);</span><br><span class="line">                    ++i;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">swap</span>(edges.<span class="built_in">at</span>(i), edges.<span class="built_in">at</span>(--number_of_edges));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            number_of_nodes = tn;</span><br><span class="line">            root = id.<span class="built_in">at</span>(root);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m, r, u, v;</span><br><span class="line">        ll w;</span><br><span class="line">        vector&lt;unordered_map&lt;<span class="type">int</span>, ll&gt; &gt; adj;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m &gt;&gt; r;</span><br><span class="line">        --r;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            <span class="keyword">if</span> (u == v) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (adj.<span class="built_in">at</span>(u).<span class="built_in">find</span>(v) == adj.<span class="built_in">at</span>(u).<span class="built_in">end</span>()) &#123;</span><br><span class="line">                adj.<span class="built_in">at</span>(u)[v] = w;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                adj.<span class="built_in">at</span>(u)[v] = <span class="built_in">min</span>(adj.<span class="built_in">at</span>(u)[v], w);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// add edges</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[j, k] : adj.<span class="built_in">at</span>(i)) &#123;</span><br><span class="line">                edges.<span class="built_in">emplace_back</span>(i, j, k);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll result = <span class="built_in">Edmonds</span>(r, n);</span><br><span class="line">        <span class="keyword">if</span> (result == -INF) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; result &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Merge two std::priority_queue efficiently (combine the heap with less nodes to the heap with more nodes)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="comment">// O(n)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge_pq</span><span class="params">(std::priority_queue&lt;T&gt; &amp;dest, std::priority_queue&lt;T&gt; &amp;src)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dest.<span class="built_in">size</span>() &lt; src.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(dest, src);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        dest.<span class="built_in">push</span>(src.<span class="built_in">top</span>());</span><br><span class="line">        src.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Floyd_Warshall Algorithm O(n^3) for finding</span></span><br><span class="line"><span class="comment">// all pairs of shortest path in a graph</span></span><br><span class="line"><span class="keyword">namespace</span> APSP_Floyd_Warshall &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; am; <span class="comment">// adjacency matrix</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; prev; <span class="comment">// prev[i][j] is the previous vertex of j</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> number_of_nodes, <span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// reset</span></span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt; &gt;().<span class="built_in">swap</span>(am);</span><br><span class="line">        n = number_of_nodes;</span><br><span class="line">        am.<span class="built_in">resize</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n, INF));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            am[i][i] = <span class="number">0</span>;   <span class="comment">// true on most cases</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            prev.<span class="built_in">resize</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                prev[i][i] = i;   <span class="comment">// true on most cases</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">floyd_warshall</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123; <span class="comment">// order: k, i, j</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; ++k)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j)</span><br><span class="line">                    <span class="keyword">if</span> (am[i][k] &lt; INF &amp;&amp; am[k][j] &lt; INF) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (am[i][j] &gt; am[i][k] + am[k][j]) &#123;</span><br><span class="line">                            am[i][j] = am[i][k] + am[k][j];</span><br><span class="line">                            <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">                                prev[i][j] = prev[k][j];</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">        <span class="comment">// No need for graph with edges of non-negative weights</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">0</span>; t &lt; n; ++t)</span><br><span class="line">                    <span class="keyword">if</span> (am[i][t] &lt; INF &amp;&amp; am[t][t] &lt; <span class="number">0</span> &amp;&amp; am[t][j] &lt; INF)</span><br><span class="line">                        am[i][j] = -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Query the shortest distance from u to v</span></span><br><span class="line">    <span class="comment">// INF: cant reach -INF: in a negative cycle</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dist</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;u, <span class="type">const</span> <span class="type">int</span> &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> am[u][v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Print the path from u to v</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print_path</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;u, <span class="type">const</span> <span class="type">int</span> &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">dist</span>(u, v) == INF) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;\nthe final path does not exist\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (u != v) &#123;</span><br><span class="line">            <span class="built_in">print_path</span>(u, prev[u][v]);</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; v &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Usage</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> number_of_nodes, m, u, v, s, d;</span><br><span class="line">        cin &gt;&gt; number_of_nodes &gt;&gt; m;</span><br><span class="line">        <span class="built_in">init</span>(number_of_nodes, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            am[u][v] = <span class="number">1</span>;</span><br><span class="line">            prev[u][v] = u;</span><br><span class="line">            am[v][u] = <span class="number">1</span>;</span><br><span class="line">            prev[v][u] = v;</span><br><span class="line">        &#125;</span><br><span class="line">        cin &gt;&gt; s &gt;&gt; d;</span><br><span class="line">        <span class="built_in">floyd_warshall</span>(<span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">print_path</span>(s, d);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Floyd Warshall Algorithm to obtain the transitive closure of a directed-graph in O(N^3)</span></span><br><span class="line">vector&lt;vector&lt;<span class="type">bool</span>&gt; &gt;</span><br><span class="line"><span class="built_in">floyd_warshall</span>(<span class="type">int</span> n, <span class="type">const</span> vector&lt;vector&lt;<span class="type">bool</span>&gt; &gt; &amp;adjacency_matrix) &#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">bool</span>&gt; &gt; <span class="built_in">reach</span>(n, <span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;(n));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">            <span class="comment">// If there is an edge between i and j, that is, adjacency_matrix[i][j] is true, then we make its weight as 1 in &#x27;reach&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> (adjacency_matrix.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j)) &#123;</span><br><span class="line">                reach.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="comment">// If vertex k is on a path from i to j,</span></span><br><span class="line">                <span class="comment">// then make sure that the value of reach[i][j] is true</span></span><br><span class="line">                reach.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = reach.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) ||</span><br><span class="line">                                    (reach.<span class="built_in">at</span>(i).<span class="built_in">at</span>(k) &amp;&amp; reach.<span class="built_in">at</span>(k).<span class="built_in">at</span>(j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> reach;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Floyd Warshall Algorithm to obtain the transitive closure of a directed-graph in O(N^3 / w) with bitset optimized</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">size_t</span> N&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TransitiveClosure</span> &#123;</span><br><span class="line">    bitset&lt;N&gt; reach[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">floyd_warshall</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; ++k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (reach[i][k]) &#123;</span><br><span class="line">                    reach[i] |= reach[k];    <span class="comment">// reach[i] = reach[i] | reach[k];</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">            reach[i].<span class="built_in">reset</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Find minimum weight cycle in an undirected graph using Floyd</span></span><br><span class="line"><span class="keyword">namespace</span> MinimumWeightCycleUndirectedGraph &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj_matrix;</span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        adj_matrix.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>,</span><br><span class="line">                          <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(number_of_nodes + <span class="number">5</span>, INF));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= number_of_nodes; ++i) &#123;</span><br><span class="line">            adj_matrix.<span class="built_in">at</span>(i).<span class="built_in">at</span>(i) = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        adj_matrix.<span class="built_in">at</span>(u).<span class="built_in">at</span>(v) = w;</span><br><span class="line">        adj_matrix.<span class="built_in">at</span>(v).<span class="built_in">at</span>(u) = w;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Obtain the summation of weights in the minimum weight cycle,</span></span><br><span class="line">    <span class="comment">// return false if no such cycle exists</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">floyd</span><span class="params">(ll &amp;answer)</span> </span>&#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">dis</span>(adj_matrix);</span><br><span class="line">        answer = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= number_of_nodes; ++k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; k; ++i) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; ++j) &#123;</span><br><span class="line">                    answer = <span class="built_in">min</span>(answer, dis.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) * <span class="number">1LL</span> +</span><br><span class="line">                                         adj_matrix.<span class="built_in">at</span>(i).<span class="built_in">at</span>(k) +</span><br><span class="line">                                         adj_matrix.<span class="built_in">at</span>(k).<span class="built_in">at</span>(j));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= number_of_nodes; ++i) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= number_of_nodes; ++j) &#123;</span><br><span class="line">                    dis.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="built_in">min</span>(dis.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j),</span><br><span class="line">                                          dis.<span class="built_in">at</span>(i).<span class="built_in">at</span>(k) + dis.<span class="built_in">at</span>(k).<span class="built_in">at</span>(j));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> answer &lt; INF;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Find minimum weight cycle in a directed graph using Dijkstra with flag</span></span><br><span class="line"><span class="keyword">namespace</span> MinimumWeightCycleDirectedGraph &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">505</span>;   <span class="comment">// max nodes in the graph</span></span><br><span class="line"></span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; adj; <span class="comment">// The adjacency list of the graph</span></span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line">    bitset&lt;MAXN&gt; vis;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        <span class="comment">// initialize the containers</span></span><br><span class="line">        adj.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(v, w);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dijkstra</span><span class="params">(<span class="type">int</span> source)</span> </span>&#123;</span><br><span class="line">        vis.<span class="built_in">reset</span>();</span><br><span class="line">        <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(number_of_nodes + <span class="number">5</span>, INF)</span></span>;</span><br><span class="line">        dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        std::priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt;, greater&lt;&gt; &gt; pq;</span><br><span class="line">        pq.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis.<span class="built_in">at</span>(source), source));</span><br><span class="line">        <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> v = pq.<span class="built_in">top</span>().second;</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (vis[v]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            vis[v] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[to, w] : adj.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis.<span class="built_in">at</span>(to) &gt; dis.<span class="built_in">at</span>(v) + w) &#123;</span><br><span class="line">                    dis.<span class="built_in">at</span>(to) = dis.<span class="built_in">at</span>(v) + w;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[to]) &#123;</span><br><span class="line">                        pq.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis.<span class="built_in">at</span>(to), to));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// reset the start point</span></span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                vis[source] = <span class="literal">false</span>;</span><br><span class="line">                dis.<span class="built_in">at</span>(source) = INF;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = <span class="number">400</span>;    <span class="comment">// suppose in this case we have 400 nodes</span></span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">        <span class="comment">// ... After the construction of the graph, node id starts from 1</span></span><br><span class="line">        <span class="type">int</span> minimalCycle = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">auto</span> dis = <span class="built_in">dijkstra</span>(i);</span><br><span class="line">            minimalCycle = dis.<span class="built_in">at</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (minimalCycle == INF) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;No cycle found!&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; minimalCycle &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> APSP_Johnson &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MAX_NODES = <span class="number">3005</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="type">int</span> w;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">explicit</span> <span class="title">Edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> : u(u), v(v), w(w) &#123;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Data members of the graph G</span></span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">    <span class="type">int</span> source;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; adj; <span class="comment">// The adjacency list of the graph</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// An implementation of Shortest Path Faster Algorithm (Bellman-Ford&#x27;s algorithm with queue optimized)</span></span><br><span class="line">    <span class="keyword">namespace</span> SSSP_SPFA &#123;</span><br><span class="line"></span><br><span class="line">        bitset&lt;MAX_NODES&gt; in_queue;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; dis;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// O(mn)</span></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(number_of_nodes + <span class="number">5</span>)</span></span>;</span><br><span class="line">            queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">            q.<span class="built_in">push</span>(source);</span><br><span class="line">            in_queue[source] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">                in_queue[u] = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[v, w] : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (dis.<span class="built_in">at</span>(v) &gt; dis.<span class="built_in">at</span>(u) + w) &#123;</span><br><span class="line">                        dis.<span class="built_in">at</span>(v) = dis.<span class="built_in">at</span>(u) + w;</span><br><span class="line">                        <span class="keyword">if</span> (!in_queue[v]) &#123;</span><br><span class="line">                            q.<span class="built_in">push</span>(v);</span><br><span class="line">                            in_queue[v] = <span class="literal">true</span>;</span><br><span class="line">                            ++cnt.<span class="built_in">at</span>(v);</span><br><span class="line">                            <span class="keyword">if</span> (cnt.<span class="built_in">at</span>(v) &gt; number_of_nodes) &#123;</span><br><span class="line">                                <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">// a negative cycle exists</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The implementation of Dijkstra using adjacency list (based on the index)</span></span><br><span class="line">    <span class="keyword">namespace</span> SSSP_Dijkstra &#123;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">            <span class="type">int</span> to, distance, next;</span><br><span class="line"></span><br><span class="line">            <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> Edge &amp;other) <span class="type">const</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> to == other.to &amp;&amp; distance == other.distance &amp;&amp;</span><br><span class="line">                       next == other.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">            <span class="type">int</span> distance, position;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">explicit</span> <span class="title">Node</span><span class="params">(<span class="type">int</span> distance, <span class="type">int</span> position)</span> : distance(distance),</span></span><br><span class="line"><span class="function">                                                        position(position) &#123;</span>&#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Node &amp;other) <span class="type">const</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> (other.distance &lt; distance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Containers to store the graph</span></span><br><span class="line">        vector&lt;Edge&gt; E;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; head;</span><br><span class="line">        <span class="type">int</span> counter;</span><br><span class="line">        <span class="type">int</span> number_of_nodes;</span><br><span class="line">        <span class="type">int</span> number_of_edges;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; dis;    <span class="comment">// dis.at(n) = the shortest distance from source to n</span></span><br><span class="line">        bitset&lt;MAX_NODES&gt; vis;</span><br><span class="line">        <span class="type">int</span> source;         <span class="comment">// the node id of the source</span></span><br><span class="line">        std::priority_queue&lt;Node&gt; pq;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> e)</span> </span>&#123;</span><br><span class="line">            number_of_nodes = n;</span><br><span class="line">            number_of_edges = e;</span><br><span class="line">            <span class="comment">// initialize the containers</span></span><br><span class="line">            E.<span class="built_in">resize</span>(number_of_edges + <span class="number">5</span>);</span><br><span class="line">            head.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">            dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="built_in">fill</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>(), INF);</span><br><span class="line">            vis.<span class="built_in">reset</span>();</span><br><span class="line">            std::<span class="built_in">priority_queue</span>&lt;Node&gt;().<span class="built_in">swap</span>(pq);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">            ++counter;</span><br><span class="line">            E.<span class="built_in">at</span>(counter).distance = w;</span><br><span class="line">            E.<span class="built_in">at</span>(counter).to = v;</span><br><span class="line">            E.<span class="built_in">at</span>(counter).next = head.<span class="built_in">at</span>(u);</span><br><span class="line">            head.<span class="built_in">at</span>(u) = counter;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">            pq.<span class="built_in">push</span>(<span class="built_in">Node</span>(dis.<span class="built_in">at</span>(source), source));</span><br><span class="line">            <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                Node temp_node = pq.<span class="built_in">top</span>();</span><br><span class="line">                pq.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="type">int</span> x = temp_node.position;</span><br><span class="line">                <span class="keyword">if</span> (vis[x]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                vis[x] = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = head.<span class="built_in">at</span>(x); i; i = E.<span class="built_in">at</span>(i).next) &#123;</span><br><span class="line">                    <span class="type">int</span> y = E.<span class="built_in">at</span>(i).to;</span><br><span class="line">                    <span class="keyword">if</span> (dis.<span class="built_in">at</span>(y) &gt; dis.<span class="built_in">at</span>(x) + E.<span class="built_in">at</span>(i).distance) &#123;</span><br><span class="line">                        dis.<span class="built_in">at</span>(y) = dis.<span class="built_in">at</span>(x) + E.<span class="built_in">at</span>(i).distance;</span><br><span class="line">                        <span class="keyword">if</span> (!vis[y]) &#123;</span><br><span class="line">                            pq.<span class="built_in">push</span>(<span class="built_in">Node</span>(dis.<span class="built_in">at</span>(y), y));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; d; <span class="comment">// d[i][j] indicates the distance of shortest path from i to j after running Johnson&#x27;s algorithm</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">johnson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// construct the graph G_prime</span></span><br><span class="line">        source = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= number_of_nodes; ++v) &#123;</span><br><span class="line">            edges.<span class="built_in">emplace_back</span>(<span class="built_in">Edge</span>(source, v, <span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// convert edges of G_prime into &#x27;adj&#x27;</span></span><br><span class="line">        adj.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;e : edges) &#123;</span><br><span class="line">            adj.<span class="built_in">at</span>(e.u).<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(e.v, e.w));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// init spfa</span></span><br><span class="line">        SSSP_SPFA::dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        SSSP_SPFA::dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// run spfa</span></span><br><span class="line">        <span class="keyword">if</span> (!SSSP_SPFA::<span class="built_in">spfa</span>()) &#123;</span><br><span class="line">            <span class="comment">// graph G contains a negative cycle</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// update all edges in G</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : edges) &#123;</span><br><span class="line">            e.w += SSSP_SPFA::dis.<span class="built_in">at</span>(e.u) - SSSP_SPFA::dis.<span class="built_in">at</span>(e.v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// initialize &#x27;d&#x27;</span></span><br><span class="line">        d.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>,</span><br><span class="line">                 <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(number_of_nodes + <span class="number">5</span>));</span><br><span class="line">        <span class="comment">// initialize Dijkstra</span></span><br><span class="line">        SSSP_Dijkstra::<span class="built_in">init</span>(number_of_nodes, <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(edges.<span class="built_in">size</span>()));</span><br><span class="line">        <span class="comment">// add edges</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;e : edges) &#123;</span><br><span class="line">            SSSP_Dijkstra::<span class="built_in">add_edge</span>(e.u, e.v, e.w);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt;= number_of_nodes; ++u) &#123;</span><br><span class="line">            <span class="comment">// run Dijkstra from each node</span></span><br><span class="line">            SSSP_Dijkstra::source = u;</span><br><span class="line">            SSSP_Dijkstra::<span class="built_in">dijkstra</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= number_of_nodes; ++v) &#123;</span><br><span class="line">                <span class="keyword">if</span> (SSSP_Dijkstra::dis.<span class="built_in">at</span>(v) == INF) &#123;</span><br><span class="line">                    d.<span class="built_in">at</span>(u).<span class="built_in">at</span>(v) = INF;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    d.<span class="built_in">at</span>(u).<span class="built_in">at</span>(v) =</span><br><span class="line">                            SSSP_Dijkstra::dis.<span class="built_in">at</span>(v) + SSSP_SPFA::dis.<span class="built_in">at</span>(v) -</span><br><span class="line">                            SSSP_SPFA::dis.<span class="built_in">at</span>(u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// reset dijkstra</span></span><br><span class="line">            SSSP_Dijkstra::<span class="built_in">reset</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An example that does graph traversal with BFS from &#x27;s&#x27;</span></span><br><span class="line"><span class="comment">// Suppose the weight of each edge is the same.</span></span><br><span class="line"><span class="keyword">namespace</span> BFS_Example &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> WEIGHT = <span class="number">1</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;   <span class="comment">// adjacency list</span></span><br><span class="line">    <span class="type">int</span> s;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; prev; <span class="comment">// an auxiliary container to store the path</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dis; <span class="comment">// dis.at(n) = the distance of shortest path from &#x27;s&#x27; to n</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> number_of_nodes, <span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            prev.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        dis.<span class="built_in">at</span>(s) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;to : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis.<span class="built_in">at</span>(to) == INF) &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(to);</span><br><span class="line">                    dis.<span class="built_in">at</span>(to) = dis.<span class="built_in">at</span>(u) + WEIGHT;</span><br><span class="line">                    <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">                        prev.<span class="built_in">at</span>(to) = u;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">get_path</span><span class="params">(<span class="type">int</span> destination)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = destination; i != <span class="number">-1</span>; i = prev.<span class="built_in">at</span>(i)) &#123;</span><br><span class="line">            result.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Implementation of next_combination, duplicated values will be shown once</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Itr&gt;</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">next_combination</span><span class="params">(<span class="type">const</span> Itr &amp;first, Itr k, <span class="type">const</span> Itr &amp;last)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((first == last) || (first == k) || (last == k))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Itr iter1 = first, iter2 = last;</span><br><span class="line">    ++iter1;</span><br><span class="line">    <span class="keyword">if</span> (last == iter1) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    iter1 = k;</span><br><span class="line">    --iter2;</span><br><span class="line">    <span class="keyword">while</span> (first != iter1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (*--iter1 &lt; *iter2) &#123;</span><br><span class="line">            Itr j = k;</span><br><span class="line">            <span class="keyword">while</span> (!(*iter1 &lt; *j)) ++j;</span><br><span class="line">            std::<span class="built_in">iter_swap</span>(iter1, j);</span><br><span class="line">            ++iter1;</span><br><span class="line">            ++j;</span><br><span class="line">            iter2 = k;</span><br><span class="line">            std::<span class="built_in">rotate</span>(iter1, j, last);</span><br><span class="line">            <span class="keyword">while</span> (last != j) ++j, ++iter2;</span><br><span class="line">            std::<span class="built_in">rotate</span>(k, iter2, last);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    std::<span class="built_in">rotate</span>(first, k, last);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">next_combination_usage</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Usage: next_combination on vector&lt;int&gt;</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A = &#123;<span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(A.<span class="built_in">begin</span>(), A.<span class="built_in">end</span>()); <span class="comment">// Must sort first</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// The length of the array in the combination</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> comb_size = <span class="number">1</span>; comb_size &lt;= <span class="number">3</span>; ++comb_size) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; comb_size; i++) &#123;</span><br><span class="line">                cout &lt;&lt; A[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; endl;</span><br><span class="line">        &#125; <span class="keyword">while</span> (<span class="built_in">next_combination</span>(A.<span class="built_in">begin</span>(), A.<span class="built_in">begin</span>() + comb_size, A.<span class="built_in">end</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Usage: next_combination on string</span></span><br><span class="line">    string s = <span class="string">&quot;ashdioK&quot;</span>;</span><br><span class="line">    <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> comb_size = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">string</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">begin</span>() + comb_size) &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="built_in">next_combination</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">begin</span>() + comb_size, s.<span class="built_in">end</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Longest Common Substrings: O(a.size() * b.size())</span></span><br><span class="line"><span class="function">unordered_set&lt;string&gt; <span class="title">longestCommonSubstring</span><span class="params">(<span class="type">const</span> string &amp;a, <span class="type">const</span> string &amp;b)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    unordered_set&lt;string&gt; result;</span><br><span class="line">    <span class="keyword">if</span> (a.<span class="built_in">empty</span>() || b.<span class="built_in">empty</span>()) <span class="keyword">return</span> result;</span><br><span class="line">    <span class="type">int</span> r = (<span class="type">int</span>)a.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">int</span> n = (<span class="type">int</span>)b.<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">dp</span>(r, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">    <span class="type">int</span> z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.<span class="built_in">at</span>(i) == b.<span class="built_in">at</span>(j)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span> || j == <span class="number">0</span>) &#123;</span><br><span class="line">                    dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = dp.<span class="built_in">at</span>(i<span class="number">-1</span>).<span class="built_in">at</span>(j<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) &gt; z) &#123;</span><br><span class="line">                    z = dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j);</span><br><span class="line">                    result.<span class="built_in">clear</span>();</span><br><span class="line">                    result.<span class="built_in">insert</span>(a.<span class="built_in">substr</span>(i-z+<span class="number">1</span>,z));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) == z) &#123;</span><br><span class="line">                    result.<span class="built_in">insert</span>(a.<span class="built_in">substr</span>(i-z+<span class="number">1</span>,z));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Longest Common Subsequence: O(A.size()*B.size())</span></span><br><span class="line"><span class="comment">// assert( longestCommonSubseq(&quot;abcde&quot;, &quot;bcef&quot;) == 3 );</span></span><br><span class="line"><span class="keyword">auto</span> longestCommonSubseq = [](<span class="type">const</span> <span class="keyword">auto</span> &amp;A, <span class="type">const</span> <span class="keyword">auto</span> &amp;B) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len_A = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(A.<span class="built_in">size</span>());</span><br><span class="line">    <span class="type">int</span> len_B = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(B.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">if</span> (len_A == <span class="number">0</span> || len_B == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">dp</span>(len_A, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(len_B));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> a = <span class="number">0</span>; a &lt; len_A; a++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">0</span>; b &lt; len_B; b++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a) dp[a][b] = <span class="built_in">max</span>(dp[a][b], dp[a - <span class="number">1</span>][b]);</span><br><span class="line">            <span class="keyword">if</span> (b) dp[a][b] = <span class="built_in">max</span>(dp[a][b], dp[a][b - <span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (A[a] == B[b])</span><br><span class="line">                dp[a][b] = <span class="built_in">max</span>(dp[a][b], ((a &amp;&amp; b) ? dp[a - <span class="number">1</span>][b - <span class="number">1</span>] : <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ret = dp[len_A - <span class="number">1</span>][len_B - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LevenshteinDistance</span><span class="params">(<span class="type">const</span> string &amp;a, <span class="type">const</span> string &amp;b)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> a_length = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(a.<span class="built_in">size</span>());</span><br><span class="line">    <span class="type">int</span> b_length = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(b.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (a_length == <span class="number">0</span>) <span class="keyword">return</span> b_length;</span><br><span class="line">    <span class="keyword">if</span> (b_length == <span class="number">0</span>) <span class="keyword">return</span> a_length;</span><br><span class="line"></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">dp</span>(a_length + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(b_length + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= a_length; ++i) &#123;</span><br><span class="line">        dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(<span class="number">0</span>) = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= b_length; ++j) &#123;</span><br><span class="line">        dp.<span class="built_in">at</span>(<span class="number">0</span>).<span class="built_in">at</span>(j) = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cost;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= a_length; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= b_length; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.<span class="built_in">at</span>(i - <span class="number">1</span>) == b.<span class="built_in">at</span>(j - <span class="number">1</span>)) &#123;</span><br><span class="line">                cost = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cost = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="built_in">min</span>(</span><br><span class="line">                    dp.<span class="built_in">at</span>(i - <span class="number">1</span>).<span class="built_in">at</span>(j) + <span class="number">1</span>,</span><br><span class="line">                    <span class="built_in">min</span>(dp.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j - <span class="number">1</span>) + <span class="number">1</span>, dp.<span class="built_in">at</span>(i - <span class="number">1</span>).<span class="built_in">at</span>(j - <span class="number">1</span>) + cost)</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp.<span class="built_in">at</span>(a_length).<span class="built_in">at</span>(b_length);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate the prime table from 1 to MAXN</span></span><br><span class="line"><span class="comment">// Usage: Sieve primes from 1 to 1005: EulerPrimeSieve::init();</span></span><br><span class="line"><span class="comment">// Usage: Check if N is a prime: !EulerPrimeSieve::isNotPrime[N];</span></span><br><span class="line"><span class="comment">// Usage: Check the kth prime: EulerPrimeSieve::prime[k - 1];</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Reduce num_prime to the number of primes if the space is not enough.</span></span><br><span class="line"><span class="keyword">namespace</span> EulerPrimeSieve &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line">    <span class="type">int</span> prime[MAXN] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> num_prime = <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> isNotPrime[MAXN] = &#123;<span class="literal">true</span>, <span class="literal">true</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Generate the prime table from 1 to MAXN</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isNotPrime[i])</span><br><span class="line">                prime[num_prime++] = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; num_prime &amp;&amp; i * prime[j] &lt; MAXN; j++) &#123;</span><br><span class="line">                isNotPrime[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">if</span> (!(i % prime[j]))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only check if n &lt; MAXN is a prime</span></span><br><span class="line"><span class="keyword">namespace</span> EulerPrimeSieve_ &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line">    bitset&lt;MAXN&gt; isNotPrime;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        isNotPrime[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        isNotPrime[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isNotPrime[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &gt; MAXN / i) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = i * i; j &lt; MAXN; j += i) &#123;</span><br><span class="line">                    isNotPrime[j] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calculate a^n (n &gt;= 0) in O(lgn) without recursion</span></span><br><span class="line"><span class="function">ll <span class="title">quickPower</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            res *= a;</span><br><span class="line">        &#125;</span><br><span class="line">        a *= a;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i * i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calculate (a^n) % m (n &gt;= 0, m &gt; 0) in O(lgn) without recursion</span></span><br><span class="line"><span class="function">ll <span class="title">quickPower</span><span class="params">(ll a, ll n, ll m)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Corner case:</span></span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If m is a prime, then (a^n) % m = a^(n % (m - 1)) % m (Fermat&#x27;s little theorem)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isPrime</span>(m)) &#123;</span><br><span class="line">        n = n % (m - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    a %= m;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            res = res * a % m;</span><br><span class="line">        &#125;</span><br><span class="line">        a = a * a % m;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O(1) modulo mul</span></span><br><span class="line"><span class="function">ll <span class="title">multmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">    a = (a % m + m) % m;</span><br><span class="line">    b = (b % m + m) % m;</span><br><span class="line">    <span class="keyword">return</span> ((a * b - (ll)((<span class="type">long</span> <span class="type">double</span>)(a) / m * b) * m) %</span><br><span class="line">            m + m) % m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O(logb), better version</span></span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll r;</span><br><span class="line">    <span class="keyword">for</span> (r = <span class="number">1</span>, a %= m; b; a = <span class="built_in">multmod</span>(a, a, m), b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span>) r = <span class="built_in">multmod</span>(r, a, m);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a % p = a - floor(a / p) * p</span></span><br><span class="line"><span class="comment">// For a^b % p:</span></span><br><span class="line"><span class="comment">// If p is prime: a^b % p = a^(b % (p-1)) % p</span></span><br><span class="line"><span class="comment">// Otherwise: a^b % p = a^(b % phi(p) + phi(p)) % p</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// A way to hash fixed length array</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> MAXLENGTH = <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">myHashFunc</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> array&lt;<span class="type">int</span>, MAXLENGTH&gt; &amp;A)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">size_t</span> h = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;i : A) &#123;</span><br><span class="line">            h ^= hash&lt;<span class="type">int</span>&gt;&#123;&#125;(i) + <span class="number">0x9e3779b9</span> + (h &lt;&lt; <span class="number">6</span>) + (h &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use gp_hash_table + custom hash function to accelerate</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">custom_hash</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">uint64_t</span> <span class="title">splitmix64</span><span class="params">(<span class="type">uint64_t</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// http://xorshift.di.unimi.it/splitmix64.c</span></span><br><span class="line">        x += <span class="number">0x9e3779b97f4a7c15</span>;</span><br><span class="line">        x = (x ^ (x &gt;&gt; <span class="number">30</span>)) * <span class="number">0xbf58476d1ce4e5b9</span>;</span><br><span class="line">        x = (x ^ (x &gt;&gt; <span class="number">27</span>)) * <span class="number">0x94d049bb133111eb</span>;</span><br><span class="line">        <span class="keyword">return</span> x ^ (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">uint64_t</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">splitmix64</span>(x + FIXED_RANDOM);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For a pair of integers</span></span><br><span class="line">    <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(pair&lt;<span class="type">uint64_t</span>, <span class="type">uint64_t</span>&gt; x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">splitmix64</span>(x.first + FIXED_RANDOM) ^</span><br><span class="line">               (<span class="built_in">splitmix64</span>(x.second + FIXED_RANDOM) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gp_hash_table&lt;<span class="type">int</span>, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, custom_hash&gt; my_hash_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage:</span></span><br><span class="line"><span class="comment">// auto dp = MultiDimensionArray::Array&lt;int&gt;(5, 4, 12);</span></span><br><span class="line"><span class="comment">// auto dp__ = MultiDimensionArray::Array&lt;double&gt;(4, 5, 1, 1.0);</span></span><br><span class="line"><span class="keyword">namespace</span> MultiDimensionArray &#123;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> ... Args&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">auto</span> <span class="title">Array</span><span class="params">(<span class="type">size_t</span> n, Args &amp;&amp;... args)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">if</span> <span class="title">constexpr</span> <span class="params">(<span class="number">1</span> == <span class="keyword">sizeof</span> ... (args))</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">vector</span>&lt;T&gt;(n, args ...);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">vector</span>(n, <span class="built_in">Array</span>&lt;T&gt;(args...));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// max and min in double type with unknown number of arguments(at least 2)</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> EPS = <span class="number">1e-6</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">constexpr</span> <span class="type">static</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">const</span> <span class="type">double</span> &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; EPS) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; -EPS) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T = <span class="type">double</span>&gt;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span><br><span class="line">T &amp; <span class="built_in">doubleMax</span>(<span class="type">const</span> T &amp;a) &#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T </span>= <span class="type">double</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">T &amp; <span class="title">doubleMax</span><span class="params">(<span class="type">const</span> T &amp;l, <span class="type">const</span> T &amp;r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sgn</span>(l - r) &gt;= <span class="number">0</span> ? l : r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T </span>= <span class="type">double</span>, <span class="keyword">typename</span> ... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">T &amp; <span class="title">doubleMax</span><span class="params">(<span class="type">const</span> T &amp;l, <span class="type">const</span> Args &amp;... args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">doubleMax</span>(l, <span class="built_in">doubleMax</span>(args ...));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T = <span class="type">double</span>&gt;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span><br><span class="line">T &amp; <span class="built_in">doubleMin</span>(<span class="type">const</span> T &amp;a) &#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T </span>= <span class="type">double</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">T &amp; <span class="title">doubleMin</span><span class="params">(<span class="type">const</span> T &amp;l, <span class="type">const</span> T &amp;r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sgn</span>(l - r) &gt;= <span class="number">0</span> ? r : l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T </span>= <span class="type">double</span>, <span class="keyword">typename</span> ... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">const</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">T &amp; <span class="title">doubleMin</span><span class="params">(<span class="type">const</span> T&amp; l, <span class="type">const</span> Args&amp; ... args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">doubleMin</span>(l, <span class="built_in">doubleMin</span>(args ...));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reference:</span></span><br><span class="line"><span class="comment">// https://cs.uwaterloo.ca/~m32rober/rsqrt.pdf</span></span><br><span class="line"><span class="comment">// http://www.lomont.org/papers/2003/InvSqrt.pdf</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// FAST INVERSE SQUARE ROOT in long double</span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">inv_sqrt64</span><span class="params">(<span class="type">double</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> x2 = n * <span class="number">0.5</span>;</span><br><span class="line">    <span class="type">double</span> y = n;</span><br><span class="line">    <span class="type">uint64_t</span> i = *(<span class="type">uint64_t</span> *) &amp;y;</span><br><span class="line">    i = <span class="number">0x5fe6eb50c7b537a9</span> - (i &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    y = *(<span class="type">double</span> *) &amp;i;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add more Newton iterations if you wanna improve the accuracy</span></span><br><span class="line">    y = y * (<span class="number">1.5</span> - (x2 * y * y));</span><br><span class="line">    y = y * (<span class="number">1.5</span> - (x2 * y * y));</span><br><span class="line">    <span class="comment">//y = y * (1.5 - (x2 * y * y));</span></span><br><span class="line">    <span class="comment">//y = y * (1.5 - (x2 * y * y));</span></span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A collection of containers and procedures that implements Tarjan&#x27;s strongly</span></span><br><span class="line"><span class="comment">// connected components algorithm. Assume that the node id starts from 1 and the</span></span><br><span class="line"><span class="comment">// index of a strongly connected component (SCC) also starts from 1</span></span><br><span class="line"><span class="keyword">namespace</span> SCC_Tarjan &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// adjacency list of the graph</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; G;</span><br><span class="line">    <span class="comment">// number of nodes in the graph</span></span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line">    <span class="comment">// number of strongly connected components</span></span><br><span class="line">    <span class="type">int</span> number_of_scc;</span><br><span class="line">    <span class="type">int</span> current_timestamp;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s;   <span class="comment">// A stack is used to store all nodes that may form a</span></span><br><span class="line">    <span class="comment">// strongly connected component</span></span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt;</span><br><span class="line">            vis; <span class="comment">// vis.at(id) flags if the node id is in the stack</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dfs_rank; <span class="comment">// dfs_rank.at(id) numbers the nodes consecutively in</span></span><br><span class="line">    <span class="comment">// the order in which they are discovered by DFS</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; low_link; <span class="comment">// low_link.at(id) represents the smallest node id of</span></span><br><span class="line">    <span class="comment">// any node known to be reachable from id through</span></span><br><span class="line">    <span class="comment">// id&#x27;s DFS subtree, including id itself</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; scc;      <span class="comment">// scc.at(id) is the index of the strongly connected</span></span><br><span class="line">    <span class="comment">// component that the node id belongs to</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; size_of_scc; <span class="comment">// size_of_scc.at(id) is the size of the strongly</span></span><br><span class="line">    <span class="comment">// connected component whose index is id</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// reset all containers</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">decltype</span>(G)().<span class="built_in">swap</span>(G);</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(s);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;().<span class="built_in">swap</span>(vis);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dfs_rank);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(low_link);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(scc);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(size_of_scc);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize all global variables in the namespace</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        number_of_scc = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// NOTICE: starts from 1 if the node id starts from 1</span></span><br><span class="line">        current_timestamp = <span class="number">1</span>;</span><br><span class="line">        G.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        vis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="literal">false</span>);</span><br><span class="line">        dfs_rank.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">        low_link.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">        scc.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">        size_of_scc.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123; <span class="comment">// u: the node id being processed</span></span><br><span class="line">        dfs_rank.<span class="built_in">at</span>(u) = current_timestamp;</span><br><span class="line">        low_link.<span class="built_in">at</span>(u) = current_timestamp;</span><br><span class="line">        ++current_timestamp;</span><br><span class="line">        s.<span class="built_in">push</span>(u);</span><br><span class="line">        vis.<span class="built_in">at</span>(u) = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dfs_rank[v]) &#123;</span><br><span class="line">                <span class="built_in">Tarjan</span>(v);</span><br><span class="line">                low_link.<span class="built_in">at</span>(u) = <span class="built_in">min</span>(low_link.<span class="built_in">at</span>(u), low_link.<span class="built_in">at</span>(v));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vis.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                low_link.<span class="built_in">at</span>(u) = <span class="built_in">min</span>(low_link.<span class="built_in">at</span>(u), dfs_rank.<span class="built_in">at</span>(v));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (low_link.<span class="built_in">at</span>(u) == dfs_rank.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">            ++number_of_scc;</span><br><span class="line">            <span class="keyword">while</span> (s.<span class="built_in">top</span>() != u) &#123;</span><br><span class="line">                <span class="type">int</span> top_id = s.<span class="built_in">top</span>();</span><br><span class="line">                <span class="comment">// Paint top_id</span></span><br><span class="line">                s.<span class="built_in">pop</span>();</span><br><span class="line">                scc.<span class="built_in">at</span>(top_id) = number_of_scc;</span><br><span class="line">                ++size_of_scc.<span class="built_in">at</span>(number_of_scc);</span><br><span class="line">                vis.<span class="built_in">at</span>(top_id) = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Paint u</span></span><br><span class="line">            s.<span class="built_in">pop</span>();</span><br><span class="line">            scc.<span class="built_in">at</span>(u) = number_of_scc;</span><br><span class="line">            ++size_of_scc.<span class="built_in">at</span>(number_of_scc);</span><br><span class="line">            vis.<span class="built_in">at</span>(u) = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m, u, v;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            G[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Run Tarjan&#x27;s SCC algorithm</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="comment">// Process node i if the node i has not been visited</span></span><br><span class="line">            <span class="keyword">if</span> (!dfs_rank.<span class="built_in">at</span>(i)) &#123;</span><br><span class="line">                <span class="built_in">Tarjan</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A collection of containers and procedures that implements the topological</span></span><br><span class="line"><span class="comment">// sort using Kahn&#x27;s algorithm</span></span><br><span class="line"><span class="keyword">namespace</span> Toposort_Kahn &#123;</span><br><span class="line">    <span class="comment">// adjacency list of the graph</span></span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, unordered_set&lt;<span class="type">int</span>, custom_hash&gt;, custom_hash&gt; G;</span><br><span class="line">    <span class="type">int</span> number_of_nodes;    <span class="comment">// assume that the node id starts from 1</span></span><br><span class="line">    <span class="comment">// the number of incoming edges of each node, should be calculated during</span></span><br><span class="line">    <span class="comment">// the construction of the graph, not forget that the node id starts from 1</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; in_degree;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; result; <span class="comment">// store the result after toposort</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        G.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(in_degree);</span><br><span class="line">        number_of_nodes = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        in_degree.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Main logic of Kahn&#x27;s algorithm: O(V+E), return true if it does not</span></span><br><span class="line">    <span class="comment">// have a cycle, otherwise false</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">kahn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= number_of_nodes; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(i) == <span class="number">0</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            result.<span class="built_in">emplace_back</span>(u);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;adj_v : G[u]) &#123;</span><br><span class="line">                --in_degree.<span class="built_in">at</span>(adj_v);</span><br><span class="line">                <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(adj_v) == <span class="number">0</span>) &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(adj_v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(result.<span class="built_in">size</span>()) == number_of_nodes);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Kahn&#x27;s algo if G is an undirected graph (also can be used to find nodes in the cycle)</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">kahn2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(number_of_nodes+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= number_of_nodes; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(i) &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> visCounter = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            vis[u] = <span class="literal">true</span>;</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            ++visCounter;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;adj_v : G[u]) &#123;</span><br><span class="line">                --in_degree.<span class="built_in">at</span>(adj_v);</span><br><span class="line">                <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(adj_v) == <span class="number">1</span>) &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(adj_v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// if vis[i] is false (i is not visited), then i is a node in cycles</span></span><br><span class="line">        <span class="keyword">return</span> visCounter == number_of_nodes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Main logic of Kahn&#x27;s algorithm but the output should be lexicographically</span></span><br><span class="line">    <span class="comment">// smallest among all possible results after toposort: O(|V|log|V|+|E|)    </span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">kahn_with_lexicographically_smallest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        std::priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt; &gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= number_of_nodes; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(i) == <span class="number">0</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">top</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            result.<span class="built_in">emplace_back</span>(u);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;adj_v : G[u]) &#123;</span><br><span class="line">                --in_degree.<span class="built_in">at</span>(adj_v);</span><br><span class="line">                <span class="keyword">if</span> (in_degree.<span class="built_in">at</span>(adj_v) == <span class="number">0</span>) &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(adj_v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(result.<span class="built_in">size</span>()) == number_of_nodes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">construct_the_graph</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Toposort_Kahn::<span class="built_in">init</span>(<span class="number">6</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">6</span>].<span class="built_in">insert</span>(<span class="number">3</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">3</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">6</span>].<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">1</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">5</span>].<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">1</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">5</span>].<span class="built_in">insert</span>(<span class="number">2</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">2</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">3</span>].<span class="built_in">insert</span>(<span class="number">4</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">4</span>);</span><br><span class="line">    Toposort_Kahn::G[<span class="number">4</span>].<span class="built_in">insert</span>(<span class="number">2</span>);</span><br><span class="line">    ++Toposort_Kahn::in_degree.<span class="built_in">at</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_for_toposort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">construct_the_graph</span>();</span><br><span class="line">    <span class="built_in">assert</span>(Toposort_Kahn::<span class="built_in">kahn</span>());</span><br><span class="line">    Toposort_Kahn::<span class="built_in">reset</span>();</span><br><span class="line">    <span class="built_in">construct_the_graph</span>();</span><br><span class="line">    <span class="built_in">assert</span>(Toposort_Kahn::<span class="built_in">kahn_with_lexicographically_smallest</span>());</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; result = &#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    <span class="built_in">assert</span>(Toposort_Kahn::result == result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A collection of containers and procedures that implements the topological</span></span><br><span class="line"><span class="comment">// sort using DFS</span></span><br><span class="line"><span class="keyword">namespace</span> Toposort_Dfs &#123;</span><br><span class="line">    <span class="comment">// adjacency list of the graph</span></span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, unordered_set&lt;<span class="type">int</span>, custom_hash&gt;, custom_hash&gt; G;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vis;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; result;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        vis[u] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (vis[v] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!dfs[v]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        result.<span class="built_in">emplace_back</span>(u);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">toposort</span><span class="params">(<span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// reset</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(vis);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(result);</span><br><span class="line">        vis.<span class="built_in">resize</span>(number_of_nodes);</span><br><span class="line">        <span class="comment">// start DFS from 0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; number_of_nodes; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">dfs</span>(i)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The implementation of Dijkstra using adjacency list (based on the index)</span></span><br><span class="line"><span class="keyword">namespace</span> SSSP_Dijkstra_0 &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>; <span class="comment">//  A weight indicates two nodes have no paths between them</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> to, distance, next;</span><br><span class="line"></span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> Edge &amp;other) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> to == other.to &amp;&amp; distance == other.distance &amp;&amp;</span><br><span class="line">                   next == other.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="type">int</span> distance, position;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">explicit</span> <span class="title">Node</span><span class="params">(<span class="type">int</span> distance, <span class="type">int</span> position)</span> : distance(distance),</span></span><br><span class="line"><span class="function">                                                    position(position) &#123;</span>&#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Node &amp;other) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (other.distance &lt; distance);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Containers to store the graph</span></span><br><span class="line">    vector&lt;Edge&gt; E;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; head;</span><br><span class="line">    <span class="type">int</span> counter;</span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line">    <span class="type">int</span> number_of_edges;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dis;    <span class="comment">// dis.at(n) = the shortest distance from source to n</span></span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; vis;</span><br><span class="line">    <span class="type">int</span> source;         <span class="comment">// the node id of the source</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; prev;   <span class="comment">// an auxiliary container to store the path</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// __gnu_pbds::priority_queue&lt;Node, less&lt;&gt;, pairing_heap_tag&gt; pq; // Alternative option if you want to use pairing heap</span></span><br><span class="line">    std::priority_queue&lt;Node&gt; pq;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> e, <span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        number_of_edges = e;</span><br><span class="line">        <span class="comment">// initialize the containers</span></span><br><span class="line">        E.<span class="built_in">resize</span>(number_of_edges + <span class="number">5</span>);</span><br><span class="line">        head.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        vis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            prev.<span class="built_in">resize</span>(number_of_nodes, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>(), INF);</span><br><span class="line">        <span class="built_in">fill</span>(vis.<span class="built_in">begin</span>(), vis.<span class="built_in">end</span>(), <span class="literal">false</span>);</span><br><span class="line">        std::<span class="built_in">priority_queue</span>&lt;Node&gt;().<span class="built_in">swap</span>(pq);</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            <span class="built_in">fill</span>(prev.<span class="built_in">begin</span>(), prev.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        ++counter;</span><br><span class="line">        E.<span class="built_in">at</span>(counter).distance = w;</span><br><span class="line">        E.<span class="built_in">at</span>(counter).to = v;</span><br><span class="line">        E.<span class="built_in">at</span>(counter).next = head.<span class="built_in">at</span>(u);</span><br><span class="line">        head.<span class="built_in">at</span>(u) = counter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">dijkstra</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        pq.<span class="built_in">push</span>(<span class="built_in">Node</span>(dis.<span class="built_in">at</span>(source), source));</span><br><span class="line">        <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            Node temp_node = pq.<span class="built_in">top</span>();</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="type">int</span> x = temp_node.position;</span><br><span class="line">            <span class="keyword">if</span> (vis.<span class="built_in">at</span>(x)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            vis.<span class="built_in">at</span>(x) = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head.<span class="built_in">at</span>(x); i; i = E.<span class="built_in">at</span>(i).next) &#123;</span><br><span class="line">                <span class="type">int</span> y = E.<span class="built_in">at</span>(i).to;</span><br><span class="line">                <span class="keyword">if</span> (dis.<span class="built_in">at</span>(y) &gt; dis.<span class="built_in">at</span>(x) + E.<span class="built_in">at</span>(i).distance) &#123;</span><br><span class="line">                    dis.<span class="built_in">at</span>(y) = dis.<span class="built_in">at</span>(x) + E.<span class="built_in">at</span>(i).distance;</span><br><span class="line">                    <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">                        prev.<span class="built_in">at</span>(y) = x;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (!vis.<span class="built_in">at</span>(y)) &#123;</span><br><span class="line">                        pq.<span class="built_in">push</span>(<span class="built_in">Node</span>(dis.<span class="built_in">at</span>(y), y));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt;</span></span><br><span class="line"><span class="function">    <span class="title">get_path</span><span class="params">(<span class="type">int</span> destination)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">        <span class="keyword">for</span> (; destination != <span class="number">-1</span>; destination = prev.<span class="built_in">at</span>(destination)) &#123;</span><br><span class="line">            path.<span class="built_in">emplace_back</span>(destination);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(path.<span class="built_in">begin</span>(), path.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> path;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The implementation of Dijkstra using adjacency list</span></span><br><span class="line"><span class="keyword">namespace</span> SSSP_Dijkstra_1 &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>; <span class="comment">//  A weight indicates two nodes have no paths between them</span></span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; adj; <span class="comment">// The adjacency list of the graph</span></span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dis;    <span class="comment">// dis.at(n) = the shortest distance from source to n</span></span><br><span class="line">    <span class="type">int</span> source;         <span class="comment">// the node id of the source</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; prev;   <span class="comment">// an auxiliary container to store the path</span></span><br><span class="line">    std::priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt;, greater&lt;&gt; &gt; pq;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        <span class="comment">// initialize the containers</span></span><br><span class="line">        adj.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">        dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            prev.<span class="built_in">resize</span>(number_of_nodes, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">reset</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>(), INF);</span><br><span class="line">        <span class="keyword">decltype</span>(pq)().<span class="built_in">swap</span>(pq);</span><br><span class="line">        <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">            <span class="built_in">fill</span>(prev.<span class="built_in">begin</span>(), prev.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(v, w));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">dijkstra</span><span class="params">(<span class="type">bool</span> store_path = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        pq.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis.<span class="built_in">at</span>(source), source));</span><br><span class="line">        <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> d_v = pq.<span class="built_in">top</span>().first;</span><br><span class="line">            <span class="type">int</span> v = pq.<span class="built_in">top</span>().second;</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (d_v != dis.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[to, weight] : adj.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis.<span class="built_in">at</span>(to) &gt; dis.<span class="built_in">at</span>(v) + weight) &#123;</span><br><span class="line">                    dis.<span class="built_in">at</span>(to) = dis.<span class="built_in">at</span>(v) + weight;</span><br><span class="line">                    <span class="keyword">if</span> (store_path) &#123;</span><br><span class="line">                        prev.<span class="built_in">at</span>(to) = v;</span><br><span class="line">                    &#125;</span><br><span class="line">                    pq.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(dis.<span class="built_in">at</span>(to), to));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt;</span></span><br><span class="line"><span class="function">    <span class="title">get_path</span><span class="params">(<span class="type">int</span> destination)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">        <span class="keyword">for</span> (; destination != <span class="number">-1</span>; destination = prev.<span class="built_in">at</span>(destination)) &#123;</span><br><span class="line">            path.<span class="built_in">emplace_back</span>(destination);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(path.<span class="built_in">begin</span>(), path.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> path;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Bellman Ford&#x27;s algorithm</span></span><br><span class="line"><span class="keyword">namespace</span> SSSP_Bellman_Ford &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; AL;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dist;</span><br><span class="line">    <span class="type">int</span> n, source;</span><br><span class="line">    <span class="comment">// Return false if there is a negative cycle</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bellman_ford</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dist.<span class="built_in">resize</span>(n, INF);</span><br><span class="line">        dist.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        <span class="type">bool</span> relaxed;</span><br><span class="line">        <span class="comment">// relax all E edges V-1 times</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">            relaxed = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; ++u) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dist.<span class="built_in">at</span>(u) != INF) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[v, w] : AL.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                        <span class="comment">// relax</span></span><br><span class="line">                        <span class="keyword">if</span> (dist.<span class="built_in">at</span>(v) &gt; dist.<span class="built_in">at</span>(u) + w) &#123;</span><br><span class="line">                            dist.<span class="built_in">at</span>(v) = dist.<span class="built_in">at</span>(u) + w;</span><br><span class="line">                            relaxed = <span class="literal">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!relaxed) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; ++u) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dist.<span class="built_in">at</span>(u) != INF) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[v, w] : AL.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (dist.<span class="built_in">at</span>(v) &gt; dist.<span class="built_in">at</span>(u) + w) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Shortest Path Faster Algorithm (Bellman-Ford&#x27;s algorithm with queue optimized)</span></span><br><span class="line"><span class="comment">// If you want to query the longest path from a single source, change INF to -INF and change the condition of relaxing from &gt; to &lt;</span></span><br><span class="line"><span class="keyword">namespace</span> SSSP_SPFA &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; adj; <span class="comment">// The adjacency list of the graph</span></span><br><span class="line">    <span class="type">int</span> source;</span><br><span class="line">    <span class="type">int</span> number_of_nodes;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dis;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">decltype</span>(adj)().<span class="built_in">swap</span>(adj);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dis);</span><br><span class="line">        number_of_nodes = <span class="number">0</span>;</span><br><span class="line">        source = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> s)</span> </span>&#123;</span><br><span class="line">        source = s;</span><br><span class="line">        number_of_nodes = n;</span><br><span class="line">        adj.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function">    <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(v, w));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// O(mn)</span></span><br><span class="line">    <span class="function"><span class="type">bool</span></span></span><br><span class="line"><span class="function">    <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dis.<span class="built_in">resize</span>(number_of_nodes + <span class="number">5</span>, INF);</span><br><span class="line">        dis.<span class="built_in">at</span>(source) = <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(number_of_nodes + <span class="number">5</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">in_queue</span><span class="params">(number_of_nodes + <span class="number">5</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(source);</span><br><span class="line">        in_queue.<span class="built_in">at</span>(source) = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            in_queue.<span class="built_in">at</span>(u) = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[v, w] : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis.<span class="built_in">at</span>(u) + w &lt; dis.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                    dis.<span class="built_in">at</span>(v) = dis.<span class="built_in">at</span>(u) + w;</span><br><span class="line">                    <span class="keyword">if</span> (!in_queue.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                        q.<span class="built_in">push</span>(v);</span><br><span class="line">                        in_queue.<span class="built_in">at</span>(v) = <span class="literal">true</span>;</span><br><span class="line">                        ++cnt.<span class="built_in">at</span>(v);</span><br><span class="line">                        <span class="keyword">if</span> (cnt.<span class="built_in">at</span>(v) &gt; number_of_nodes) &#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">// a negative cycle exists</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Construction of a random antimagic-square from 1 to N * N</span></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">antimagic_square</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">res</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">    <span class="type">int</span> end_value = n * n - n + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> current_value = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">            res.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = current_value;</span><br><span class="line">            ++current_value;</span><br><span class="line">        &#125;</span><br><span class="line">        res.<span class="built_in">at</span>(i).<span class="built_in">at</span>(n - <span class="number">1</span>) = end_value;</span><br><span class="line">        ++end_value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pre-calculate the sum of factors of each number from 1 to n</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum_of_factors</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> length = n + <span class="number">5</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">result</span><span class="params">(length)</span></span>;  <span class="comment">// result[k] = sum of factors of k</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; length; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; i * j &lt; length; ++j) &#123;</span><br><span class="line">            result.<span class="built_in">at</span>(i * j) += i;  <span class="comment">// add the factor i</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// using Log2 = __lg2</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SparseTable</span> &#123;</span><br><span class="line">    vector&lt;vector&lt;ll&gt; &gt; spt;</span><br><span class="line">    vector&lt;ll&gt; Log2;</span><br><span class="line">    <span class="type">int</span> n, logn;</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">SparseTable</span><span class="params">(<span class="type">int</span> n)</span> : n(n) &#123;</span></span><br><span class="line">        Log2.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        Log2.<span class="built_in">at</span>(<span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line">        Log2.<span class="built_in">at</span>(<span class="number">2</span>) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">3</span>; i &lt; n + <span class="number">5</span>; ++i)</span><br><span class="line">            Log2.<span class="built_in">at</span>(i) = Log2.<span class="built_in">at</span>(i &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">        logn = <span class="built_in">floor</span>(<span class="built_in">log2</span>(n) + <span class="number">2</span>);</span><br><span class="line">        spt.<span class="built_in">resize</span>(n + <span class="number">5</span>, <span class="built_in">vector</span>&lt;ll&gt;(logn));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            cin &gt;&gt; spt.<span class="built_in">at</span>(i).<span class="built_in">at</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 也可以求区间和 区间或 区间gcd/lcm 区间最小 </span></span><br><span class="line">    <span class="comment">// 只需修改spt.at(i).at(j - 1)和spt.at(i + (1 &lt;&lt; (j - 1))).at(j - 1)的二元运算符即可</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= logn; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">                spt.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j) = <span class="built_in">max</span>(spt.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j - <span class="number">1</span>),</span><br><span class="line">                                      spt.<span class="built_in">at</span>(i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))).<span class="built_in">at</span>(j - <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> s = Log2.<span class="built_in">at</span>(r - l + <span class="number">1</span>);</span><br><span class="line">        ll ans = <span class="built_in">max</span>(spt.<span class="built_in">at</span>(l).<span class="built_in">at</span>(s), spt.<span class="built_in">at</span>(r - (<span class="number">1</span> &lt;&lt; s) + <span class="number">1</span>).<span class="built_in">at</span>(s));</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Preprocess takes O(nmlog(n)log(m))</span></span><br><span class="line"><span class="comment">// Query index starts from 1</span></span><br><span class="line"><span class="comment">// The usage is similar to SparseTable 1D</span></span><br><span class="line"><span class="comment">// If the upperbound of n and m is fixed, use C style multiple dimension arrays instead!</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SparseTable2D</span> &#123;</span><br><span class="line">    vector&lt;ll&gt; Log2;</span><br><span class="line">    vector&lt;vector&lt;vector&lt;vector&lt;ll&gt;&gt;&gt;&gt; spt;</span><br><span class="line">    <span class="type">int</span> n, m, logn, logm;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> maxSize = <span class="built_in">max</span>(n, m);</span><br><span class="line">        Log2.<span class="built_in">resize</span>(maxSize + <span class="number">5</span>);</span><br><span class="line">        Log2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        Log2[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">3</span>; i &lt; maxSize + <span class="number">5</span>; ++i)</span><br><span class="line">            Log2[i] = Log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        logn = <span class="built_in">floor</span>(<span class="built_in">log2</span>(n) + <span class="number">2</span>);</span><br><span class="line">        logm = <span class="built_in">floor</span>(<span class="built_in">log2</span>(m) + <span class="number">2</span>);</span><br><span class="line">        spt.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:spt) i.<span class="built_in">resize</span>(m + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:spt) <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;j:i) j.<span class="built_in">resize</span>(logn);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:spt) <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;j:i) <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;k:j) k.<span class="built_in">resize</span>(logm);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">SparseTable2D</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">SparseTable2D</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> : n(n), m(m) &#123;</span></span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// input 2d array of n*m elements</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">                cin &gt;&gt; spt.<span class="built_in">at</span>(i).<span class="built_in">at</span>(j).<span class="built_in">at</span>(<span class="number">0</span>).<span class="built_in">at</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= logn; ++k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> f = <span class="number">0</span>; f &lt;= logm; ++f) &#123;</span><br><span class="line">                <span class="keyword">if</span> (k + f) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j + (<span class="number">1</span> &lt;&lt; f) - <span class="number">1</span> &lt;= m; ++j) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (k) &#123;</span><br><span class="line">                                spt[i][j][k][f] = <span class="built_in">max</span>(spt[i][j][k - <span class="number">1</span>][f],</span><br><span class="line">                                                      spt[i + (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))][j][k - <span class="number">1</span>][f]);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                spt[i][j][k][f] = <span class="built_in">max</span>(spt[i][j][k][f - <span class="number">1</span>],</span><br><span class="line">                                                      spt[i][j + (<span class="number">1</span> &lt;&lt; (f - <span class="number">1</span>))][k][f - <span class="number">1</span>]);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Pre: r1 &lt;= r2, c1 &lt;= c2</span></span><br><span class="line">    <span class="function">ll <span class="title">queryMax</span><span class="params">(<span class="type">int</span> r1, <span class="type">int</span> c1, <span class="type">int</span> r2, <span class="type">int</span> c2)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(r1 &lt;= r2);</span><br><span class="line">        <span class="built_in">assert</span>(c1 &lt;= c2);</span><br><span class="line">        ll k1 = Log2.<span class="built_in">at</span>(r2 - r1 + <span class="number">1</span>);</span><br><span class="line">        ll k2 = Log2.<span class="built_in">at</span>(c2 - c1 + <span class="number">1</span>);</span><br><span class="line">        r2 = r2 - (<span class="type">int</span>) (<span class="number">1</span> &lt;&lt; k1) + <span class="number">1</span>;</span><br><span class="line">        c2 = c2 - (<span class="type">int</span>) (<span class="number">1</span> &lt;&lt; k2) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(&#123;spt[r1][c1][k1][k2], spt[r1][c2][k1][k2], spt[r2][c1][k1][k2], spt[r2][c2][k1][k2]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate fixed-size array in compile-time</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">int</span> N&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FibStruct</span> &#123;</span><br><span class="line">    array&lt;<span class="type">unsigned</span> <span class="type">int</span>, N&gt; A;</span><br><span class="line">    <span class="function"><span class="keyword">constexpr</span> <span class="title">FibStruct</span><span class="params">()</span> : A() &#123;</span></span><br><span class="line">        A.<span class="built_in">at</span>(<span class="number">0</span>) = <span class="number">0</span>;</span><br><span class="line">        A.<span class="built_in">at</span>(<span class="number">1</span>) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; ++i) &#123;</span><br><span class="line">            A.<span class="built_in">at</span>(i) = A.<span class="built_in">at</span>(i - <span class="number">1</span>) + A.<span class="built_in">at</span>(i - <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">constexpr</span> FibStruct&lt;MAXN&gt; s = <span class="built_in">FibStruct</span>&lt;MAXN&gt;();</span><br><span class="line"><span class="built_in">static_assert</span>(s.A.<span class="built_in">at</span>(MAXN - <span class="number">1</span>) == <span class="number">514229</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Twice DFS to query the diameter of a tree with different weight on each edge : O(n) </span></span><br><span class="line"><span class="keyword">namespace</span> TreeDiameter0 &#123;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt; adj;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; d;</span><br><span class="line">    <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> v, w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;i : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">            v = i.first;</span><br><span class="line">            w = i.second;</span><br><span class="line">            <span class="keyword">if</span> (d.<span class="built_in">at</span>(v) == <span class="number">0</span>) &#123;</span><br><span class="line">                d.<span class="built_in">at</span>(v) = d.<span class="built_in">at</span>(u) + w;</span><br><span class="line">                <span class="keyword">if</span> (d.<span class="built_in">at</span>(v) &gt; d.<span class="built_in">at</span>(c)) &#123;</span><br><span class="line">                    c = v;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">dfs</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">diameter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        d.<span class="built_in">at</span>(<span class="number">0</span>) = <span class="number">1</span>;    <span class="comment">// node id starts from 0</span></span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">        d.<span class="built_in">at</span>(c) = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(c);</span><br><span class="line">        <span class="keyword">return</span> d.<span class="built_in">at</span>(c) - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        d.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The maximum distances from every vertex are stored in maxDist[]</span></span><br><span class="line"><span class="comment">// Time cost: O(n)</span></span><br><span class="line"><span class="keyword">namespace</span> Eccentricity &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> WEIGHT = <span class="number">1</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; AL;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; edged, maxDist;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n_)</span> </span>&#123;</span><br><span class="line">        n = n_;</span><br><span class="line">        <span class="keyword">decltype</span>(AL)().<span class="built_in">swap</span>(AL);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(edged);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(maxDist);</span><br><span class="line">        edged.<span class="built_in">resize</span>(n,<span class="number">-1</span>);</span><br><span class="line">        maxDist.<span class="built_in">resize</span>(n);</span><br><span class="line">        AL.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Obtain the longest path from the subtree with u as root to its leaves</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        edged[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            edged[u] = <span class="built_in">max</span>(edged[u],WEIGHT+<span class="built_in">dfs1</span>(v,u));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> edged[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> pd)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> maxEdges[<span class="number">2</span>] = &#123;pd,<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="type">int</span> nwmg = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (edged[v]+<span class="number">1</span>&gt;maxEdges[<span class="number">0</span>]) &#123;</span><br><span class="line">                maxEdges[<span class="number">1</span>] = maxEdges[<span class="number">0</span>];</span><br><span class="line">                maxEdges[<span class="number">0</span>] = edged[v]+WEIGHT;</span><br><span class="line">                nwmg = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (edged[v]+WEIGHT==maxEdges[<span class="number">0</span>]) &#123;</span><br><span class="line">                ++nwmg;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (edged[v]+WEIGHT&gt;maxEdges[<span class="number">1</span>]) &#123;</span><br><span class="line">                maxEdges[<span class="number">1</span>]=edged[v]+WEIGHT;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> upd = maxEdges[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (upd == edged[v]+<span class="number">1</span> &amp;&amp; nwmg == <span class="number">1</span>) &#123;</span><br><span class="line">                upd = maxEdges[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">dfs2</span>(v,u,upd+WEIGHT);</span><br><span class="line">        &#125;</span><br><span class="line">        maxDist[u] = <span class="built_in">max</span>(pd, maxEdges[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (edged[i] == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">dfs1</span>(i,<span class="number">-1</span>);</span><br><span class="line">                <span class="built_in">dfs2</span>(i,<span class="number">-1</span>,<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Interval</span> &#123;</span><br><span class="line">    <span class="type">int</span> start;</span><br><span class="line">    <span class="type">int</span> end;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> n, vector&lt;Interval&gt;&amp; Tree_edge, vector&lt;<span class="type">int</span>&gt;&amp; Edge_value)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// write code here</span></span><br><span class="line">    TreeDiameter::<span class="built_in">init</span>(n);</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        u = Tree_edge.<span class="built_in">at</span>(i).start;</span><br><span class="line">        v = Tree_edge.<span class="built_in">at</span>(i).end;</span><br><span class="line">        w = Edge_value.<span class="built_in">at</span>(i);</span><br><span class="line">        TreeDiameter::adj.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(v, w));</span><br><span class="line">        TreeDiameter::adj.<span class="built_in">at</span>(v).<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(u, w));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TreeDiameter::<span class="built_in">diameter</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Obtain the tree diameter by DP</span></span><br><span class="line"><span class="keyword">namespace</span> TreeDiameter1 &#123;</span><br><span class="line">    <span class="comment">// the longest distance each node can reach</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; d1;</span><br><span class="line">    <span class="comment">// the second longest distance each node can reach</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; d2;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n);</span><br><span class="line">        d1.<span class="built_in">resize</span>(n);</span><br><span class="line">        d2.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father_of_u)</span> </span>&#123;</span><br><span class="line">        d1.<span class="built_in">at</span>(u) = <span class="number">0</span>;</span><br><span class="line">        d2.<span class="built_in">at</span>(u) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == father_of_u) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(v, u);</span><br><span class="line">            <span class="type">int</span> temp = d1.<span class="built_in">at</span>(v) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (temp &gt; d1.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                d2.<span class="built_in">at</span>(u) = d1.<span class="built_in">at</span>(u);</span><br><span class="line">                d1.<span class="built_in">at</span>(u) = temp;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (temp &gt; d2.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                d2.<span class="built_in">at</span>(u) = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m, u, v;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            adj[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">            adj[v].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// randomly pick one node </span></span><br><span class="line">        <span class="comment">// in the graph as root (we assume the tree is un-rooted)</span></span><br><span class="line">        <span class="type">int</span> dummy_root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(dummy_root, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> diameter = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            diameter = <span class="built_in">max</span>(diameter, d1.<span class="built_in">at</span>(i) + d2.<span class="built_in">at</span>(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fib(2k) = Fib(k) * (2Fib(k+1) - Fib(k))</span></span><br><span class="line"><span class="comment">// Fib(2k+1) = Fib(k+1) * Fib(k+1) + F(k) * F(k)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> pair&lt;T, T&gt; <span class="title">fibInLog</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(n &gt;= <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> p = <span class="built_in">fibInLog</span>&lt;T&gt;(n / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">auto</span> a = p.first * (<span class="number">2</span> * p.second - p.first);</span><br><span class="line">    <span class="keyword">auto</span> b = p.first * p.first + p.second * p.second;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;b, a + b&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;a, b&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">static_assert</span>(<span class="built_in">fibInLog</span>&lt;ll&gt;(<span class="number">80</span>).first == <span class="number">23416728348467685</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the minimal rotation of the string</span></span><br><span class="line"><span class="comment">// Booth&#x27;s algorithm : O(s.size())</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minimalRotation</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">    s += s; <span class="comment">// Concatenate string to it self to avoid modular arithmetic</span></span><br><span class="line">    <span class="type">int</span> length = (<span class="type">int</span>)s.<span class="built_in">size</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">f</span><span class="params">(length, <span class="number">-1</span>)</span></span>;    <span class="comment">// Failure function</span></span><br><span class="line">    <span class="type">int</span> k = <span class="number">0</span>;  <span class="comment">// Least rotation of string found so far</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>, i; j &lt; length; ++j) &#123;</span><br><span class="line">        <span class="type">char</span> sj = s.<span class="built_in">at</span>(j);</span><br><span class="line">        i = f.<span class="built_in">at</span>(j - k - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (i != <span class="number">-1</span> &amp;&amp; sj != s.<span class="built_in">at</span>(k + i + <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sj &lt; s.<span class="built_in">at</span>(k + i + <span class="number">1</span>)) &#123;</span><br><span class="line">                k = j - i - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i = f.<span class="built_in">at</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sj != s.<span class="built_in">at</span>(k + i + <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sj &lt; s.<span class="built_in">at</span>(k)) &#123;</span><br><span class="line">                k = j;</span><br><span class="line">            &#125;</span><br><span class="line">            f.<span class="built_in">at</span>(j - k) = <span class="number">-1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            f.<span class="built_in">at</span>(j - k) = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Check if two strings are rotated</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rotateString</span><span class="params">(string A, string B)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A.<span class="built_in">size</span>() != B.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">rotate</span>(A.<span class="built_in">begin</span>(), A.<span class="built_in">begin</span>() + <span class="built_in">minimalRotation</span>(A), A.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">rotate</span>(B.<span class="built_in">begin</span>(), B.<span class="built_in">begin</span>() + <span class="built_in">minimalRotation</span>(B), B.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> A == B;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Stable Matching Problem</span></span><br><span class="line"><span class="comment">// Gale Shapley&#x27;s algorithm</span></span><br><span class="line"><span class="comment">// O(mw)</span></span><br><span class="line"><span class="keyword">namespace</span> SMP &#123;</span><br><span class="line">    vector&lt;queue&lt;<span class="type">int</span>&gt; &gt; m_pref;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; w_pref;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; engaged;    <span class="comment">// w to m</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; free_man;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; is_woman_free;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        vector&lt;queue&lt;<span class="type">int</span>&gt; &gt;().<span class="built_in">swap</span>(m_pref);</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt; &gt;().<span class="built_in">swap</span>(w_pref);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(engaged);</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(free_man);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;().<span class="built_in">swap</span>(is_woman_free);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        m_pref.<span class="built_in">resize</span>(n + <span class="number">1</span>);   <span class="comment">// man/woman&#x27;s id starts from 1</span></span><br><span class="line">        w_pref.<span class="built_in">resize</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n + <span class="number">1</span>));</span><br><span class="line">        engaged.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            free_man.<span class="built_in">push</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        is_woman_free.<span class="built_in">resize</span>(n + <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">GaleShapley</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!free_man.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> m = free_man.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">if</span> (m_pref.<span class="built_in">at</span>(m).<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                free_man.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> w = m_pref.<span class="built_in">at</span>(</span><br><span class="line">                    m).<span class="built_in">front</span>();   <span class="comment">// first woman on m&#x27;s list to whom m has not yet proposed</span></span><br><span class="line">            <span class="keyword">if</span> (is_woman_free.<span class="built_in">at</span>(w)) &#123;</span><br><span class="line">                engaged.<span class="built_in">at</span>(w) = m;</span><br><span class="line">                m_pref.<span class="built_in">at</span>(m).<span class="built_in">pop</span>();</span><br><span class="line">                free_man.<span class="built_in">pop</span>();</span><br><span class="line">                is_woman_free.<span class="built_in">at</span>(w) = <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> m_ = engaged.<span class="built_in">at</span>(w);</span><br><span class="line">                <span class="keyword">if</span> (w_pref.<span class="built_in">at</span>(w).<span class="built_in">at</span>(m) &gt;</span><br><span class="line">                    w_pref.<span class="built_in">at</span>(w).<span class="built_in">at</span>(m_)) &#123; <span class="comment">// w prefers m to m_</span></span><br><span class="line">                    free_man.<span class="built_in">push</span>(m_);</span><br><span class="line">                    engaged.<span class="built_in">at</span>(w) = m;</span><br><span class="line">                    free_man.<span class="built_in">pop</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                m_pref.<span class="built_in">at</span>(m).<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// n women, n men</span></span><br><span class="line">    <span class="comment">// men invite women</span></span><br><span class="line">    <span class="comment">// preferences of men to women will be given first, then the preferences of women to men</span></span><br><span class="line">    <span class="comment">// print the result of men to women</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, val;</span><br><span class="line">        IO::<span class="built_in">read</span>(n);</span><br><span class="line">        SMP::<span class="built_in">init</span>(n);</span><br><span class="line">        <span class="comment">// men</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">                IO::<span class="built_in">read</span>(val);</span><br><span class="line">                SMP::m_pref.<span class="built_in">at</span>(i).<span class="built_in">push</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// women</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">                IO::<span class="built_in">read</span>(val);</span><br><span class="line">                SMP::w_pref.<span class="built_in">at</span>(i).<span class="built_in">at</span>(val) =</span><br><span class="line">                        n + <span class="number">1</span> - j;   <span class="comment">// notice here</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        SMP::<span class="built_in">GaleShapley</span>();</span><br><span class="line">        <span class="comment">// print result: m to w</span></span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; <span class="built_in">result</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            result.<span class="built_in">at</span>(i - <span class="number">1</span>).first = i;</span><br><span class="line">            result.<span class="built_in">at</span>(i - <span class="number">1</span>).second = SMP::engaged.<span class="built_in">at</span>(i);</span><br><span class="line">            <span class="built_in">swap</span>(result.<span class="built_in">at</span>(i - <span class="number">1</span>).first, result.<span class="built_in">at</span>(i - <span class="number">1</span>).second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>());</span><br><span class="line">        IO::<span class="built_in">write</span>(result.<span class="built_in">at</span>(<span class="number">0</span>).second);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="built_in">putchar_unlocked</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            IO::<span class="built_in">write</span>(result.<span class="built_in">at</span>(i).second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putchar_unlocked</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Given the preferences of 2n people and n pairs of matching of them, check</span></span><br><span class="line"><span class="comment">// how many unstable pairs among n pairs:</span></span><br><span class="line"><span class="comment">// https://leetcode.com/problems/count-unhappy-friends/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Pseudo-code</span></span><br><span class="line"><span class="comment">for w in women:</span></span><br><span class="line"><span class="comment">    for m in [men w would prefer over current_partner(w)]:</span></span><br><span class="line"><span class="comment">        if m prefers w to current_partner(m) return false</span></span><br><span class="line"><span class="comment">return true</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Lucas&#x27;s theorem</span></span><br><span class="line"><span class="keyword">namespace</span> Lucas &#123;</span><br><span class="line">    vector&lt;ll&gt; fac;</span><br><span class="line">    <span class="comment">// preprocess</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span></span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">init</span><span class="params">(ll p)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// reset</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;ll&gt;().<span class="built_in">swap</span>(fac);</span><br><span class="line">        fac.<span class="built_in">emplace_back</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= p; ++i) &#123;</span><br><span class="line">            fac.<span class="built_in">emplace_back</span>(fac.<span class="built_in">back</span>() * i % p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">    ll <span class="title">modpow</span><span class="params">(ll a, ll p, ll M)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (M == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        ll r;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">1</span>, a %= M; p; a = (a * a) % M, p &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (p % <span class="number">2</span>)</span><br><span class="line">                r = (r * a) % M;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">    ll <span class="title">C</span><span class="params">(ll n, ll m, ll p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m &gt; n) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fac[n] * <span class="built_in">modpow</span>(fac[m] * fac[n - m], p - <span class="number">2</span>, p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// C(n, m) % p</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">static</span></span></span><br><span class="line"><span class="function">    ll <span class="title">Lucas</span><span class="params">(ll n, ll m, ll p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">C</span>(n % p, m % p, p) * <span class="built_in">Lucas</span>(n / p, m / p, p)) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Given n, m, p such that p is a prime, calculate C(n+m,n) mod p</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t;</span><br><span class="line">        IO::<span class="built_in">read</span>(t);</span><br><span class="line">        ll n, m, p;</span><br><span class="line">        <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">            IO::<span class="built_in">read</span>(n, m, p);</span><br><span class="line">            Lucas::<span class="built_in">init</span>(p);</span><br><span class="line">            IO::<span class="built_in">writeln</span>(Lucas::<span class="built_in">Lucas</span>(n + m, n, p));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lowest Common Ancestor - Tarjan&#x27;s off-line algorithm</span></span><br><span class="line"><span class="comment">// O(n + m) for m queries</span></span><br><span class="line"><span class="keyword">namespace</span> LCA0 &#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ancestor;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; vis;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; queries;</span><br><span class="line">    unordered_map&lt;pii, <span class="type">int</span>, custom_hash&gt; unmap;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        vis.<span class="built_in">at</span>(u) = <span class="literal">true</span>;</span><br><span class="line">        ancestor.<span class="built_in">at</span>(u) = u;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                <span class="built_in">Tarjan</span>(v);</span><br><span class="line">                DSU::<span class="built_in">merge</span>(u, v);</span><br><span class="line">                ancestor.<span class="built_in">at</span>(DSU::<span class="built_in">find</span>(u)) = u;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> v : queries.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis.<span class="built_in">at</span>(v)) &#123;</span><br><span class="line">                unmap[&#123;u, v&#125;] = ancestor.<span class="built_in">at</span>(DSU::<span class="built_in">find</span>(v));</span><br><span class="line">                unmap[&#123;v, u&#125;] = ancestor.<span class="built_in">at</span>(DSU::<span class="built_in">find</span>(v));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        DSU::<span class="built_in">init</span>(n);</span><br><span class="line">        ancestor.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        vis.<span class="built_in">resize</span>(n + <span class="number">5</span>, <span class="literal">false</span>);</span><br><span class="line">        adj.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        queries.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="comment">// n nodes, (n - 1) edges, the root is s, m queries,</span></span><br><span class="line">    <span class="comment">// for each query, u and v are given, print lca of u and v</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m, s, u, v;</span><br><span class="line">        IO::<span class="built_in">read</span>(n, m, s);</span><br><span class="line">        LCA0::<span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">            IO::<span class="built_in">read</span>(u, v);</span><br><span class="line">            LCA0::adj.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(v);</span><br><span class="line">            LCA0::adj.<span class="built_in">at</span>(v).<span class="built_in">emplace_back</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; query_list;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            IO::<span class="built_in">read</span>(u, v);</span><br><span class="line">            query_list.<span class="built_in">emplace_back</span>(<span class="built_in">make_pair</span>(u, v));</span><br><span class="line">            LCA0::queries.<span class="built_in">at</span>(u).<span class="built_in">emplace_back</span>(v);</span><br><span class="line">            LCA0::queries.<span class="built_in">at</span>(v).<span class="built_in">emplace_back</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        LCA0::<span class="built_in">Tarjan</span>(s);    <span class="comment">// Run Tarjan from root</span></span><br><span class="line">        <span class="comment">// output</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[u, v] : query_list) &#123;</span><br><span class="line">            IO::<span class="built_in">writeln</span>(LCA0::unmap[&#123;u, v&#125;]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Obtain LCA by binary lifting, Preprocess O(nlogn), each query costs O(logn).</span></span><br><span class="line"><span class="keyword">namespace</span> LCA1 &#123;</span><br><span class="line">    <span class="comment">// dfn: dfs序计数器</span></span><br><span class="line">    <span class="type">int</span> dfn,l,n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dfsIn,dfsOut;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; AL;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; fa; <span class="comment">//fa[x][y] = 节点x的第2^y个祖先</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> numberOfNodes)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dfsIn);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dfsOut);</span><br><span class="line">        <span class="keyword">decltype</span>(fa)().<span class="built_in">swap</span>(fa);</span><br><span class="line">        <span class="keyword">decltype</span>(AL)().<span class="built_in">swap</span>(AL);</span><br><span class="line">        n = numberOfNodes;</span><br><span class="line">        dfn = <span class="number">0</span>;</span><br><span class="line">        l = <span class="built_in">ceil</span>(<span class="built_in">log2</span>(n));</span><br><span class="line">        dfsIn.<span class="built_in">resize</span>(n);</span><br><span class="line">        dfsOut.<span class="built_in">resize</span>(n);</span><br><span class="line">        AL.<span class="built_in">resize</span>(n);</span><br><span class="line">        fa.<span class="built_in">resize</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(l+<span class="number">1</span>));</span><br><span class="line">        vis.<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据dfs出入序 可以确定u是否是v的祖先 作为祖先 必然先进后出</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isAncestorOf</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dfsIn[u] &lt;= dfsIn[v] &amp;&amp; dfsOut[u] &gt;= dfsOut[v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father)</span> </span>&#123;</span><br><span class="line">        dfsIn[u] = ++dfn;</span><br><span class="line">        fa[u][<span class="number">0</span>] = father;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= l; ++i) &#123;</span><br><span class="line">            fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v != father) <span class="built_in">dfs</span>(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">        dfsOut[u] = ++dfn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isAncestorOf</span>(u,v)) <span class="keyword">return</span> u;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isAncestorOf</span>(v,u)) <span class="keyword">return</span> v;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = l; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">isAncestorOf</span>(fa[u][i],v)) &#123;</span><br><span class="line">                u = fa[u][i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(root,root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Factorization of an integer using Miller Rabin Prime Check + Pollard Rho</span></span><br><span class="line"><span class="keyword">namespace</span> Factorization &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MAX_PRIME_FACTORS = <span class="number">1000</span>;</span><br><span class="line">    ll factor[MAX_PRIME_FACTORS];    <span class="comment">// Save the result of the factorization</span></span><br><span class="line">    <span class="type">int</span> tol;    <span class="comment">// Count of prime factors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// O(1)</span></span><br><span class="line">    <span class="function">ll <span class="title">multmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">        a = (a % m + m) % m;</span><br><span class="line">        b = (b % m + m) % m;</span><br><span class="line">        <span class="keyword">return</span> ((a * b - (ll) ((ld) a / m * b) * m) % m + m) % m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// O(logb)</span></span><br><span class="line">    <span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        ll r;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">1</span>, a %= m; b; a = <span class="built_in">multmod</span>(a, a, m), b &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (b % <span class="number">2</span>) r = <span class="built_in">multmod</span>(r, a, m);</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Runtime: O(logalogb)</span></span><br><span class="line">    <span class="function">ll <span class="title">bingcd</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a &lt; <span class="number">0</span> || b &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">bingcd</span>(<span class="built_in">abs</span>(a), <span class="built_in">abs</span>(b));</span><br><span class="line">        <span class="keyword">if</span> (!a || !b) <span class="keyword">return</span> a | b;</span><br><span class="line">        <span class="type">unsigned</span> shift = __builtin_ctz(a | b);</span><br><span class="line">        a &gt;&gt;= __builtin_ctz(a);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            b &gt;&gt;= __builtin_ctz(b);</span><br><span class="line">            <span class="keyword">if</span> (a &gt; b) <span class="built_in">swap</span>(a, b);</span><br><span class="line">            b -= a;</span><br><span class="line">        &#125; <span class="keyword">while</span> (b);</span><br><span class="line">        <span class="keyword">return</span> a &lt;&lt; shift;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">miller_rabin_subroutine</span><span class="params">(ll a, ll n, ll x, ll t)</span> </span>&#123;</span><br><span class="line">        ll result = <span class="built_in">powmod</span>(a, x, n);</span><br><span class="line">        ll last = result;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= t; i++) &#123;</span><br><span class="line">            result = <span class="built_in">multmod</span>(result, result, n);</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="number">1</span> &amp;&amp; last != <span class="number">1</span> &amp;&amp; last != n - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            last = result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result != <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// O(Rlognlognlogn)</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">miller_rabin</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constexpr</span> <span class="type">int</span> R = <span class="number">5</span>;   <span class="comment">// rounds</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> ((n &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        ll x = n - <span class="number">1</span>, t = <span class="number">0</span>;</span><br><span class="line">        ll a;</span><br><span class="line">        <span class="keyword">while</span> ((x &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            ++t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; R; ++i) &#123;</span><br><span class="line">            a = <span class="built_in">rand</span>() % (n - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">miller_rabin_subroutine</span>(a, n, x, t)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Base on Brent&#x27;s implementation, O(sqrt(p)) such that p is a small prime factor of n</span></span><br><span class="line">    <span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (n % <span class="number">3</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        ll w = <span class="number">0</span>, a = <span class="number">0</span>, val = <span class="number">1</span>, g;</span><br><span class="line">        ll c = <span class="built_in">rand</span>() % (n - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll k = <span class="number">2</span>;; k &lt;&lt;= <span class="number">1</span>, a = w, val = <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">                w = (<span class="built_in">multmod</span>(w, w, n) + c) % n;</span><br><span class="line">                val = <span class="built_in">multmod</span>(val, <span class="built_in">abs</span>(w - a), n);</span><br><span class="line">                <span class="keyword">if</span> (! (i &amp; <span class="number">127</span>)) &#123;</span><br><span class="line">                    g = <span class="built_in">bingcd</span>(val, n);</span><br><span class="line">                    <span class="keyword">if</span> (g &gt; <span class="number">1</span>) <span class="keyword">return</span> g;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            g = <span class="built_in">bingcd</span>(val, n);</span><br><span class="line">            <span class="keyword">if</span> (g &gt; <span class="number">1</span>) <span class="keyword">return</span> g;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">find_prime_factors</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">miller_rabin</span>(n)) &#123;</span><br><span class="line">            factor[tol++] = n;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ll p = n;</span><br><span class="line">        <span class="keyword">while</span> (p &gt;= n) p = <span class="built_in">pollard_rho</span>(n);</span><br><span class="line">        <span class="built_in">find_prime_factors</span>(p);</span><br><span class="line">        <span class="built_in">find_prime_factors</span>(n / p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Given a string s of length n, consisting only of lowercase English letters,</span></span><br><span class="line"><span class="comment">// find the number of different substrings in this string</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">count_unique_substrings</span><span class="params">(string <span class="type">const</span> &amp;s)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** This part can be done in compile-time **/</span></span><br><span class="line">    <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> p = <span class="number">31</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m = <span class="number">1e9</span> + <span class="number">9</span>;</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">p_pow</span><span class="params">(n)</span></span>;</span><br><span class="line">    p_pow[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        p_pow[i] = (p_pow[i - <span class="number">1</span>] * p) % m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*********************************/</span></span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">h</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        h[i + <span class="number">1</span>] = (h[i] + (s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>) * p_pow[i]) % m;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= n; l++) &#123;</span><br><span class="line">        set&lt;ll&gt; hs;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - l; i++) &#123;</span><br><span class="line">            ll cur_h = (h[i + l] + m - h[i]) % m;</span><br><span class="line">            cur_h = (cur_h * p_pow[n - i - <span class="number">1</span>]) % m;</span><br><span class="line">            hs.<span class="built_in">insert</span>(cur_h);</span><br><span class="line">        &#125;</span><br><span class="line">        cnt += hs.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Given two strings - a pattern s and a text t, determine if the pattern</span></span><br><span class="line"><span class="comment">// appears in the text and if it does, enumerate all its occurrences in</span></span><br><span class="line"><span class="comment">// O(|s|+|t|) time</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">rabin_karp</span><span class="params">(string <span class="type">const</span> &amp;s, string <span class="type">const</span> &amp;t)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Can be done in compile-time **/</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> p = <span class="number">31</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m = <span class="number">1e9</span> + <span class="number">9</span>;</span><br><span class="line">    <span class="type">int</span> S = s.<span class="built_in">size</span>(), T = t.<span class="built_in">size</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">p_pow</span><span class="params">(max(S, T))</span></span>;</span><br><span class="line">    p_pow[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; (<span class="type">int</span>) p_pow.<span class="built_in">size</span>(); i++)</span><br><span class="line">        p_pow[i] = (p_pow[i - <span class="number">1</span>] * p) % m;</span><br><span class="line">    <span class="comment">/*********************************/</span></span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">h</span><span class="params">(T + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; T; i++)</span><br><span class="line">        h[i + <span class="number">1</span>] = (h[i] + (t[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>) * p_pow[i]) % m;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> h_s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; S; i++)</span><br><span class="line">        h_s = (h_s + (s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>) * p_pow[i]) % m;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; occurrences;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i + S - <span class="number">1</span> &lt; T; i++) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> cur_h = (h[i + S] + m - h[i]) % m;</span><br><span class="line">        <span class="keyword">if</span> (cur_h == h_s * p_pow[i] % m)</span><br><span class="line">            occurrences.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> occurrences;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check whether an undirected graph is bipartite</span></span><br><span class="line"><span class="comment">// Principle: a graph is bipartite if and only if it is two-colorable (0/1)</span></span><br><span class="line"><span class="keyword">namespace</span> BipartiteCheck &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; color;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line">        n = number_of_nodes;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(color);</span><br><span class="line">        color.<span class="built_in">resize</span>(n + <span class="number">5</span>, INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// bfs from every node id, which will cover different CCs</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> s = <span class="number">0</span>; s &lt; n; ++s) &#123;</span><br><span class="line">            <span class="keyword">if</span> (color.<span class="built_in">at</span>(s) == INF) &#123;</span><br><span class="line">                color.<span class="built_in">at</span>(s) = <span class="number">0</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (color.<span class="built_in">at</span>(v) == INF) &#123;</span><br><span class="line">                        <span class="comment">// if color[u] = 1, then color[v] = 0</span></span><br><span class="line">                        <span class="comment">// if color[u] = 0, then color[v] = 1</span></span><br><span class="line">                        color.<span class="built_in">at</span>(v) = <span class="number">1</span> - color.<span class="built_in">at</span>(u);</span><br><span class="line">                        q.<span class="built_in">push</span>(v);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (color.<span class="built_in">at</span>(v) == color.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                        <span class="comment">// Coloring conflict found, exit</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Another version that bfs from &#x27;s&#x27;, which means we only consider if the CC that contains &#x27;s&#x27; is bipartite</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="type">bool</span> isBipartite = <span class="literal">true</span>;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        color.<span class="built_in">at</span>(s) = <span class="number">0</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; isBipartite) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (color.<span class="built_in">at</span>(v) == INF) &#123;</span><br><span class="line">                    <span class="comment">// if color[u] = 1, then color[v] = 0</span></span><br><span class="line">                    <span class="comment">// if color[u] = 0, then color[v] = 1</span></span><br><span class="line">                    color.<span class="built_in">at</span>(v) = <span class="number">1</span> - color.<span class="built_in">at</span>(u);</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (color.<span class="built_in">at</span>(v) == color.<span class="built_in">at</span>(u)) &#123;</span><br><span class="line">                    <span class="comment">// Coloring conflict found</span></span><br><span class="line">                    isBipartite = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> isBipartite;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Find cut vertices and bridges in an undirected graph in O(m+n)</span></span><br><span class="line"><span class="keyword">namespace</span> CutVertexAndBridges &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n; <span class="comment">// number of nodes</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; adj; <span class="comment">// adjacency list of graph</span></span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; visited;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; isCutVertex;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; bridges;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; tin, low;</span><br><span class="line">    <span class="type">int</span> timer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">decltype</span>(adj)().<span class="built_in">swap</span>(adj);</span><br><span class="line">        <span class="keyword">decltype</span>(visited)().<span class="built_in">swap</span>(visited);</span><br><span class="line">        <span class="keyword">decltype</span>(isCutVertex)().<span class="built_in">swap</span>(isCutVertex);</span><br><span class="line">        <span class="keyword">decltype</span>(bridges)().<span class="built_in">swap</span>(bridges);</span><br><span class="line">        <span class="keyword">decltype</span>(tin)().<span class="built_in">swap</span>(tin);</span><br><span class="line">        <span class="keyword">decltype</span>(low)().<span class="built_in">swap</span>(low);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line">        n = number_of_nodes;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        visited.<span class="built_in">resize</span>(n + <span class="number">5</span>, <span class="literal">false</span>);</span><br><span class="line">        isCutVertex.<span class="built_in">resize</span>(n + <span class="number">5</span>, <span class="literal">false</span>);</span><br><span class="line">        tin.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> p = <span class="number">-1</span>)</span> </span>&#123;</span><br><span class="line">        visited[u] = <span class="literal">true</span>;</span><br><span class="line">        tin[u] = low[u] = timer++;</span><br><span class="line">        <span class="type">int</span> children = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> v : adj[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == p) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (visited[v]) &#123;</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u], tin[v]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(v, u);</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">                <span class="keyword">if</span> (low[v] &gt; tin[u]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (u &gt; v) &#123;</span><br><span class="line">                        bridges.<span class="built_in">emplace_back</span>(v, u);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        bridges.<span class="built_in">emplace_back</span>(u, v);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (low[v] &gt;= tin[u] &amp;&amp; p != <span class="number">-1</span>)</span><br><span class="line">                    isCutVertex[u] = <span class="literal">true</span>;</span><br><span class="line">                ++children;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="number">-1</span> &amp;&amp; children &gt; <span class="number">1</span>)</span><br><span class="line">            isCutVertex[u] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">findCutVerticesAndBridges</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        timer = <span class="number">0</span>;</span><br><span class="line">        visited.<span class="built_in">resize</span>(n, <span class="literal">false</span>);</span><br><span class="line">        tin.<span class="built_in">resize</span>(n, <span class="number">-1</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n, <span class="number">-1</span>);</span><br><span class="line">        isCutVertex.<span class="built_in">resize</span>(n, <span class="literal">false</span>);</span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt;().<span class="built_in">swap</span>(bridges);</span><br><span class="line">        <span class="comment">// Assume node id starts from 0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!visited[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// How to obtain edges biconnected Components (eBCC) in an undirected graph G</span></span><br><span class="line"><span class="comment">// 1. Identify all bridges in an undirected graph G</span></span><br><span class="line"><span class="comment">// 2. Remove all bridges in G, we have G&#x27;</span></span><br><span class="line"><span class="comment">// 3. Use DSU to get CCs in G&#x27;</span></span><br><span class="line"><span class="comment">// 4. Each CC in G&#x27; is an eBCC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// obtain vertice-biconnected components</span></span><br><span class="line"><span class="comment">// Notice: dont add self-loops in &#x27;adj&#x27;</span></span><br><span class="line"><span class="keyword">namespace</span> vBCC &#123;</span><br><span class="line">    <span class="type">int</span> n, bccCnt, dfnCnt;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj, bcc;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; dfn, low;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; sta;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> number_of_nodes)</span> </span>&#123;</span><br><span class="line">        n = number_of_nodes;</span><br><span class="line">        dfn.<span class="built_in">resize</span>(n+<span class="number">5</span>);</span><br><span class="line">        low.<span class="built_in">resize</span>(n+<span class="number">5</span>);</span><br><span class="line">        bcc.<span class="built_in">resize</span>(n+<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        ++dfnCnt;</span><br><span class="line">        dfn[u] = dfnCnt;</span><br><span class="line">        low[u] = dfnCnt;</span><br><span class="line">        sta.<span class="built_in">push</span>(u);</span><br><span class="line">        <span class="keyword">if</span> (adj[u].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            bcc[++bccCnt].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> temp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!dfn[v]) &#123;</span><br><span class="line">                <span class="built_in">Tarjan</span>(v,u);</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">                <span class="keyword">if</span> (low[v] &gt;= dfn[u]) &#123;</span><br><span class="line">                    ++bccCnt;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        temp = sta.<span class="built_in">top</span>();</span><br><span class="line">                        sta.<span class="built_in">pop</span>();</span><br><span class="line">                        bcc[bccCnt].<span class="built_in">emplace_back</span>(temp);</span><br><span class="line">                    &#125; <span class="keyword">while</span> (temp != v);</span><br><span class="line">                    bcc[bccCnt].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// node id starts from 1</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dfn[i]) &#123;</span><br><span class="line">                <span class="built_in">Tarjan</span>(i, <span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// print all vbccs</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= bccCnt; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="type">int</span> &amp;j : bcc[i]) &#123;</span><br><span class="line">                cout &lt;&lt; j &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> PrefixSum2D &#123;</span><br><span class="line">    vector&lt;vector&lt;ll&gt; &gt; pre;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;ll&gt; &gt; &amp;A)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (A.<span class="built_in">empty</span>() || A.<span class="built_in">front</span>().<span class="built_in">empty</span>()) <span class="keyword">return</span>;</span><br><span class="line">        n = (<span class="type">int</span>) A.<span class="built_in">size</span>();</span><br><span class="line">        m = (<span class="type">int</span>) A.<span class="built_in">front</span>().<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">decltype</span>(pre)().<span class="built_in">swap</span>(pre);</span><br><span class="line">        pre.<span class="built_in">resize</span>(n, <span class="built_in">vector</span>&lt;ll&gt;(m));</span><br><span class="line"></span><br><span class="line">        pre[<span class="number">0</span>][<span class="number">0</span>] = A[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; ++i)</span><br><span class="line">            pre[<span class="number">0</span>][i] = pre[<span class="number">0</span>][i - <span class="number">1</span>] + A[<span class="number">0</span>][i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">            pre[i][<span class="number">0</span>] = pre[i - <span class="number">1</span>][<span class="number">0</span>] + A[i][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m; ++j)</span><br><span class="line">                pre[i][j] = pre[i - <span class="number">1</span>][j] + pre[i][j - <span class="number">1</span>] - pre[i - <span class="number">1</span>][j - <span class="number">1</span>] + A[i][j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">rangeSum</span><span class="params">(<span class="type">int</span> r0, <span class="type">int</span> c0, <span class="type">int</span> r1, <span class="type">int</span> c1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r0 == <span class="number">0</span> &amp;&amp; c0 == <span class="number">0</span>) <span class="keyword">return</span> pre[r1][c1];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (r0 == <span class="number">0</span> &amp;&amp; c0 != <span class="number">0</span>) <span class="keyword">return</span> pre[r1][c1] - pre[r1][c0 - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (r0 != <span class="number">0</span> &amp;&amp; c0 == <span class="number">0</span>) <span class="keyword">return</span> pre[r1][c1] - pre[r0 - <span class="number">1</span>][c1];</span><br><span class="line">        <span class="keyword">return</span> pre[r1][c1] - pre[r0 - <span class="number">1</span>][c1] - pre[r1][c0 - <span class="number">1</span>] + pre[r0 - <span class="number">1</span>][c0 - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prefix sum of edges&#x27; weights on a rooted tree</span></span><br><span class="line"><span class="keyword">namespace</span> PrefixSumTree0 &#123;</span><br><span class="line">    vector&lt;ll&gt; pre;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>, ll&gt; &gt; &gt; adj;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n);</span><br><span class="line">        pre.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father_of_u, ll currSum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[v, w] : adj[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v != father_of_u) &#123;</span><br><span class="line">                pre[v] = currSum + w;</span><br><span class="line">                <span class="built_in">dfs</span>(v, u, pre[v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Query the distance from u to v:</span></span><br><span class="line">    <span class="comment">// ll dist(int u, int v) &#123; return pre[u] + pre[v] - 2*pre[lca(u, v)]; &#125;</span></span><br><span class="line">    <span class="comment">// Usage</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, root, m, u, v, q; ll w;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; root &gt;&gt; m;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            adj[u].<span class="built_in">emplace_back</span>(v, w);</span><br><span class="line">            adj[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> dummy_node = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(root, dummy_node, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; dist(u, v) &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prefix sum of nodes&#x27; weights on a rooted tree</span></span><br><span class="line"><span class="keyword">namespace</span> PrefixSumTree1 &#123;</span><br><span class="line">    vector&lt;ll&gt; pre;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;</span><br><span class="line">    vector&lt;ll&gt; weight;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; father;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        pre.<span class="built_in">resize</span>(n);</span><br><span class="line">        adj.<span class="built_in">resize</span>(n);</span><br><span class="line">        weight.<span class="built_in">resize</span>(n);</span><br><span class="line">        father.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father_of_u, ll currSum)</span> </span>&#123;</span><br><span class="line">        pre[u] = currSum + weight[u];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : adj[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v != father_of_u) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(v, u, pre[u]);</span><br><span class="line">                father[v] = u;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Query the distance from u to v:</span></span><br><span class="line">    <span class="comment">//    ll dist(int u, int v) &#123; </span></span><br><span class="line">    <span class="comment">//        int Lca = lca(u, v);</span></span><br><span class="line">    <span class="comment">//        // Case 1: lca is root</span></span><br><span class="line">    <span class="comment">//        if (father[Lca] == -1) &#123;</span></span><br><span class="line">    <span class="comment">//            return pre[u] + pre[v] - pre[Lca];</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line">    <span class="comment">//        // Case 2: otherwise</span></span><br><span class="line">    <span class="comment">//        return pre[u] + pre[v] - pre[Lca] - pre[father[Lca]];</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">// Usage</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, root, m, u, v, q;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; root &gt;&gt; m;</span><br><span class="line">        <span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : weight) cin &gt;&gt; i;</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            adj[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">            adj[v].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        father[root] = <span class="number">-1</span>;</span><br><span class="line">        <span class="type">int</span> dummy_node = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(root, dummy_node, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; dist(u, v) &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C(n, m) = ((n-m+1)(n-m+2)...(n-m+m))/(m(m-1)(m-2)...2*1)</span></span><br><span class="line"><span class="comment">// P(m,k): For all integers m, k, such that k &gt;= 1</span></span><br><span class="line"><span class="comment">// m(m+1)(m+2)...(m+k-1) is divided by k!</span></span><br><span class="line"><span class="comment">// This can be proved by nested induction</span></span><br><span class="line"><span class="comment">// Ref: </span></span><br><span class="line"><span class="comment">// https://math.stackexchange.com/questions/12065/the-product-of-n-consecutive-integers-is-divisible-by-n-factorial/12073#12073</span></span><br><span class="line"><span class="comment">// https://gowers.wordpress.com/2010/09/18/are-these-the-same-proof/</span></span><br><span class="line"><span class="function">ll <span class="title">comb</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m &gt; n - m) m = n - m;</span><br><span class="line">    ll result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        result = result * (n - m + i) / i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Suppose there is a majority element in n integers such that its occurrence is &gt; (n / 2)</span></span><br><span class="line"><span class="comment">// We can obtain in O(n) time and O(1) space</span></span><br><span class="line"><span class="keyword">namespace</span> MajorityElement &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> val = <span class="number">-1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="keyword">if</span> (a != val) &#123;</span><br><span class="line">                <span class="keyword">if</span> (--cnt &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                val = a, cnt = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; val &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Eulerian Circuit and Eulerian Path</span></span><br><span class="line"><span class="comment">// Eulerian Path: a trail in a finite graph that visits every EDGE exactly once</span></span><br><span class="line"><span class="comment">// Eulerian Circuit: an Eulerian trail that starts and ends on the same vertex</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// For an undirected graph G:</span></span><br><span class="line"><span class="comment">// G has an Eulerian Circuit &lt;=&gt; G is connected, G has no vertices with odd degree</span></span><br><span class="line"><span class="comment">// G has an Eulerian Path &lt;=&gt; G is connected, G has 0 or 2 vertices with odd degree</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// For a directed graph G:</span></span><br><span class="line"><span class="comment">// G has an Eulerian Circuit &lt;=&gt; G is a single SCC and for all vertex v, in_degree[v] = out_degree[v]</span></span><br><span class="line"><span class="comment">// G has an Eulerian Path &lt;=&gt; Suppose its underlying undirected graph is G&#x27;, for G&#x27;</span></span><br><span class="line"><span class="comment">// 1. G&#x27; is a single CC</span></span><br><span class="line"><span class="comment">// 2. there is at most 1 vertex v such that in_degree[v] - out_degree[v] = 1</span></span><br><span class="line"><span class="comment">// 3. there is at most 1 vertex v such that out_degree[v] - in_degree[v] = 1</span></span><br><span class="line"><span class="comment">// 4. for other vertices v, in_degree[v] = out_degree[v]</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// We use Hierholzer&#x27;s algorithm to find the Eulerian Circuit/Path</span></span><br><span class="line"><span class="comment">// 1. If we confirms G contains an Eulerian Path, then:</span></span><br><span class="line"><span class="comment">//    if G is undirected, &#x27;startVertex&#x27; is one of the vertex with odd degree.</span></span><br><span class="line"><span class="comment">//    if G is directed, out_degree[startVertex] - in_degree[startVertex] = 1.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 2. If we confirms G contains an Eulerian Circuit, then &#x27;startVertex&#x27; can be any of vertices.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Sort the adjList if you need to find the lexicographically smallest/largest Eulerian Path/Circuit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Hierholzer for directed graphs</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">Hierholzer</span><span class="params">(<span class="type">int</span> startVertex, vector&lt;deque&lt;<span class="type">int</span>&gt; &gt; &amp;adjList)</span> </span>&#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; circuit;</span><br><span class="line">    <span class="type">int</span> current = startVertex;</span><br><span class="line">    path.<span class="built_in">push</span>(current);</span><br><span class="line">    <span class="keyword">while</span> (!path.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!adjList.<span class="built_in">at</span>(current).<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            path.<span class="built_in">push</span>(current);</span><br><span class="line">            <span class="type">int</span> next = adjList.<span class="built_in">at</span>(current).<span class="built_in">front</span>();</span><br><span class="line">            adjList.<span class="built_in">at</span>(current).<span class="built_in">pop_front</span>();</span><br><span class="line">            current = next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            circuit.<span class="built_in">emplace_back</span>(current);</span><br><span class="line">            current = path.<span class="built_in">top</span>();</span><br><span class="line">            path.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(circuit.<span class="built_in">begin</span>(), circuit.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> circuit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hierholzer for undirected graphs</span></span><br><span class="line"><span class="comment">// Once an edge (u,v) is added to the graph</span></span><br><span class="line"><span class="comment">// We update &#x27;stats&#x27; by ++stats[u][v], ++stats[v][u]</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>, unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; stats;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">Hierholzer2</span><span class="params">(<span class="type">int</span> startVertex, vector&lt;deque&lt;<span class="type">int</span>&gt; &gt; &amp;adjList)</span> </span>&#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; circuit;</span><br><span class="line">    <span class="type">int</span> current = startVertex;</span><br><span class="line">    path.<span class="built_in">push</span>(startVertex);</span><br><span class="line">    <span class="keyword">while</span> (!path.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!adjList.<span class="built_in">at</span>(current).<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            path.<span class="built_in">push</span>(current);</span><br><span class="line">            <span class="type">int</span> next = adjList.<span class="built_in">at</span>(current).<span class="built_in">front</span>();</span><br><span class="line">            adjList.<span class="built_in">at</span>(current).<span class="built_in">pop_front</span>();</span><br><span class="line">            <span class="comment">// avoid traversing the same edge twice</span></span><br><span class="line">            <span class="keyword">if</span> (stats[current][next] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                --stats[current][next];</span><br><span class="line">                --stats[next][current];</span><br><span class="line">                current = next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            circuit.<span class="built_in">emplace_back</span>(current);</span><br><span class="line">            current = path.<span class="built_in">top</span>();</span><br><span class="line">            path.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(circuit.<span class="built_in">begin</span>(), circuit.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> circuit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Bitwise &#123;</span><br><span class="line">    <span class="comment">// All boolean array are in 0-based indexing</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isOn</span><span class="params">(<span class="type">int</span> S, <span class="type">int</span> j)</span> </span>&#123; <span class="keyword">return</span> (S &amp; (<span class="number">1</span> &lt;&lt; j)); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setBit</span><span class="params">(<span class="type">int</span> &amp;S, <span class="type">int</span> j)</span> </span>&#123; S |= (<span class="number">1</span> &lt;&lt; j); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clearBit</span><span class="params">(<span class="type">int</span> &amp;S, <span class="type">int</span> j)</span> </span>&#123; S &amp;= ~(<span class="number">1</span> &lt;&lt; j); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">toggleBit</span><span class="params">(<span class="type">int</span> &amp;S, <span class="type">int</span> j)</span> </span>&#123; S ^= (<span class="number">1</span> &lt;&lt; j); &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lowBit</span><span class="params">(<span class="type">int</span> S)</span> </span>&#123; <span class="keyword">return</span> S &amp; (-S); &#125;  <span class="comment">// S&amp;(-S) is 2^j such that the j-th of S is 0</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setAll</span><span class="params">(<span class="type">int</span> &amp;S, <span class="type">int</span> n)</span> </span>&#123; S = (<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>; &#125; <span class="comment">// set S to all &#x27;1&#x27; bit of length n</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">modulo</span><span class="params">(<span class="type">int</span> S, <span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> S &amp; (n - <span class="number">1</span>); &#125; <span class="comment">// Obtain S%n such that n is a power of 2</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> S)</span> </span>&#123; <span class="keyword">return</span> !(S &amp; (S<span class="number">-1</span>)); &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">turnOffLastBit</span><span class="params">(<span class="type">int</span> S)</span> </span>&#123; <span class="keyword">return</span> S &amp; (S<span class="number">-1</span>); &#125; <span class="comment">// pre: the last bit of S has not been turned off</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// __builtin_ctz(2^n) = n</span></span><br><span class="line">    <span class="comment">// Count how many bits are set in &#x27;x&#x27;</span></span><br><span class="line">    <span class="comment">// __builtin_popcount(x)</span></span><br><span class="line">    <span class="comment">// __builtin_popcountl(x)</span></span><br><span class="line">    <span class="comment">// __builtin_ctz(x) return the number of trailing 0</span></span><br><span class="line">    <span class="comment">// __builtin_clz(x) return the number of leading 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loop through all subsets except itself and the empty set</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">loop_through_all_subsets</span><span class="params">(<span class="type">int</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ss=(s<span class="number">-1</span>)&amp;s; ss; ss=(ss<span class="number">-1</span>)&amp;s) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">bitset</span>&lt;<span class="number">5</span>&gt;(ss).<span class="built_in">to_string</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loop through all subsets with size r in N (Gosper&#x27;s Hack)</span></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">loop_through_subsets_with_size_r</span><span class="params">(<span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> s = (<span class="number">1</span>&lt;&lt;r)<span class="number">-1</span>; s&lt;<span class="number">1</span>&lt;&lt;N;) &#123;</span><br><span class="line">            <span class="comment">// output</span></span><br><span class="line">            cout &lt;&lt; (bitset&lt;N&gt;)s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="comment">// update</span></span><br><span class="line">            <span class="type">int</span> x = s&amp;(-s);</span><br><span class="line">            <span class="type">int</span> y = s+x;</span><br><span class="line">            s = ((s&amp;(~y))/x&gt;&gt;<span class="number">1</span>)|y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Compute the lexicographically next bit permutation</span></span><br><span class="line">    <span class="comment">// 0b10001 --&gt; 0b10010</span></span><br><span class="line">    <span class="comment">// 0b00000 --&gt; 0b11111 (32bits)</span></span><br><span class="line">    <span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">next_bit_permutation</span><span class="params">(<span class="type">unsigned</span> current_bit_permutation)</span> </span>&#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> v = current_bit_permutation;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> w; <span class="comment">// next permutation of bits</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> t = v | (v - <span class="number">1</span>); <span class="comment">// t gets v&#x27;s least significant 0 bits set to 1</span></span><br><span class="line">        <span class="comment">// Next set to 1 the most significant bit to change,</span></span><br><span class="line">        <span class="comment">// set to 0 the least significant ones, and add the necessary 1 bits.</span></span><br><span class="line">        w = (t + <span class="number">1</span>) | (((~t &amp; -~t) - <span class="number">1</span>) &gt;&gt; (__builtin_ctz(v) + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> w;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Iterate all set bits in a &#x27;bitset&#x27; instance</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        bitset&lt;10&gt; bs;</span><br><span class="line">        bs[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        bs[<span class="number">9</span>] = <span class="literal">true</span>;</span><br><span class="line">        bs[<span class="number">5</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = bs._Find_first(); i &lt; bs.<span class="built_in">size</span>(); i = bs._Find_next(i))</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1D BIT</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BIT</span> &#123;</span><br><span class="line">    vector&lt;T&gt; t1, t2;</span><br><span class="line">    <span class="type">int</span> N;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> i &amp; (-i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// index starts from 1</span></span><br><span class="line">    <span class="built_in">BIT</span>(<span class="type">int</span> n) : <span class="built_in">N</span>(n+<span class="number">1</span>) &#123;</span><br><span class="line">        t1.<span class="built_in">resize</span>(N);</span><br><span class="line">        t2.<span class="built_in">resize</span>(N);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(vector&lt;T&gt; &amp;t, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">T <span class="title">a</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (n) &#123;</span><br><span class="line">            a += t[n];</span><br><span class="line">            n -= <span class="built_in">lowbit</span>(n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rsum</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(t1,n)*n-<span class="built_in">sum</span>(t2,n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rsum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">rsum</span>(r)-<span class="built_in">rsum</span>(l<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(vector&lt;T&gt; &amp;t, <span class="type">int</span> n, T val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (n &lt; N) &#123;</span><br><span class="line">            t[n] += val;</span><br><span class="line">            n += <span class="built_in">lowbit</span>(n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rupd</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, T val)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">upd</span>(t1,l,val);</span><br><span class="line">        <span class="built_in">upd</span>(t1,r+<span class="number">1</span>,-val);</span><br><span class="line">        <span class="built_in">upd</span>(t2,l,val*(l<span class="number">-1</span>));</span><br><span class="line">        <span class="built_in">upd</span>(t2,r+<span class="number">1</span>,-val*r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2D BIT</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BIT_2D</span> &#123;</span><br><span class="line">    vector&lt;vector&lt;T&gt; &gt; t;</span><br><span class="line">    <span class="function">T <span class="title">lowbit</span><span class="params">(T i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> i &amp; (-i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> N, M;</span><br><span class="line">    <span class="comment">// index starts from 1</span></span><br><span class="line">    <span class="built_in">BIT_2D</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="built_in">BIT_2D</span>(<span class="type">int</span> n, <span class="type">int</span> m) : <span class="built_in">N</span>(n), <span class="built_in">M</span>(m) &#123;</span><br><span class="line">        t.<span class="built_in">resize</span>(N+<span class="number">1</span>, <span class="built_in">vector</span>&lt;T&gt;(M+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// add &#x27;val&#x27; to t[x][y]</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, T val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= N; i += <span class="built_in">lowbit</span>(i)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = y; j &lt;= M; j += <span class="built_in">lowbit</span>(j)) &#123;</span><br><span class="line">                t[i][j] += val;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// rangesum from [1][1] to [x][y]</span></span><br><span class="line">    <span class="function">T <span class="title">sum</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="function">T <span class="title">ans</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">lowbit</span>(i)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = y; j &gt; <span class="number">0</span>; j -= <span class="built_in">lowbit</span>(j)) &#123;</span><br><span class="line">                ans += t[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">T <span class="title">rsum</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(x2,y2)-<span class="built_in">sum</span>(x2,y1<span class="number">-1</span>)-<span class="built_in">sum</span>(x1<span class="number">-1</span>,y2)+<span class="built_in">sum</span>(x1<span class="number">-1</span>,y1<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RMQ: Range Max/Min Query</span></span><br><span class="line"><span class="comment">// RSQ: Range Sum Query</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="comment">// max: INF = numeric_limits&lt;int&gt;::min();</span></span><br><span class="line">    <span class="comment">// min: INF = numeric_limits&lt;int&gt;::max();</span></span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> INF = numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>();</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; st, lz;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123; st[p] = A[l]; <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">2</span>*p, l, (l+r)/<span class="number">2</span>, A);</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">2</span>*p+<span class="number">1</span>, (l+r)/<span class="number">2</span>+<span class="number">1</span>, r, A);</span><br><span class="line">        st[p] = <span class="built_in">min</span>(st[<span class="number">2</span>*p], st[<span class="number">2</span>*p+<span class="number">1</span>]); <span class="comment">// RMQ -&gt; min/max, RSQ -&gt; +</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">SegmentTree</span>(vector&lt;<span class="type">int</span>&gt; &amp;A) &#123;</span><br><span class="line">        n = (<span class="type">int</span>)A.<span class="built_in">size</span>();</span><br><span class="line">        st.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">        lz.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">        <span class="comment">// The p is id of the tree, which starts from root = 1</span></span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, A);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (lz[p]) &#123;</span><br><span class="line">            st[p] = lz[p];</span><br><span class="line">            <span class="comment">// RMQ -&gt; add: = lz[p],         increment: += lz[p]</span></span><br><span class="line">            <span class="comment">// RSQ -&gt; add: = (r-l+1)*lz[p], increment: += (r-l+1)*lz[p]</span></span><br><span class="line">            <span class="keyword">if</span>(l!=r) lz[<span class="number">2</span>*p] = lz[<span class="number">2</span>*p+<span class="number">1</span>] = lz[p]; <span class="comment">// add: =, increment +=</span></span><br><span class="line">            lz[p] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i, <span class="type">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">push</span>(p, l, r);</span><br><span class="line">        <span class="keyword">if</span> (r &lt; i <span class="keyword">or</span> l &gt; j) <span class="keyword">return</span> INF; <span class="comment">// RMQ -&gt; INF, RSQ -&gt; 0</span></span><br><span class="line">        <span class="keyword">if</span> (l &gt;= i <span class="keyword">and</span> r &lt;= j) <span class="keyword">return</span> st[p];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">query</span>(<span class="number">2</span>*p, l, (l+r)/<span class="number">2</span>, i, j),</span><br><span class="line">                   <span class="built_in">query</span>(<span class="number">2</span>*p+<span class="number">1</span>, (l+r)/<span class="number">2</span>+<span class="number">1</span>, r, i, j));</span><br><span class="line">        <span class="comment">// RMQ -&gt; min/max, RSQ -&gt; +</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i, <span class="type">int</span> j, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">push</span>(p, l, r);</span><br><span class="line">        <span class="keyword">if</span> (r &lt; i <span class="keyword">or</span> l &gt; j) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= i <span class="keyword">and</span> r &lt;= j) &#123; lz[p] = v; <span class="built_in">push</span>(p, l, r); <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">2</span>*p, l, (l+r)/<span class="number">2</span>, i, j, v);</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">2</span>*p+<span class="number">1</span>, (l+r)/<span class="number">2</span>+<span class="number">1</span>, r, i, j, v);</span><br><span class="line">        st[p] = <span class="built_in">min</span>(st[<span class="number">2</span>*p], st[<span class="number">2</span>*p+<span class="number">1</span>]); <span class="comment">// RMQ -&gt; min/max, RSQ -&gt; +</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Usage:</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">int main() &#123;</span></span><br><span class="line"><span class="comment">    vector&lt;int&gt; p = &#123;6,1,1,5,6,1,9&#125;;</span></span><br><span class="line"><span class="comment">    SegmentTree st(p);</span></span><br><span class="line"><span class="comment">    // Range-update from p[1] to p[3] to 120</span></span><br><span class="line"><span class="comment">    st.update(1, 0, st.n - 1, 1, 3, 120);</span></span><br><span class="line"><span class="comment">    // 注意 当区间赋值为0时有问题 用其他值代替0</span></span><br><span class="line"><span class="comment">    // Query the minimal value from p[0] to p[4]</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; st.query(1, 0, st.n - 1, 0, 4) &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line"><span class="comment">    return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Fast Fourier Transformation</span></span><br><span class="line"><span class="keyword">namespace</span> FFT &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> LOG_MAX_LENGTH = <span class="number">27</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> MODULUS = <span class="number">2013265921</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> PRIMITIVE_ROOT = <span class="number">137</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> PRIMITIVE_ROOT_INVERSE = <span class="number">749463956</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">addMultiply</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>)((x + y * <span class="built_in">static_cast</span>&lt;ll&gt;(z)) % MODULUS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">transform</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;a, vector&lt;<span class="type">int</span>&gt; &amp;tA,</span></span></span><br><span class="line"><span class="params"><span class="function">                   <span class="type">int</span> logN, <span class="type">int</span> primitiveRoot)</span> </span>&#123;</span><br><span class="line">        tA.<span class="built_in">resize</span>(<span class="number">1</span> &lt;&lt; logN);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="type">int</span>) a.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> k = j &lt;&lt; (<span class="number">32</span> - logN); <span class="comment">// MUST be unsigned</span></span><br><span class="line">            k = ((k &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x55555555</span>) | ((k &amp; <span class="number">0x55555555</span>) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">            k = ((k &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x33333333</span>) | ((k &amp; <span class="number">0x33333333</span>) &lt;&lt; <span class="number">2</span>);</span><br><span class="line">            k = ((k &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0f0f0f0f</span>) | ((k &amp; <span class="number">0x0f0f0f0f</span>) &lt;&lt; <span class="number">4</span>);</span><br><span class="line">            k = ((k &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x00ff00ff</span>) | ((k &amp; <span class="number">0x00ff00ff</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">            tA[(k &gt;&gt; <span class="number">16</span>) | (k &lt;&lt; <span class="number">16</span>)] = a[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> root[LOG_MAX_LENGTH];</span><br><span class="line">        root[LOG_MAX_LENGTH - <span class="number">1</span>] = primitiveRoot;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = LOG_MAX_LENGTH - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            root[i - <span class="number">1</span>] = <span class="built_in">addMultiply</span>(<span class="number">0</span>, root[i], root[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; logN; i++) &#123;</span><br><span class="line">            <span class="type">int</span> twiddle = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; i); j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; (<span class="type">int</span>) tA.<span class="built_in">size</span>(); k += <span class="number">2</span> &lt;&lt; i) &#123;</span><br><span class="line">                    <span class="type">int</span> x = tA[k];</span><br><span class="line">                    <span class="type">int</span> y = tA[k + (<span class="number">1</span> &lt;&lt; i)];</span><br><span class="line">                    tA[k] = <span class="built_in">addMultiply</span>(x, twiddle, y);</span><br><span class="line">                    tA[k + (<span class="number">1</span> &lt;&lt; i)] =</span><br><span class="line">                            <span class="built_in">addMultiply</span>(x, MODULUS - twiddle, y);</span><br><span class="line">                &#125;</span><br><span class="line">                twiddle = <span class="built_in">addMultiply</span>(<span class="number">0</span>, root[i], twiddle);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">multiply</span> <span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; a,</span></span></span><br><span class="line"><span class="params"><span class="function">                   <span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; b,</span></span></span><br><span class="line"><span class="params"><span class="function">                   vector&lt;<span class="type">int</span>&gt;&amp; res)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> minN = <span class="built_in">int</span>(a.<span class="built_in">size</span>() - <span class="number">1</span> + b.<span class="built_in">size</span>());</span><br><span class="line">        <span class="type">int</span> logN = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((<span class="number">1</span> &lt;&lt; logN) &lt; minN) &#123;</span><br><span class="line">            logN++;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; tA, tB, nC;</span><br><span class="line">        <span class="built_in">transform</span>(a, tA, logN, PRIMITIVE_ROOT);</span><br><span class="line">        <span class="built_in">transform</span>(b, tB, logN, PRIMITIVE_ROOT);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="type">int</span>)tA.<span class="built_in">size</span>(); j++)</span><br><span class="line">            tA[j] = <span class="built_in">addMultiply</span>(<span class="number">0</span>, tA[j], tB[j]);</span><br><span class="line">        <span class="built_in">transform</span>(tA, nC, logN, PRIMITIVE_ROOT_INVERSE);</span><br><span class="line">        res.<span class="built_in">resize</span>(minN);</span><br><span class="line">        <span class="type">int</span> nInverse = MODULUS - ((MODULUS - <span class="number">1</span>) &gt;&gt; logN);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; minN; j++)</span><br><span class="line">            res[j] = <span class="built_in">addMultiply</span>(<span class="number">0</span>, nInverse, nC[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Usage:</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">A</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">B</span><span class="params">(m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : A) cin &gt;&gt; i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : B) cin &gt;&gt; i;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">        <span class="built_in">multiply</span>(A, B, C);</span><br><span class="line">        <span class="type">bool</span> first_item = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;i : C) &#123;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//#define BumpAllocator</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> BumpAllocator</span></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> buf[<span class="number">450</span> &lt;&lt; <span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="type">size_t</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> i = <span class="keyword">sizeof</span> buf;</span><br><span class="line">    <span class="built_in">assert</span>(s &lt; i);</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">void</span>*)&amp;buf[i -= s];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="type">void</span>*)</span> </span>&#123;&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get string_view from a substring</span></span><br><span class="line"><span class="function">string_view <span class="title">subStringView</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  string_view s, </span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="type">size_t</span> p, </span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="type">size_t</span> n = string_view::npos)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> s.<span class="built_in">substr</span>(p, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// usage:</span></span><br><span class="line"><span class="comment">// string s = &quot;abcd&quot;; int i = 0, j = 2;</span></span><br><span class="line"><span class="comment">// string_view sv = subStringView(s, i, j-i+1);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * An implementation to use Zeller&#x27;s congruence calculate the day of the week for any Julian or Gregorian calendar date</span></span><br><span class="line"><span class="comment"> * if the date is given. The function will not check if the given date is valid.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">string <span class="title">zellerCongruence</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span> </span>&#123;</span><br><span class="line">    string result;</span><br><span class="line">    <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (year &lt;= <span class="number">1581</span> || (year == <span class="number">1582</span> &amp;&amp; month &lt;= <span class="number">9</span>) || (year == <span class="number">1582</span> &amp;&amp; month == <span class="number">10</span> &amp;&amp; month &lt;= <span class="number">4</span>))</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (month == <span class="number">1</span> || month == <span class="number">2</span>) &#123;</span><br><span class="line">        --year;</span><br><span class="line">        month += <span class="number">12</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> c = year / <span class="number">100</span>;</span><br><span class="line">    <span class="type">int</span> y = year - c * <span class="number">100</span>;</span><br><span class="line">    <span class="type">int</span> week = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">        week = c / <span class="number">4</span> - <span class="number">2</span> * c + y + y / <span class="number">4</span> + <span class="number">13</span> * (month + <span class="number">1</span>) / <span class="number">5</span> + day - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (week &lt; <span class="number">0</span>)</span><br><span class="line">            week += <span class="number">7</span>;</span><br><span class="line">        week %= <span class="number">7</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        week = y + y / <span class="number">4</span> + c / <span class="number">4</span> - <span class="number">2</span> * c + <span class="number">13</span> * (month + <span class="number">1</span>) / <span class="number">5</span> + day + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span> (week &lt; <span class="number">0</span>)</span><br><span class="line">            week += <span class="number">7</span>;</span><br><span class="line">        week %= <span class="number">7</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (week) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Monday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Monday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Tuesday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Tuesday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Wednesday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Wednesday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Thursday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Thursday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Friday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Friday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Saturday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Saturday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="comment">// printf(&quot;Sunday\n&quot;);</span></span><br><span class="line">            result = <span class="string">&quot;Sunday&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">zellerCongruenceTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">ZellerCongruence</span>(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">16</span>) == <span class="string">&quot;Friday&quot;</span>);</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">ZellerCongruence</span>(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">17</span>) == <span class="string">&quot;Saturday&quot;</span>);</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">ZellerCongruence</span>(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">15</span>) == <span class="string">&quot;Thursday&quot;</span>);</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in">ZellerCongruence</span>(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">14</span>) != <span class="string">&quot;Thursday&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Maxflow</span></span><br><span class="line"><span class="comment">// Dinic: O(V^2*E)</span></span><br><span class="line"><span class="comment">// Edmonds Karp: O(V*E^2)</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Maxflow</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> ll INF = <span class="number">4e18</span>;</span><br><span class="line">    <span class="keyword">using</span> edge = tuple&lt;<span class="type">int</span>, ll, ll&gt;;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;edge&gt; el;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; adj;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; d, last;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; p;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;                       <span class="comment">// find augmenting path</span></span><br><span class="line">        d.<span class="built_in">assign</span>(n, <span class="number">-1</span>); d[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="function">queue&lt;<span class="type">int</span>&gt; <span class="title">q</span><span class="params">(&#123;s&#125;)</span></span>;</span><br><span class="line">        p.<span class="built_in">assign</span>(n, &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;);                       <span class="comment">// record bfs sp tree</span></span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (u == t) <span class="keyword">break</span>;                         <span class="comment">// stop as sink t reached</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;idx : adj[u]) &#123;                  <span class="comment">// explore neighbors of u</span></span><br><span class="line">                <span class="keyword">auto</span> &amp;[v, cap, flow] = el[idx];          <span class="comment">// stored in el[idx]</span></span><br><span class="line">                <span class="keyword">if</span> ((cap-flow &gt; <span class="number">0</span>) &amp;&amp; (d[v] == <span class="number">-1</span>))      <span class="comment">// positive residual edge</span></span><br><span class="line">                    d[v] = d[u]+<span class="number">1</span>, q.<span class="built_in">push</span>(v), p[v] = &#123;u, idx&#125;; <span class="comment">// 3 lines in one!</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> d[t] != <span class="number">-1</span>;                           <span class="comment">// has an augmenting path</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">send_one_flow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, ll f = INF)</span> </span>&#123;   <span class="comment">// send one flow from s-&gt;t</span></span><br><span class="line">        <span class="keyword">if</span> (s == t) <span class="keyword">return</span> f;                        <span class="comment">// bottleneck edge f found</span></span><br><span class="line">        <span class="keyword">auto</span> &amp;[u, idx] = p[t];</span><br><span class="line">        <span class="keyword">auto</span> &amp;cap = <span class="built_in">get</span>&lt;<span class="number">1</span>&gt;(el[idx]), &amp;flow = <span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(el[idx]);</span><br><span class="line">        ll pushed = <span class="built_in">send_one_flow</span>(s, u, <span class="built_in">min</span>(f, cap-flow));</span><br><span class="line">        flow += pushed;</span><br><span class="line">        <span class="keyword">auto</span> &amp;rflow = <span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(el[idx ^ <span class="number">1</span>]);             <span class="comment">// back edge</span></span><br><span class="line">        rflow -= pushed;                             <span class="comment">// back flow</span></span><br><span class="line">        <span class="keyword">return</span> pushed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, ll f = INF)</span> </span>&#123;             <span class="comment">// traverse from s-&gt;t</span></span><br><span class="line">        <span class="keyword">if</span> ((u == t) || (f == <span class="number">0</span>)) <span class="keyword">return</span> f;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = last[u]; i &lt; (<span class="type">int</span>)adj[u].<span class="built_in">size</span>(); ++i) &#123; <span class="comment">// from last edge</span></span><br><span class="line">            <span class="keyword">auto</span> &amp;[v, cap, flow] = el[adj[u][i]];</span><br><span class="line">            <span class="keyword">if</span> (d[v] != d[u]+<span class="number">1</span>) <span class="keyword">continue</span>;              <span class="comment">// not part of layer graph</span></span><br><span class="line">            <span class="keyword">if</span> (ll pushed = <span class="built_in">dfs</span>(v, t, <span class="built_in">min</span>(f, cap - flow))) &#123;</span><br><span class="line">                flow += pushed;</span><br><span class="line">                <span class="keyword">auto</span> &amp;rflow = <span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(el[adj[u][i] ^ <span class="number">1</span>]);     <span class="comment">// back edge</span></span><br><span class="line">                rflow -= pushed;</span><br><span class="line">                <span class="keyword">return</span> pushed;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Maxflow</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="built_in">Maxflow</span>(<span class="type">int</span> number_of_nodes) : <span class="built_in">n</span>(number_of_nodes) &#123;</span><br><span class="line">        adj.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// if you are adding a bidirectional edge u&lt;-&gt;v with weight w into your</span></span><br><span class="line">    <span class="comment">// flow graph, set directed = false (default value is directed = true)</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll w, <span class="type">bool</span> directed = <span class="literal">true</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">return</span>;                          <span class="comment">// safeguard: no self loop</span></span><br><span class="line">        el.<span class="built_in">emplace_back</span>(v, w, <span class="number">0</span>);                    <span class="comment">// u-&gt;v, cap w, flow 0</span></span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(el.<span class="built_in">size</span>() - <span class="number">1</span>);                <span class="comment">// remember this index</span></span><br><span class="line">        el.<span class="built_in">emplace_back</span>(u, directed ? <span class="number">0</span> : w, <span class="number">0</span>);     <span class="comment">// back edge</span></span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(el.<span class="built_in">size</span>() - <span class="number">1</span>);                <span class="comment">// remember this index</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">edmonds_karp</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        ll mf = <span class="number">0</span>;                                   <span class="comment">// mf stands for max_flow</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;                          <span class="comment">// an O(V*E^2) algorithm</span></span><br><span class="line">            ll f = <span class="built_in">send_one_flow</span>(s, t);              <span class="comment">// find and send 1 flow f</span></span><br><span class="line">            <span class="keyword">if</span> (f == <span class="number">0</span>) <span class="keyword">break</span>;                       <span class="comment">// if f == 0 stop</span></span><br><span class="line">            mf += f;                                 <span class="comment">// if f &gt; 0, add to mf</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">dinic</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        ll mf = <span class="number">0</span>;                                   <span class="comment">// mf stands for max_flow</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;                          <span class="comment">// an O(V^2*E) algorithm</span></span><br><span class="line">            last.<span class="built_in">assign</span>(n, <span class="number">0</span>);                         <span class="comment">// important speedup</span></span><br><span class="line">            <span class="keyword">while</span> (ll f = <span class="built_in">dfs</span>(s, t))                   <span class="comment">// exhaust blocking flow</span></span><br><span class="line">                mf += f;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mf;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如何将无权二分图最大匹配转换为最大流问题? 复杂度O(E*sqrt(V))</span></span><br><span class="line"><span class="comment">// Example: https://www.luogu.com.cn/problem/B3605</span></span><br><span class="line"><span class="comment">// 假设左侧有n个点 右侧有m个点</span></span><br><span class="line"><span class="comment">// 1. 将左侧点重新编号1到n</span></span><br><span class="line"><span class="comment">// 2. 将右侧点重新编号n+1到n+m</span></span><br><span class="line"><span class="comment">// 3. 构造虚假源点0和虚假汇点n+m+1</span></span><br><span class="line"><span class="comment">// 4. 源点到点1到n连一条容量为1的边</span></span><br><span class="line"><span class="comment">// 5. 点n+1到n+m连一条容量为1的边到汇点</span></span><br><span class="line"><span class="comment">// 6. 原来的每条从左往右的边容量也为1</span></span><br><span class="line"><span class="comment">// 7. 跑Dinic求最大流 即为最大匹配数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Min Cost Max Flow, takes O(n^2m^2)</span></span><br><span class="line"><span class="keyword">namespace</span> MCMF &#123;</span><br><span class="line">    <span class="keyword">using</span> edge = tuple&lt;<span class="type">int</span>, ll, ll, ll&gt;;</span><br><span class="line">    <span class="keyword">constexpr</span> ll INF = <span class="number">1e18</span>;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    ll totalCost;</span><br><span class="line">    vector&lt;edge&gt; EL;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt; &gt; AL;</span><br><span class="line">    vector&lt;ll&gt; d;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; last;</span><br><span class="line">    vector&lt;<span class="type">bool</span>&gt; vis;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">        totalCost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">decltype</span>(EL)().<span class="built_in">swap</span>(EL);</span><br><span class="line">        <span class="keyword">decltype</span>(AL)().<span class="built_in">swap</span>(AL);</span><br><span class="line">        <span class="keyword">decltype</span>(d)().<span class="built_in">swap</span>(d);</span><br><span class="line">        <span class="keyword">decltype</span>(last)().<span class="built_in">swap</span>(last);</span><br><span class="line">        <span class="keyword">decltype</span>(vis)().<span class="built_in">swap</span>(vis);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n_)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">reset</span>();</span><br><span class="line">        n = n_;</span><br><span class="line">        d.<span class="built_in">resize</span>(n);</span><br><span class="line">        vis.<span class="built_in">resize</span>(n);</span><br><span class="line">        AL.<span class="built_in">resize</span>(n);</span><br><span class="line">        last.<span class="built_in">resize</span>(n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// SPFA to find if there is an augmenting path</span></span><br><span class="line">    <span class="comment">// in residual graph</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>(), INF);</span><br><span class="line">        d[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="literal">true</span>;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;idx : AL[u]) &#123;</span><br><span class="line">                <span class="keyword">auto</span> &amp;[v, cap, flow, cost] = EL[idx];</span><br><span class="line">                <span class="keyword">if</span> (cap &gt; flow &amp;&amp; d[v] &gt; d[u] + cost) &#123;</span><br><span class="line">                    d[v] = d[u] + cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        q.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> d[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, ll f = INF)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || f == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> f;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = last[u]; i &lt; (<span class="type">int</span>) AL[u].<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">auto</span> &amp;[v, cap, flow, cost] = EL[AL[u][i]];</span><br><span class="line">            <span class="keyword">if</span> (!vis[v] &amp;&amp; d[v] == d[u] + cost) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ll pushed = <span class="built_in">dfs</span>(v, t, <span class="built_in">min</span>(f, cap - flow))) &#123;</span><br><span class="line">                    totalCost += pushed * cost;</span><br><span class="line">                    flow += pushed;</span><br><span class="line">                    <span class="keyword">auto</span> &amp;[rv, rcap, rflow, rcost]</span><br><span class="line">                    = EL[AL[u][i] ^ <span class="number">1</span>];    <span class="comment">// back edge</span></span><br><span class="line">                    rflow -= pushed;</span><br><span class="line">                    vis[u] = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span> pushed;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll w, ll c,</span></span></span><br><span class="line"><span class="params"><span class="function">                 <span class="type">bool</span> directed = <span class="literal">true</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        EL.<span class="built_in">emplace_back</span>(v, w, <span class="number">0</span>, c);</span><br><span class="line">        AL[u].<span class="built_in">emplace_back</span>((<span class="type">int</span>) EL.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">        EL.<span class="built_in">emplace_back</span>(u, directed ? <span class="number">0</span> : w, <span class="number">0</span>, -c);</span><br><span class="line">        AL[v].<span class="built_in">emplace_back</span>((<span class="type">int</span>) EL.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">pair&lt;ll, ll&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        ll mf = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">fill</span>(last.<span class="built_in">begin</span>(), last.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span> (ll f = <span class="built_in">dfs</span>(s, t)) &#123;</span><br><span class="line">                mf += f;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;mf, totalCost&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Usage: for a directed graph</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n, m, s, t;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; t;</span><br><span class="line">        MCMF::<span class="built_in">init</span>(n);</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        ll capacity, cost;</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; capacity &gt;&gt; cost;</span><br><span class="line">            MCMF::<span class="built_in">addEdge</span>(u, v, capacity, cost);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> ans = MCMF::<span class="built_in">mcmf</span>(s, t);</span><br><span class="line">        cout &lt;&lt; ans.first &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        cout &lt;&lt; ans.second &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果一个图是完全图 如何求出它的带权二分图最大匹配?</span></span><br><span class="line"><span class="comment">// 可以规约为最小费用最大流问题</span></span><br><span class="line"><span class="comment">// 1. 构造虚假源点s并连上所有左边的点 容量1费用0</span></span><br><span class="line"><span class="comment">// 2. 构造虚假汇点t并被所有右边的点连上 容量1费用0</span></span><br><span class="line"><span class="comment">// 3. 所有左边的点连右边的点的容量为1 费用为权重</span></span><br><span class="line"><span class="comment">// 4. 跑mcmf 最小费用即为原最大匹配数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// How to check if and only if an edge E is on the shortest 求边是否在u到v的最短路上</span></span><br><span class="line"><span class="comment">// path from u to v in an undirected graph:</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 1. Get dis1.at(i) = the shortest path from u to i by Dij (or the shortest path from i to u by Dij )</span></span><br><span class="line"><span class="comment">// 2. Get dis2.at(i) = the shortest path from v to i by Dij (or the shortest path from i to v by Dij )</span></span><br><span class="line"><span class="comment">// 3. For each edge E:(a, b) -&gt; w,</span></span><br><span class="line"><span class="comment">// dis1.at(a) + w + dis2.at(b) = shortest path from u to v</span></span><br><span class="line"><span class="comment">// OR</span></span><br><span class="line"><span class="comment">// dis2.at(a) + w + dis1.at(b) = shortest path from u to v</span></span><br><span class="line"><span class="comment">// &lt;=&gt; the E:(a, b) -&gt; w is on the shortest path from u to v</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 格雷码生成</span></span><br><span class="line"><span class="comment">// 1. k位格雷码从k个0开始</span></span><br><span class="line"><span class="comment">// 2. 翻转最低位得到下一个格雷码 比如000-&gt;001</span></span><br><span class="line"><span class="comment">// 3. 把最右边的1的左边翻位得到下一个格雷码 比如010-&gt;110</span></span><br><span class="line"><span class="comment">// 4. 重复2 3步 直到生成2^k-1个格雷码为止</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 求第n个格雷码</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n ^ (n &gt;&gt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据格雷码求其排名 从0开始</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rev_g</span><span class="params">(<span class="type">int</span> g)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; g; g &gt;&gt;= <span class="number">1</span>) n ^= g;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Kruskal重构树</span></span><br><span class="line"><span class="comment">// https://leetcode.com/problems/checking-existence-of-edge-length-limited-paths-ii/</span></span><br><span class="line"><span class="keyword">namespace</span> KruskalReconstructionTree &#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; AL; <span class="comment">// 重构树</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; weight; <span class="comment">// 重构树点权</span></span><br><span class="line">    <span class="keyword">namespace</span> DSU &#123; <span class="comment">// 没有启发式合并</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; father;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(father);</span><br><span class="line">            father.<span class="built_in">resize</span>(n+<span class="number">5</span>);</span><br><span class="line">            <span class="built_in">iota</span>(father.<span class="built_in">begin</span>(),father.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (x != father[x]) &#123;</span><br><span class="line">                father[x] = <span class="built_in">find</span>(father[x]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> father[x];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">            x = <span class="built_in">find</span>(x);</span><br><span class="line">            y = <span class="built_in">find</span>(y);</span><br><span class="line">            <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</span><br><span class="line">            father[y] = x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isSameGroup</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> LCA &#123;</span><br><span class="line">        <span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line">        bitset&lt;MAXN&gt; vis;</span><br><span class="line">        <span class="type">int</span> dfn,l,n;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; dfsIn,dfsOut;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; fa;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> numberOfNodes)</span> </span>&#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dfsIn);</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(dfsOut);</span><br><span class="line">            <span class="keyword">decltype</span>(fa)().<span class="built_in">swap</span>(fa);</span><br><span class="line">            n = numberOfNodes;</span><br><span class="line">            dfn = <span class="number">0</span>;</span><br><span class="line">            l = <span class="built_in">ceil</span>(<span class="built_in">log2</span>(n));</span><br><span class="line">            dfsIn.<span class="built_in">resize</span>(n);</span><br><span class="line">            dfsOut.<span class="built_in">resize</span>(n);</span><br><span class="line">            fa.<span class="built_in">resize</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(l+<span class="number">1</span>));</span><br><span class="line">            vis.<span class="built_in">reset</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isAncestorOf</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> dfsIn[u] &lt;= dfsIn[v] &amp;&amp; dfsOut[u] &gt;= dfsOut[v];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father)</span> </span>&#123;</span><br><span class="line">            vis[u] = <span class="literal">true</span>;</span><br><span class="line">            dfsIn[u] = ++dfn;</span><br><span class="line">            fa[u][<span class="number">0</span>] = father;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= l; ++i) &#123;</span><br><span class="line">                fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != father) <span class="built_in">dfs</span>(v,u);</span><br><span class="line">            &#125;</span><br><span class="line">            dfsOut[u] = ++dfn;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isAncestorOf</span>(u,v)) <span class="keyword">return</span> u;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isAncestorOf</span>(v,u)) <span class="keyword">return</span> v;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = l; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">isAncestorOf</span>(fa[u][i],v)) &#123;</span><br><span class="line">                    u = fa[u][i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> root)</span> </span>&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(root,root);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u,v,w;</span><br><span class="line">        <span class="built_in">Edge</span>() = <span class="keyword">default</span>;</span><br><span class="line">        <span class="built_in">Edge</span>(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w) : <span class="built_in">u</span>(u),<span class="built_in">v</span>(v),<span class="built_in">w</span>(w)&#123;&#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Edge &amp;e) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> w &lt; e.w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">construct</span><span class="params">(<span class="type">int</span> n, vector&lt;Edge&gt; edgeList)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 当求两点间所有简单路径上最小值的最大值 按边权从小到大排序</span></span><br><span class="line">        <span class="comment">// 当求两点间所有简单路径上最大值的最小值 按边权从大到小排序</span></span><br><span class="line">        <span class="built_in">sort</span>(edgeList.<span class="built_in">begin</span>(),edgeList.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> m = (<span class="type">int</span>)edgeList.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> m = (<span class="type">int</span>)edgeList.<span class="built_in">size</span>();</span><br><span class="line">        weight.<span class="built_in">resize</span>(n+m+<span class="number">1</span>);</span><br><span class="line">        AL.<span class="built_in">resize</span>(n+m+<span class="number">1</span>);</span><br><span class="line">        DSU::<span class="built_in">init</span>(n+m+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> u,v,w,rootOfU,rootOfV;</span><br><span class="line">        <span class="type">int</span> id = n;</span><br><span class="line">        <span class="comment">// 构建Kruskal重构树</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;i : edgeList) &#123;</span><br><span class="line">            u = i[<span class="number">0</span>];</span><br><span class="line">            v = i[<span class="number">1</span>];</span><br><span class="line">            w = i[<span class="number">2</span>];</span><br><span class="line">            rootOfU = DSU::<span class="built_in">find</span>(u);</span><br><span class="line">            rootOfV = DSU::<span class="built_in">find</span>(v);</span><br><span class="line">            <span class="keyword">if</span> (rootOfU != rootOfV) &#123;</span><br><span class="line">                weight[id] = w;</span><br><span class="line">                <span class="comment">// 将两个集合的根作为新节点的左右子并合并</span></span><br><span class="line">                DSU::<span class="built_in">merge</span>(id, rootOfU);</span><br><span class="line">                DSU::<span class="built_in">merge</span>(id, rootOfV);</span><br><span class="line">                AL[id].<span class="built_in">emplace_back</span>(rootOfU);</span><br><span class="line">                AL[rootOfU].<span class="built_in">emplace_back</span>(id);</span><br><span class="line">                AL[id].<span class="built_in">emplace_back</span>(rootOfV);</span><br><span class="line">                AL[rootOfV].<span class="built_in">emplace_back</span>(id);</span><br><span class="line">                ++id;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        LCA::<span class="built_in">pre</span>(id);</span><br><span class="line">        <span class="comment">// 对所有未访问的节点进行dfs 避免森林的情况</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; id; ++i) &#123;</span><br><span class="line">            <span class="comment">// 从集合的根上进行dfs</span></span><br><span class="line">            <span class="keyword">if</span> (!LCA::vis[i]) LCA::<span class="built_in">init</span>(DSU::<span class="built_in">find</span>(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求两点间所有简单路径上最小值的最大值 或 两点间所有简单路径上最大值的最小值</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 两点不连通 返回-1</span></span><br><span class="line">        <span class="keyword">if</span> (DSU::<span class="built_in">find</span>(u) != DSU::<span class="built_in">find</span>(v)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> weight[LCA::<span class="built_in">lca</span>(u,v)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An implementation of Suffix Array with Induced-Sort</span></span><br><span class="line"><span class="comment">// Can construct SA in O(n)</span></span><br><span class="line"><span class="keyword">namespace</span> SA &#123;</span><br><span class="line">    <span class="comment">// Constant booleans</span></span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">bool</span> L_TYPE = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">bool</span> S_TYPE = !L_TYPE;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sais</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;s)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>) s.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> maxValue = *<span class="built_in">max_element</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>()) + <span class="number">1</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">SA</span><span class="params">(n + <span class="number">1</span>, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">bucket</span><span class="params">(maxValue)</span>, <span class="title">lbucket</span><span class="params">(maxValue)</span>, <span class="title">sbucket</span><span class="params">(maxValue)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x : s) ++bucket[x];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxValue; ++i) &#123;</span><br><span class="line">            bucket[i] += bucket[i - <span class="number">1</span>];</span><br><span class="line">            lbucket[i] = bucket[i - <span class="number">1</span>];</span><br><span class="line">            sbucket[i] = bucket[i] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Confirm the type and the position of &#x27;*&#x27;</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">type</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        type[n] = S_TYPE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            type[i] = (s[i] &lt; s[i + <span class="number">1</span>] ? S_TYPE : (s[i] &gt; s[i + <span class="number">1</span>] ? L_TYPE : type[i + <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define helper lambda functions</span></span><br><span class="line">        <span class="keyword">auto</span> is_lms_char = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">            <span class="keyword">return</span> i &gt; <span class="number">0</span> &amp;&amp; type[i] == S_TYPE &amp;&amp; type[i - <span class="number">1</span>] == L_TYPE;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> equal_substring = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[x] != s[y]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                ++x;</span><br><span class="line">                ++y;</span><br><span class="line">            &#125; <span class="keyword">while</span> (!<span class="built_in">is_lms_char</span>(x) &amp;&amp; !<span class="built_in">is_lms_char</span>(y));</span><br><span class="line">            <span class="keyword">return</span> s[x] == s[y];</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> induced_sort = [&amp;]() &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (SA[i] &gt; <span class="number">0</span> &amp;&amp; type[SA[i] - <span class="number">1</span>] == L_TYPE) &#123;</span><br><span class="line">                    SA[lbucket[s[SA[i] - <span class="number">1</span>]]++] = SA[i] - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxValue; ++i) &#123;</span><br><span class="line">                sbucket[i] = bucket[i] - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (SA[i] &gt; <span class="number">0</span> &amp;&amp; type[SA[i] - <span class="number">1</span>] == S_TYPE) &#123;</span><br><span class="line">                    SA[sbucket[s[SA[i] - <span class="number">1</span>]]--] = SA[i] - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; pos;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (type[i] == S_TYPE &amp;&amp; type[i - <span class="number">1</span>] == L_TYPE) &#123;</span><br><span class="line">                pos.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x : pos) SA[sbucket[s[x]]--] = x;</span><br><span class="line">        <span class="built_in">induced_sort</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">name</span><span class="params">(n + <span class="number">1</span>, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> lx = <span class="number">-1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;x : SA) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">is_lms_char</span>(x)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (lx &gt;= <span class="number">0</span> &amp;&amp; !<span class="built_in">equal_substring</span>(lx, x)) &#123;</span><br><span class="line">                    ++cnt;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (lx &gt;= <span class="number">0</span> &amp;&amp; cnt == name[lx]) &#123;</span><br><span class="line">                    flag = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                name[x] = cnt;</span><br><span class="line">                lx = x;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; s1;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;x : name) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x != <span class="number">-1</span>) &#123;</span><br><span class="line">                s1.<span class="built_in">emplace_back</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; sa1;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            <span class="type">int</span> n1 = s1.<span class="built_in">size</span>();</span><br><span class="line">            sa1.<span class="built_in">resize</span>(n1);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1; ++i) sa1[s1[i]] = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sa1 = <span class="built_in">sais</span>(s1);</span><br><span class="line">        &#125;</span><br><span class="line">        lbucket[<span class="number">0</span>] = sbucket[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxValue; ++i) &#123;</span><br><span class="line">            lbucket[i] = bucket[i - <span class="number">1</span>];</span><br><span class="line">            sbucket[i] = bucket[i] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">fill</span>(SA.<span class="built_in">begin</span>(), SA.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = (<span class="type">int</span>) sa1.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            SA[sbucket[s[pos[sa1[i]]]]--] = pos[sa1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">induced_sort</span>();</span><br><span class="line">        <span class="keyword">return</span> SA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; sa;</span><br><span class="line">    <span class="comment">// Construct the suffix array for &#x27;str&#x27;</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">const</span> string &amp;str)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">s</span><span class="params">(str.begin(), str.end())</span></span>;</span><br><span class="line">        s.<span class="built_in">emplace_back</span>(<span class="number">0</span>);</span><br><span class="line">        sa = <span class="built_in">sais</span>(s);</span><br><span class="line">        sa = <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(sa.<span class="built_in">begin</span>() + <span class="number">1</span>, sa.<span class="built_in">end</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Find all occurrences of &#x27;text&#x27; in &#x27;pattern&#x27;</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">saFind</span><span class="params">(<span class="type">const</span> string &amp;pattern, <span class="type">const</span> string &amp;text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> r = <span class="built_in">equal_range</span>(sa.<span class="built_in">begin</span>(), sa.<span class="built_in">end</span>(), <span class="number">-1</span>, [&amp;](<span class="type">int</span> i, <span class="type">int</span> j) &#123;</span><br><span class="line">            <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(i, j);</span><br><span class="line">                a = <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> a * text.<span class="built_in">compare</span>(i, pattern.<span class="built_in">size</span>(), pattern) &lt; <span class="number">0</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="function">vector <span class="title">occ</span><span class="params">(r.first, r.second)</span></span>;</span><br><span class="line">        <span class="built_in">sort</span>(occ.<span class="built_in">begin</span>(), occ.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;i : occ) cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Prufer &#123;</span><br><span class="line">    <span class="comment">// 对树求prufer序列 节点从1开始</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prufer_code</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; AL)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)AL.<span class="built_in">size</span>();</span><br><span class="line">        priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; leaves;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">degree</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">removed</span><span class="params">(n+<span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            degree[i] = (<span class="type">int</span>)AL[i].<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">if</span> (degree[i] == <span class="number">1</span>) &#123;</span><br><span class="line">                leaves.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">while</span> (!leaves.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = leaves.<span class="built_in">top</span>();</span><br><span class="line">            leaves.<span class="built_in">pop</span>();</span><br><span class="line">            removed[u] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : AL[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!removed[v]) &#123;</span><br><span class="line">                    ans.<span class="built_in">emplace_back</span>(v);</span><br><span class="line">                    --degree[v];</span><br><span class="line">                    <span class="keyword">if</span> (degree[v] == <span class="number">1</span>) &#123;</span><br><span class="line">                        leaves.<span class="built_in">push</span>(v);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据Prufer序列重建树 节点从1开始</span></span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; <span class="built_in">prufer_decode</span>(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; prufer_code) &#123;</span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; edgeList;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)prufer_code.<span class="built_in">size</span>() + <span class="number">1</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">degree</span><span class="params">(n, <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : prufer_code) &#123;</span><br><span class="line">            ++degree[i];</span><br><span class="line">        &#125;</span><br><span class="line">        priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; leaves;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (degree[i] == <span class="number">1</span>) &#123;</span><br><span class="line">                leaves.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : prufer_code) &#123;</span><br><span class="line">            <span class="type">int</span> u = leaves.<span class="built_in">top</span>();</span><br><span class="line">            leaves.<span class="built_in">pop</span>();</span><br><span class="line">            edgeList.<span class="built_in">emplace_back</span>(u, v);</span><br><span class="line">            --degree[v];</span><br><span class="line">            <span class="keyword">if</span> (degree[v] == <span class="number">1</span>) &#123;</span><br><span class="line">                leaves.<span class="built_in">push</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> edgeList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinate compression (离散化)</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">coordinateCompression</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; b = a;</span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">    a.<span class="built_in">erase</span>(<span class="built_in">unique</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>()), a.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> n = (<span class="type">int</span>)b.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        b[i] = <span class="built_in">lower_bound</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>(),b[i]) - a.<span class="built_in">begin</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过前缀异或和求子序列异或和 假设索引从1开始</span></span><br><span class="line"><span class="comment">// pre[0] = 0</span></span><br><span class="line"><span class="comment">// pre[i] = A[1] (i = 1) </span></span><br><span class="line"><span class="comment">// pre[i] = pre[i-1]^A[i] (i &gt;= 2)</span></span><br><span class="line"><span class="comment">// Then:</span></span><br><span class="line"><span class="comment">// If 2&lt;=l&lt;=r&lt;=n, then</span></span><br><span class="line"><span class="comment">// pre[l-1]^pre[r] = (A[1]^A[2]^...^A[l-1])^(A[1]^A[2]^...^A[l-1]^A[l]^...^A[r])</span></span><br><span class="line"><span class="comment">// = A[l]^...^A[r]</span></span><br><span class="line"><span class="keyword">namespace</span> RangeXorSum &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; pre;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rangeXorSum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> pre[r];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre[l<span class="number">-1</span>]^pre[r];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;arr)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)arr.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;().<span class="built_in">swap</span>(pre);</span><br><span class="line">        pre.<span class="built_in">resize</span>(n+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            pre[i] = pre[i<span class="number">-1</span>]^arr[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 高精度计算</span></span><br><span class="line"><span class="keyword">namespace</span> BigNum &#123;</span><br><span class="line">    <span class="function">string <span class="title">add</span><span class="params">(<span class="type">const</span> string&amp; a, <span class="type">const</span> string&amp; b)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)<span class="built_in">max</span>(a.<span class="built_in">size</span>(), b.<span class="built_in">size</span>()) + <span class="number">1</span>;</span><br><span class="line">        <span class="function">string <span class="title">ans</span><span class="params">(n, <span class="string">&#x27;0&#x27;</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> i = (<span class="type">int</span>)a.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> j = (<span class="type">int</span>)b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="keyword">while</span> (i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            x = (i &gt;= <span class="number">0</span>) ? (a[i] - <span class="string">&#x27;0&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">            y = (j &gt;= <span class="number">0</span>) ? (b[j] - <span class="string">&#x27;0&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">            ans[k] += x + y;</span><br><span class="line">            <span class="keyword">if</span> (ans[k] - <span class="string">&#x27;0&#x27;</span> &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">                ++ans[k+<span class="number">1</span>];</span><br><span class="line">                ans[k] -= <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            --i; --j; ++k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans.<span class="built_in">size</span>() &gt; <span class="number">1</span> &amp;&amp; ans.<span class="built_in">back</span>() == <span class="string">&#x27;0&#x27;</span>) ans.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="built_in">reverse</span>(ans.<span class="built_in">begin</span>(),ans.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Network Flow in O(V^2*sqrt(E))</span></span><br><span class="line"><span class="comment">// https://github.com/kth-competitive-programming/kactl/blob/main/kactl.pdf</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PushRelabel</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> dest, back;</span><br><span class="line">        ll f, c;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;vector&lt;Edge&gt;&gt; g;</span><br><span class="line">    vector&lt;ll&gt; ec;</span><br><span class="line">    vector&lt;Edge *&gt; cur;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; hs;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; H;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">PushRelabel</span><span class="params">(<span class="type">int</span> n)</span> : g(n), ec(n), cur(n), hs(n&lt;&lt;<span class="number">1</span>), H(n) &#123;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, ll cap, ll rcap = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s == t) <span class="keyword">return</span>;</span><br><span class="line">        g[s].<span class="built_in">push_back</span>(&#123;t, (<span class="type">int</span>) g[t].<span class="built_in">size</span>(), <span class="number">0</span>, cap&#125;);</span><br><span class="line">        g[t].<span class="built_in">push_back</span>(&#123;s, (<span class="type">int</span>) g[s].<span class="built_in">size</span>() - <span class="number">1</span>, <span class="number">0</span>, rcap&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addFlow</span><span class="params">(Edge &amp;e, ll f)</span> </span>&#123;</span><br><span class="line">        Edge &amp;back = g[e.dest][e.back];</span><br><span class="line">        <span class="keyword">if</span> (!ec[e.dest] &amp;&amp; f) hs[H[e.dest]].<span class="built_in">push_back</span>(e.dest);</span><br><span class="line">        e.f += f;</span><br><span class="line">        e.c -= f;</span><br><span class="line">        ec[e.dest] += f;</span><br><span class="line">        back.f -= f;</span><br><span class="line">        back.c += f;</span><br><span class="line">        ec[back.dest] -= f;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">calc</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> v = (<span class="type">int</span>) g.<span class="built_in">size</span>();</span><br><span class="line">        H[s] = v;</span><br><span class="line">        ec[t] = <span class="number">1</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">co</span><span class="params">(v &lt;&lt; <span class="number">1</span>)</span></span>;</span><br><span class="line">        co[<span class="number">0</span>] = v - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v; ++i) cur[i] = g[i].<span class="built_in">data</span>();</span><br><span class="line">        <span class="keyword">for</span> (Edge &amp;e: g[s]) <span class="built_in">addFlow</span>(e, e.c);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> hi = <span class="number">0</span>;;) &#123;</span><br><span class="line">            <span class="keyword">while</span> (hs[hi].<span class="built_in">empty</span>()) <span class="keyword">if</span> (!hi--) <span class="keyword">return</span> -ec[s];</span><br><span class="line">            <span class="type">int</span> u = hs[hi].<span class="built_in">back</span>();</span><br><span class="line">            hs[hi].<span class="built_in">pop_back</span>();</span><br><span class="line">            <span class="keyword">while</span> (ec[u] &gt; <span class="number">0</span>)  <span class="comment">// discharge u</span></span><br><span class="line">                <span class="keyword">if</span> (cur[u] == g[u].<span class="built_in">data</span>() + (<span class="type">int</span>) g[u].<span class="built_in">size</span>()) &#123;</span><br><span class="line">                    H[u] = <span class="number">1e9</span>;</span><br><span class="line">                    <span class="keyword">for</span> (Edge &amp;e: g[u])</span><br><span class="line">                        <span class="keyword">if</span> (e.c &amp;&amp; H[u] &gt; H[e.dest] + <span class="number">1</span>)</span><br><span class="line">                            H[u] = H[e.dest] + <span class="number">1</span>, cur[u] = &amp;e;</span><br><span class="line">                    <span class="keyword">if</span> (++co[H[u]], !--co[hi] &amp;&amp; hi &lt; v)</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v; ++i)</span><br><span class="line">                            <span class="keyword">if</span> (hi &lt; H[i] &amp;&amp; H[i] &lt; v)</span><br><span class="line">                                --co[H[i]], H[i] = v + <span class="number">1</span>;</span><br><span class="line">                    hi = H[u];</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur[u]-&gt;c &amp;&amp; H[u] == H[cur[u]-&gt;dest] + <span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">addFlow</span>(*cur[u], <span class="built_in">min</span>(ec[u], cur[u]-&gt;c));</span><br><span class="line">                <span class="keyword">else</span> ++cur[u];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">leftOfMinCut</span><span class="params">(<span class="type">int</span> a)</span> </span>&#123; <span class="keyword">return</span> H[a] &gt;= (<span class="type">int</span>) g.<span class="built_in">size</span>(); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rolling hash 滚动哈希</span></span><br><span class="line"><span class="keyword">namespace</span> RH &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> ll MOD = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> ll P = <span class="number">31</span>;</span><br><span class="line">    unordered_set&lt;ll&gt; vis;</span><br><span class="line">    vector&lt;ll&gt; Pow;</span><br><span class="line">    vector&lt;ll&gt; Pow_inv;</span><br><span class="line">    vector&lt;ll&gt; H;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="function">ll <span class="title">multmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">        a = (a % m + m) % m;</span><br><span class="line">        b = (b % m + m) % m;</span><br><span class="line">        <span class="keyword">return</span> ((a * b - (ll) ((<span class="type">long</span> <span class="type">double</span>) a / m * b) * m) % m + m) % m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        ll r;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">1</span>, a %= m; b; a = <span class="built_in">multmod</span>(a, a, m), b &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (b % <span class="number">2</span>) r = <span class="built_in">multmod</span>(r, a, m);</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">const</span> string&amp; s)</span> </span>&#123;</span><br><span class="line">        n = (<span class="type">int</span>)s.<span class="built_in">size</span>();</span><br><span class="line">        Pow.<span class="built_in">resize</span>(n);</span><br><span class="line">        Pow_inv.<span class="built_in">resize</span>(n);</span><br><span class="line">        Pow[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        Pow_inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            Pow[i] = (Pow[i<span class="number">-1</span>] * P) % MOD;</span><br><span class="line">            Pow_inv[i] = <span class="built_in">powmod</span>(Pow[i], MOD - <span class="number">2</span>, MOD);</span><br><span class="line">        &#125;</span><br><span class="line">        H.<span class="built_in">resize</span>(n);</span><br><span class="line">        ll h = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            h = (h + (s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>) * Pow[i]) % MOD;</span><br><span class="line">            H[i] = h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">getHash</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> H[r];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">multmod</span>(H[r] - H[l<span class="number">-1</span>] + MOD, Pow_inv[l], MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Trie树模版</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> LETTERS = <span class="number">26</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    Node* children[LETTERS];</span><br><span class="line">    <span class="type">bool</span> isEnd; <span class="comment">// 表示是否存在以该节点作为结尾的单词 或者用个counter表示树中该单词出现的次数</span></span><br><span class="line">    <span class="built_in">Node</span>() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; LETTERS; ++i) &#123;</span><br><span class="line">            children[i] = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        isEnd = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Trie</span> &#123;</span><br><span class="line">    Node* root;</span><br><span class="line">    <span class="built_in">Trie</span>() &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        Node* node = root;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)word.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!node-&gt;children[word[i] - <span class="string">&#x27;a&#x27;</span>]) &#123;</span><br><span class="line">                node-&gt;children[word[i] - <span class="string">&#x27;a&#x27;</span>] = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            node = node-&gt;children[word[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        node-&gt;isEnd = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">search</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        Node* node = root;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)word.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!node-&gt;children[word[i] - <span class="string">&#x27;a&#x27;</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            node = node-&gt;children[word[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node-&gt;isEnd;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">startsWith</span><span class="params">(string prefix)</span> </span>&#123;</span><br><span class="line">        Node* node = root;</span><br><span class="line">        <span class="type">int</span> n = (<span class="type">int</span>)prefix.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!node-&gt;children[prefix[i] - <span class="string">&#x27;a&#x27;</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            node = node-&gt;children[prefix[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 01 bfs (bfs with only two different weights)</span></span><br><span class="line"><span class="keyword">namespace</span> ZeroOneBFS &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> s, <span class="type">const</span> vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">d</span><span class="params">(n, INF)</span></span>;</span><br><span class="line">        d[s] = <span class="number">0</span>;</span><br><span class="line">        deque&lt;<span class="type">int</span>&gt; dq;</span><br><span class="line">        dq.<span class="built_in">push_front</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!dq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> v = dq.<span class="built_in">front</span>();</span><br><span class="line">            dq.<span class="built_in">pop_front</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; edge : adj[v]) &#123;</span><br><span class="line">                <span class="type">int</span> u = edge.first;</span><br><span class="line">                <span class="type">int</span> w = edge.second;</span><br><span class="line">                <span class="keyword">if</span> (d[v] + w &lt; d[u]) &#123;</span><br><span class="line">                    d[u] = d[v] + w;</span><br><span class="line">                    <span class="keyword">if</span> (w == <span class="number">1</span>) <span class="comment">// larger weights on the back</span></span><br><span class="line">                        dq.<span class="built_in">push_back</span>(u);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        dq.<span class="built_in">push_front</span>(u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> ZeroOneKnapSack &#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="type">int</span> W_SUM = <span class="number">1200</span>;</span><br><span class="line">    <span class="comment">// 0-1 knapsack</span></span><br><span class="line">    <span class="type">int</span> memo[N+<span class="number">5</span>][W_SUM+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> W[N+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> V[N+<span class="number">5</span>];</span><br><span class="line">    <span class="comment">// dp(i, j) = Max value we can have under the current weight restrictions</span></span><br><span class="line">    <span class="comment">// consider all items from 0 to i-1</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> remaining_weight)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index == N) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (remaining_weight == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (memo[index][remaining_weight] != <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> memo[index][remaining_weight];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> result = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (W[index] &gt; remaining_weight) &#123;</span><br><span class="line">            result = <span class="built_in">dp</span>(index + <span class="number">1</span>, remaining_weight);   <span class="comment">// skip</span></span><br><span class="line">            memo[index][remaining_weight] = result;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        result = <span class="built_in">max</span>(<span class="built_in">dp</span>(index + <span class="number">1</span>, remaining_weight), V[index] + <span class="built_in">dp</span>(index + <span class="number">1</span>, remaining_weight - W[index])); <span class="comment">// compare &#x27;take it&#x27; and &#x27;skip&#x27;</span></span><br><span class="line">        memo[index][remaining_weight] = result;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen(&quot;in&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">    <span class="comment">//freopen(&quot;out&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For unweight graphs, use BFS+vis array to find the shortest path between two nodes, dont use DFS+vis array which only works on weight graphs</span></span><br></pre></td></tr></table></figure></article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/about"> About</a></li><li class="nav_item"><a class="nav-page" href="/blogs"> Blogs</a></li><li class="nav_item"><a class="nav-page" href="/projects"> Projects</a></li><li class="nav_item"><a class="nav-page" href="/notes"> Notes</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2023 by Haohu Shen</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>